<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: SCTPServer.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_d4967169ec7e731d10b0c7ba84f2d7bc.html">applications</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_cd2be5cf86111e5e06be0ff46af1166f.html">sctpapp</a>
  </div>
</div>
<div class="contents">
<h1>SCTPServer.cc</h1><a href="_s_c_t_p_server_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// Copyright (C) 2008 Irene Ruengeler</span>
<a name="l00003"></a>00003 <span class="comment">// Copyright (C) 2009 Thomas Dreibholz</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This program is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment">// modify it under the terms of the GNU General Public License</span>
<a name="l00007"></a>00007 <span class="comment">// as published by the Free Software Foundation; either version 2</span>
<a name="l00008"></a>00008 <span class="comment">// of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">// This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00013"></a>00013 <span class="comment">// GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">// along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_server_8h.html">SCTPServer.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_socket_8h.html">SCTPSocket.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_command__m_8h.html">SCTPCommand_m.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_message__m_8h.html">SCTPMessage_m.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_association_8h.html">SCTPAssociation.h</a>&quot;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="_s_c_t_p_server_8cc.html#a1d141ebad9d3bb3992eddbc0f9f3dc56">00028</a> <span class="preprocessor">#define MSGKIND_CONNECT  0</span>
<a name="l00029"></a><a class="code" href="_s_c_t_p_server_8cc.html#a1ce396aa5841b902813c437e441f5ca5">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define MSGKIND_SEND         1</span>
<a name="l00030"></a><a class="code" href="_s_c_t_p_server_8cc.html#a59cd98e62f5a8c07888ab8d8f9bdc094">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define MSGKIND_      2</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <a class="code" href="_ether_app_cli_8cc.html#abf346c028a3c694e3a78e998c663a6c7">Define_Module</a>(<a class="code" href="class_s_c_t_p_server.html">SCTPServer</a>);
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="class_s_c_t_p_server.html#a9bec6b9704be03cd5c3af6315eb25665">00034</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#a9bec6b9704be03cd5c3af6315eb25665">SCTPServer::initialize</a>()
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036     <span class="keywordtype">char</span> * token;
<a name="l00037"></a>00037     cPar *delT;
<a name="l00038"></a>00038     <a class="code" href="_s_c_t_p_association_8h.html#a83ecc618606af11f87a228a6ab74049b">AddressVector</a> addresses;
<a name="l00039"></a>00039     <a class="code" href="class_s_c_t_p_server.html#a9ccf3d527896588b2590ef24523813dc">socket</a> = NULL;
<a name="l00040"></a>00040     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;initialize SCTP Server\n&quot;</span>;
<a name="l00041"></a>00041     <a class="code" href="class_s_c_t_p_server.html#a0e171815eedbf2379e1d869284374fed">numSessions</a> = <a class="code" href="class_s_c_t_p_server.html#a288aa635dcea19fb16d48ec4022e6704">packetsSent</a> = <a class="code" href="class_s_c_t_p_server.html#a55929241e5bcd30855a2edab73f24814">packetsRcvd</a> = <a class="code" href="class_s_c_t_p_server.html#a24f25fbfd5abf8039b77dedd4ebaa00d">bytesSent</a> = <a class="code" href="class_s_c_t_p_server.html#a733ca06a94bdde0ff88484fa36068e9a">notifications</a> = 0;
<a name="l00042"></a>00042     WATCH(<a class="code" href="class_s_c_t_p_server.html#a0e171815eedbf2379e1d869284374fed">numSessions</a>);
<a name="l00043"></a>00043     WATCH(<a class="code" href="class_s_c_t_p_server.html#a288aa635dcea19fb16d48ec4022e6704">packetsSent</a>);
<a name="l00044"></a>00044     WATCH(<a class="code" href="class_s_c_t_p_server.html#a55929241e5bcd30855a2edab73f24814">packetsRcvd</a>);
<a name="l00045"></a>00045     WATCH(<a class="code" href="class_s_c_t_p_server.html#a24f25fbfd5abf8039b77dedd4ebaa00d">bytesSent</a>);
<a name="l00046"></a>00046     WATCH(<a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>);
<a name="l00047"></a>00047     <span class="comment">// parameters</span>
<a name="l00048"></a>00048     <a class="code" href="class_s_c_t_p_server.html#a6cafc0845397f64cfba52c7bf3ad3059">finishEndsSimulation</a> = (bool)par(<span class="stringliteral">&quot;finishEndsSimulation&quot;</span>);
<a name="l00049"></a>00049     <span class="keyword">const</span> <span class="keywordtype">char</span>* address = par(<span class="stringliteral">&quot;address&quot;</span>);
<a name="l00050"></a>00050     token = strtok((<span class="keywordtype">char</span>*)address,<span class="stringliteral">&quot;,&quot;</span>);
<a name="l00051"></a>00051     <span class="keywordflow">while</span> (token != NULL)
<a name="l00052"></a>00052     {
<a name="l00053"></a>00053         addresses.push_back(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(token));
<a name="l00054"></a>00054         token = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);
<a name="l00055"></a>00055     }
<a name="l00056"></a>00056     int32 port = par(<span class="stringliteral">&quot;port&quot;</span>);
<a name="l00057"></a>00057     <a class="code" href="class_s_c_t_p_server.html#a94dbc6b1477183c2fb909a5ff423d5a2">echoFactor</a> = par(<span class="stringliteral">&quot;echoFactor&quot;</span>);
<a name="l00058"></a>00058     <a class="code" href="class_s_c_t_p_server.html#ae432839222cc11a5e6a79bbcedcf89ba">delay</a> = par(<span class="stringliteral">&quot;echoDelay&quot;</span>);
<a name="l00059"></a>00059     <a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a> = par(<span class="stringliteral">&quot;delayFirstRead&quot;</span>);
<a name="l00060"></a>00060     delT = &amp;par(<span class="stringliteral">&quot;readingInterval&quot;</span>);
<a name="l00061"></a>00061     <span class="keywordflow">if</span> (delT-&gt;isNumeric() &amp;&amp; (double)*delT==0)
<a name="l00062"></a>00062         <a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a>=<span class="keyword">false</span>;
<a name="l00063"></a>00063     <span class="keywordflow">else</span>
<a name="l00064"></a>00064         <a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a>=<span class="keyword">true</span>;
<a name="l00065"></a>00065     int32 messagesToPush = par(<span class="stringliteral">&quot;messagesToPush&quot;</span>);
<a name="l00066"></a>00066     <a class="code" href="class_s_c_t_p_server.html#a251e4670192345c198ee23d759d3b358">inboundStreams</a> = par(<span class="stringliteral">&quot;inboundStreams&quot;</span>);
<a name="l00067"></a>00067     <a class="code" href="class_s_c_t_p_server.html#a40783a4ecb36dc4921aa6d668b0b271f">outboundStreams</a> = par(<span class="stringliteral">&quot;outboundStreams&quot;</span>);
<a name="l00068"></a>00068     <a class="code" href="class_s_c_t_p_server.html#a252d089a15890b6fd4389ae26ddec45b">ordered</a> = (bool)par(<span class="stringliteral">&quot;ordered&quot;</span>);
<a name="l00069"></a>00069     <a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a> = par(<span class="stringliteral">&quot;queueSize&quot;</span>);
<a name="l00070"></a>00070     <a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a> = 0;
<a name="l00071"></a>00071     <span class="comment">//abort = NULL;</span>
<a name="l00072"></a>00072     <span class="comment">//abortSent = false;</span>
<a name="l00073"></a>00073     <a class="code" href="class_s_c_t_p_server.html#aa39760cbcbc9f13ce9abbfa319eb498b">timeoutMsg</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;SrvAppTimer&quot;</span>);
<a name="l00074"></a>00074     <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;delayTimer&quot;</span>);
<a name="l00075"></a>00075     <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);
<a name="l00076"></a>00076     <a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;delayFirstReadTimer&quot;</span>);
<a name="l00077"></a>00077     <a class="code" href="class_s_c_t_p_server.html#ae0a0de00763a065f55e2421cec66fdff">firstData</a> = <span class="keyword">true</span>;
<a name="l00078"></a>00078     <a class="code" href="class_s_c_t_p_socket.html">SCTPSocket</a> *<a class="code" href="class_s_c_t_p_server.html#a9ccf3d527896588b2590ef24523813dc">socket</a> = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_socket.html">SCTPSocket</a>();
<a name="l00079"></a>00079     socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#a1fb780971464be963565c6bf5d95cafe">setOutputGate</a>(gate(<span class="stringliteral">&quot;sctpOut&quot;</span>));
<a name="l00080"></a>00080     socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#ae7515d3a249a8f47388034c3bd269cc7">setInboundStreams</a>(<a class="code" href="class_s_c_t_p_server.html#a251e4670192345c198ee23d759d3b358">inboundStreams</a>);
<a name="l00081"></a>00081     socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#a6ba81244dfc436377270d92674cd1105">setOutboundStreams</a>(<a class="code" href="class_s_c_t_p_server.html#a40783a4ecb36dc4921aa6d668b0b271f">outboundStreams</a>);
<a name="l00082"></a>00082     <span class="keywordflow">if</span> (strcmp(address,<span class="stringliteral">&quot;&quot;</span>)==0)
<a name="l00083"></a>00083         socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#a109050219a13edd8713995f41a8d7259">bind</a>(port);
<a name="l00084"></a>00084     <span class="keywordflow">else</span>
<a name="l00085"></a>00085     {
<a name="l00086"></a>00086         socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#a9a33f1da38b12d217ee106a9eb801601">bindx</a>(addresses, port);
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088     socket-&gt;<a class="code" href="class_s_c_t_p_socket.html#aaf460eed5521fb6c1a587075bec6f6b4">listen</a>(<span class="keyword">true</span>, par(<span class="stringliteral">&quot;numPacketsToSendPerClient&quot;</span>), messagesToPush);
<a name="l00089"></a>00089     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTPServer::initialized listen port=&quot;</span>&lt;&lt;port&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00090"></a>00090     <a class="code" href="class_s_c_t_p_server.html#a9675d1e5bfa56a81a7e09d172f13302d">schedule</a> = <span class="keyword">false</span>;
<a name="l00091"></a>00091     <a class="code" href="class_s_c_t_p_server.html#a85ff1b90c417e2bd0090b5d76de7efcd">shutdownReceived</a> = <span class="keyword">false</span>;
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">00094</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">SCTPServer::sendOrSchedule</a>(cPacket *msg)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#ae432839222cc11a5e6a79bbcedcf89ba">delay</a>==0)
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098         send(msg, <span class="stringliteral">&quot;sctpOut&quot;</span>);
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100     <span class="keywordflow">else</span>
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102         scheduleAt(simulation.getSimTime()+<a class="code" href="class_s_c_t_p_server.html#ae432839222cc11a5e6a79bbcedcf89ba">delay</a>, msg);
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">00106</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">SCTPServer::generateAndSend</a>()
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108 uint32 numBytes;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;CMSG&quot;</span>);
<a name="l00111"></a>00111     <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>* msg=<span class="keyword">new</span> <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>(<span class="stringliteral">&quot;Server&quot;</span>);
<a name="l00112"></a>00112     numBytes=(<span class="keywordtype">long</span> uint32)par(<span class="stringliteral">&quot;requestLength&quot;</span>);
<a name="l00113"></a>00113     msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a19267ba50e2bce996b9290544b436477">setDataArraySize</a>(numBytes);
<a name="l00114"></a>00114     <span class="keywordflow">for</span> (uint32 i=0; i&lt;numBytes; i++)
<a name="l00115"></a>00115     {
<a name="l00116"></a>00116         msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#aac4ab53c4235fd4ee9df1ae47769382d">setData</a>(i, <span class="charliteral">&apos;s&apos;</span>);
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118     msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a630c1edca53781533d0f8a04a39ab0e1">setDataLen</a>(numBytes);
<a name="l00119"></a>00119     msg-&gt;setBitLength(numBytes * 8);
<a name="l00120"></a>00120     cmsg-&gt;encapsulate(msg);
<a name="l00121"></a>00121     <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>(<span class="stringliteral">&quot;Send1&quot;</span>);
<a name="l00122"></a>00122     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00123"></a>00123     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a252d089a15890b6fd4389ae26ddec45b">ordered</a>)
<a name="l00124"></a>00124         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff4b63211a335d3580c32293a0cc72eb">setSendUnordered</a>(<a class="code" href="_s_c_t_p_association_8h.html#a6f5cc3c80258127f32f9afd435791f1fa58b47731ff085e85a7462873e1284441">COMPLETE_MESG_ORDERED</a>);
<a name="l00125"></a>00125     <span class="keywordflow">else</span>
<a name="l00126"></a>00126         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff4b63211a335d3580c32293a0cc72eb">setSendUnordered</a>(<a class="code" href="_s_c_t_p_association_8h.html#a6f5cc3c80258127f32f9afd435791f1fa624a2bc1f97816d9d48c796f8ddab573">COMPLETE_MESG_UNORDERED</a>);
<a name="l00127"></a>00127     <a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>=(<a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>+1)%<a class="code" href="class_s_c_t_p_server.html#a40783a4ecb36dc4921aa6d668b0b271f">outboundStreams</a>;
<a name="l00128"></a>00128     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(<a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>);
<a name="l00129"></a>00129     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>&gt;0 &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a> &gt; 0 &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#aae3ed98865cf200ed1592ab468ed4561">count</a> &lt; <a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>*2)
<a name="l00130"></a>00130         cmd-&gt;<a class="code" href="class_s_c_t_p_send_command.html#a014dfdf2b2d35254c0aa2e2e79bef280">setLast</a>(<span class="keyword">false</span>);
<a name="l00131"></a>00131     <span class="keywordflow">else</span>
<a name="l00132"></a>00132         cmd-&gt;<a class="code" href="class_s_c_t_p_send_command.html#a014dfdf2b2d35254c0aa2e2e79bef280">setLast</a>(<span class="keyword">true</span>);
<a name="l00133"></a>00133     cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eacb34da0d2a8bc9071c353d5e92ab0d94">SCTP_C_SEND</a>);
<a name="l00134"></a>00134     cmsg-&gt;setControlInfo(cmd);
<a name="l00135"></a>00135     <a class="code" href="class_s_c_t_p_server.html#a288aa635dcea19fb16d48ec4022e6704">packetsSent</a>++;
<a name="l00136"></a>00136     <a class="code" href="class_s_c_t_p_server.html#a24f25fbfd5abf8039b77dedd4ebaa00d">bytesSent</a>+=msg-&gt;getBitLength()/8;
<a name="l00137"></a>00137     <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">00140</a> cPacket* <a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">SCTPServer::makeReceiveRequest</a>(cPacket* msg)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *ind = check_and_cast&lt;<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00143"></a>00143     cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;ReceiveRequest&quot;</span>);
<a name="l00144"></a>00144     <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>(<span class="stringliteral">&quot;Send2&quot;</span>);
<a name="l00145"></a>00145     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(ind-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>());
<a name="l00146"></a>00146     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(ind-&gt;<a class="code" href="class_s_c_t_p_command.html#adb637d33f742c0510f40f73e030f360e">getSid</a>());
<a name="l00147"></a>00147     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a37523301d495d32f6e84defd8efe6c26">setNumMsgs</a>(ind-&gt;<a class="code" href="class_s_c_t_p_command.html#a92f0f9644b4f5ec70df1dcbd0c242b7d">getNumMsgs</a>());
<a name="l00148"></a>00148     cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea2ba582af18939c296a16e1b083e74397">SCTP_C_RECEIVE</a>);
<a name="l00149"></a>00149     cmsg-&gt;setControlInfo(cmd);
<a name="l00150"></a>00150     <span class="keyword">delete</span> ind;
<a name="l00151"></a>00151     <span class="keywordflow">return</span> cmsg;
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="class_s_c_t_p_server.html#a9079c3bc9e2380b15e4124cb3197c854">00154</a> cPacket* <a class="code" href="class_s_c_t_p_server.html#a9079c3bc9e2380b15e4124cb3197c854">SCTPServer::makeDefaultReceive</a>()
<a name="l00155"></a>00155 {
<a name="l00156"></a>00156     cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;DefaultReceive&quot;</span>);
<a name="l00157"></a>00157     <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>(<span class="stringliteral">&quot;Send3&quot;</span>);
<a name="l00158"></a>00158     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00159"></a>00159     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(0);
<a name="l00160"></a>00160     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a37523301d495d32f6e84defd8efe6c26">setNumMsgs</a>(1);
<a name="l00161"></a>00161     cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea2ba582af18939c296a16e1b083e74397">SCTP_C_RECEIVE</a>);
<a name="l00162"></a>00162     cmsg-&gt;setControlInfo(cmd);
<a name="l00163"></a>00163     <span class="keywordflow">return</span> cmsg;
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="class_s_c_t_p_server.html#a0fc583f2d5fb63f5b7e5c33e607fd98d">00166</a> cPacket* <a class="code" href="class_s_c_t_p_server.html#a0fc583f2d5fb63f5b7e5c33e607fd98d">SCTPServer::makeAbortNotification</a>(<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>* msg)
<a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *ind = check_and_cast&lt;<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *&gt;(msg);
<a name="l00169"></a>00169     cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;AbortNotification&quot;</span>);
<a name="l00170"></a>00170     <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>(<span class="stringliteral">&quot;Send4&quot;</span>);
<a name="l00171"></a>00171     <a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a> = ind-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>();
<a name="l00172"></a>00172     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00173"></a>00173     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(ind-&gt;<a class="code" href="class_s_c_t_p_command.html#adb637d33f742c0510f40f73e030f360e">getSid</a>());
<a name="l00174"></a>00174     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a37523301d495d32f6e84defd8efe6c26">setNumMsgs</a>(ind-&gt;<a class="code" href="class_s_c_t_p_command.html#a92f0f9644b4f5ec70df1dcbd0c242b7d">getNumMsgs</a>());
<a name="l00175"></a>00175     cmsg-&gt;setControlInfo(cmd);
<a name="l00176"></a>00176     <span class="keyword">delete</span> ind;
<a name="l00177"></a>00177     <span class="comment">//delete msg;</span>
<a name="l00178"></a>00178     cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea7d45ef3a5ccaa811a5edd77a342bc3b0">SCTP_C_ABORT</a>);
<a name="l00179"></a>00179     <span class="keywordflow">return</span> cmsg;
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="class_s_c_t_p_server.html#a6dbf9b85ee7abab61ac8b4bbd6cc74b6">00182</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#a6dbf9b85ee7abab61ac8b4bbd6cc74b6">SCTPServer::handleMessage</a>(cMessage *msg)
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184     int32 id;
<a name="l00185"></a>00185     cPacket* cmsg;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
<a name="l00188"></a>00188     {
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <a class="code" href="class_s_c_t_p_server.html#a093fe8eef5ec0367decd9a8a4a7d743b">handleTimer</a>(msg);
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192     <span class="keywordflow">else</span>
<a name="l00193"></a>00193     {
<a name="l00194"></a>00194     <span class="keywordflow">switch</span> (msg-&gt;getKind())
<a name="l00195"></a>00195     {
<a name="l00196"></a>00196         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3adcb0d50416fbeb73876eba7d7b8ee930">SCTP_I_PEER_CLOSED</a>:
<a name="l00197"></a>00197         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a72ee49d265f6c75166038f085a52a1bf">SCTP_I_ABORT</a>:
<a name="l00198"></a>00198         {
<a name="l00199"></a>00199             <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *command = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *<span class="keyword">&gt;</span>(msg-&gt;removeControlInfo());
<a name="l00200"></a>00200             <a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a> = command-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>();
<a name="l00201"></a>00201             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].peerClosed = <span class="keyword">true</span>;
<a name="l00202"></a>00202             <span class="keywordflow">if</span> ((<span class="keywordtype">long</span>) par(<span class="stringliteral">&quot;numPacketsToReceivePerClient&quot;</span>)==0)
<a name="l00203"></a>00203             {
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].<a class="code" href="class_s_c_t_p_server.html#a4fef3f92f12d3ad426ca17e7a17e789e">abortSent</a>==<span class="keyword">false</span>)
<a name="l00205"></a>00205                 {
<a name="l00206"></a>00206                     <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(<a class="code" href="class_s_c_t_p_server.html#a0fc583f2d5fb63f5b7e5c33e607fd98d">makeAbortNotification</a>(command-&gt;<a class="code" href="class_s_c_t_p_command.html#ac1faf48524f7abc3cf23cd5bf0502d06">dup</a>()));
<a name="l00207"></a>00207                     <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].abortSent = <span class="keyword">true</span>;
<a name="l00208"></a>00208                 }
<a name="l00209"></a>00209             }
<a name="l00210"></a>00210             <span class="keywordflow">else</span>
<a name="l00211"></a>00211             {
<a name="l00212"></a>00212                 <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].rcvdPackets==(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) par(<span class="stringliteral">&quot;numPacketsToReceivePerClient&quot;</span>) &amp;&amp;
<a name="l00213"></a>00213                     <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].<a class="code" href="class_s_c_t_p_server.html#a4fef3f92f12d3ad426ca17e7a17e789e">abortSent</a>==<span class="keyword">false</span>)
<a name="l00214"></a>00214                 {
<a name="l00215"></a>00215                     <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(<a class="code" href="class_s_c_t_p_server.html#a0fc583f2d5fb63f5b7e5c33e607fd98d">makeAbortNotification</a>(command-&gt;<a class="code" href="class_s_c_t_p_command.html#ac1faf48524f7abc3cf23cd5bf0502d06">dup</a>()));
<a name="l00216"></a>00216                     <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].abortSent = <span class="keyword">true</span>;
<a name="l00217"></a>00217                 }
<a name="l00218"></a>00218             }
<a name="l00219"></a>00219             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>-&gt;isScheduled())
<a name="l00220"></a>00220                 cancelEvent(<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00221"></a>00221             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>-&gt;isScheduled())
<a name="l00222"></a>00222                 cancelEvent(<a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>);
<a name="l00223"></a>00223             <span class="keyword">delete</span> command;
<a name="l00224"></a>00224             <span class="keyword">delete</span> msg;
<a name="l00225"></a>00225             <span class="keywordflow">break</span>;
<a name="l00226"></a>00226         }
<a name="l00227"></a>00227         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a6b85de91f4bd3609fc7bcd7994101a3d">SCTP_I_ESTABLISHED</a>:
<a name="l00228"></a>00228         {
<a name="l00229"></a>00229             <a class="code" href="class_s_c_t_p_server.html#aae3ed98865cf200ed1592ab468ed4561">count</a>=0;
<a name="l00230"></a>00230             <a class="code" href="class_s_c_t_p_connect_info.html">SCTPConnectInfo</a> *connectInfo = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_s_c_t_p_connect_info.html">SCTPConnectInfo</a> *<span class="keyword">&gt;</span>(msg-&gt;removeControlInfo());
<a name="l00231"></a>00231             <a class="code" href="class_s_c_t_p_server.html#a0e171815eedbf2379e1d869284374fed">numSessions</a>++;
<a name="l00232"></a>00232             <a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>();
<a name="l00233"></a>00233             <a class="code" href="class_s_c_t_p_server.html#a251e4670192345c198ee23d759d3b358">inboundStreams</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#abb8ae2048274398bbc89734c6ae3766e">getInboundStreams</a>();
<a name="l00234"></a>00234             <a class="code" href="class_s_c_t_p_server.html#a40783a4ecb36dc4921aa6d668b0b271f">outboundStreams</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#af5195ae63edd8eb3ab64bead078cdf04">getOutboundStreams</a>();
<a name="l00235"></a>00235             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].rcvdPackets= (long) par(<span class="stringliteral">&quot;numPacketsToReceivePerClient&quot;</span>);
<a name="l00236"></a>00236             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].sentPackets= (long) par(<span class="stringliteral">&quot;numPacketsToSendPerClient&quot;</span>);
<a name="l00237"></a>00237             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].rcvdBytes=0;
<a name="l00238"></a>00238             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].start=0;
<a name="l00239"></a>00239             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].stop=0;
<a name="l00240"></a>00240             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].lifeTime=0;
<a name="l00241"></a>00241             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].abortSent=<span class="keyword">false</span>;
<a name="l00242"></a>00242             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].peerClosed = <span class="keyword">false</span>;
<a name="l00243"></a>00243             <span class="keywordtype">char</span> text[30];
<a name="l00244"></a>00244             sprintf(text, <span class="stringliteral">&quot;App: Received Bytes of assoc %d&quot;</span>,<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00245"></a>00245             <a class="code" href="class_s_c_t_p_server.html#a89ef3395b677899b156b7658e4d5d6f3">bytesPerAssoc</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>] = <span class="keyword">new</span> cOutVector(text);
<a name="l00246"></a>00246             sprintf(text, <span class="stringliteral">&quot;App: EndToEndDelay of assoc %d&quot;</span>,<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00247"></a>00247             <a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>] = <span class="keyword">new</span> cOutVector(text);
<a name="l00248"></a>00248 
<a name="l00249"></a>00249             <span class="keyword">delete</span> connectInfo;
<a name="l00250"></a>00250             <span class="keyword">delete</span> msg;
<a name="l00251"></a>00251             <span class="keywordflow">if</span> ((<span class="keywordtype">long</span>) par(<span class="stringliteral">&quot;numPacketsToSendPerClient&quot;</span>) &gt; 0)
<a name="l00252"></a>00252             {
<a name="l00253"></a>00253                 ServerAssocStatMap::iterator i = <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.find(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00254"></a>00254                 <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a> = i-&gt;second.sentPackets;
<a name="l00255"></a>00255                 <span class="keywordflow">if</span> ((simtime_t)par(<span class="stringliteral">&quot;thinkTime&quot;</span>) &gt; 0)
<a name="l00256"></a>00256                 {
<a name="l00257"></a>00257                     <a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">generateAndSend</a>();
<a name="l00258"></a>00258                     <a class="code" href="class_s_c_t_p_server.html#aa39760cbcbc9f13ce9abbfa319eb498b">timeoutMsg</a>-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eacb34da0d2a8bc9071c353d5e92ab0d94">SCTP_C_SEND</a>);
<a name="l00259"></a>00259                     scheduleAt(simulation.getSimTime()+(simtime_t)par(<span class="stringliteral">&quot;thinkTime&quot;</span>), <a class="code" href="class_s_c_t_p_server.html#aa39760cbcbc9f13ce9abbfa319eb498b">timeoutMsg</a>);
<a name="l00260"></a>00260                     <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>--;
<a name="l00261"></a>00261                     i-&gt;second.sentPackets = numRequestsToSend;
<a name="l00262"></a>00262                 }
<a name="l00263"></a>00263                 <span class="keywordflow">else</span>
<a name="l00264"></a>00264                 {
<a name="l00265"></a>00265                     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>==0)
<a name="l00266"></a>00266                     {
<a name="l00267"></a>00267                         <span class="keywordflow">while</span> (<a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a> &gt; 0)
<a name="l00268"></a>00268                         {
<a name="l00269"></a>00269                             <a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">generateAndSend</a>();
<a name="l00270"></a>00270                             <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>--;
<a name="l00271"></a>00271                             i-&gt;second.sentPackets = <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>;
<a name="l00272"></a>00272                         }
<a name="l00273"></a>00273                     }
<a name="l00274"></a>00274                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>&gt;0)
<a name="l00275"></a>00275                     {
<a name="l00276"></a>00276                         <span class="keywordflow">while</span> (<a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a> &gt; 0 &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#aae3ed98865cf200ed1592ab468ed4561">count</a>++ &lt; <a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>*2)
<a name="l00277"></a>00277                         {
<a name="l00278"></a>00278                             <a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">generateAndSend</a>();
<a name="l00279"></a>00279                             <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>--;
<a name="l00280"></a>00280                             i-&gt;second.sentPackets = <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>;
<a name="l00281"></a>00281                         }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283                         cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Queue&quot;</span>);
<a name="l00284"></a>00284                         <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>* qinfo = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>(<span class="stringliteral">&quot;Info1&quot;</span>);
<a name="l00285"></a>00285                         qinfo-&gt;<a class="code" href="class_s_c_t_p_info.html#afca097e5e046ec9282fc679f2081d8ca">setText</a>(<a class="code" href="class_s_c_t_p_server.html#a0783bfe9aa5d31308b4c8f438eb03de0">queueSize</a>);
<a name="l00286"></a>00286                         cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea4fe02c6f134855267e6f95cf92fadee1">SCTP_C_QUEUE_MSGS_LIMIT</a>);
<a name="l00287"></a>00287                         qinfo-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<span class="keywordtype">id</span>);
<a name="l00288"></a>00288                         cmsg-&gt;setControlInfo(qinfo);
<a name="l00289"></a>00289                         <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00290"></a>00290                     }
<a name="l00291"></a>00291                     ServerAssocStatMap::iterator j=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.find(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00292"></a>00292                     <span class="keywordflow">if</span> (j-&gt;second.rcvdPackets == 0 &amp;&amp; (simtime_t)par(<span class="stringliteral">&quot;waitToClose&quot;</span>)&gt;0)
<a name="l00293"></a>00293                     {
<a name="l00294"></a>00294                         <span class="keywordtype">char</span> as[5];
<a name="l00295"></a>00295                         sprintf(as, <span class="stringliteral">&quot;%d&quot;</span>,<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00296"></a>00296                         cPacket* abortMsg = <span class="keyword">new</span> cPacket(as);
<a name="l00297"></a>00297                         abortMsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a72ee49d265f6c75166038f085a52a1bf">SCTP_I_ABORT</a>);
<a name="l00298"></a>00298                         scheduleAt(simulation.getSimTime()+(simtime_t)par(<span class="stringliteral">&quot;waitToClose&quot;</span>), abortMsg);
<a name="l00299"></a>00299                     }
<a name="l00300"></a>00300                     <span class="keywordflow">else</span>
<a name="l00301"></a>00301                     {
<a name="l00302"></a>00302                         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no more packets to send, call shutdown for assoc &quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00303"></a>00303                         cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;ShutdownRequest&quot;</span>);
<a name="l00304"></a>00304                         <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>* cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>(<span class="stringliteral">&quot;Send5&quot;</span>);
<a name="l00305"></a>00305                         cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea349e117c148f5b223ecef4d8334b7077">SCTP_C_SHUTDOWN</a>);
<a name="l00306"></a>00306                         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(assocId);
<a name="l00307"></a>00307                         cmsg-&gt;setControlInfo(cmd);
<a name="l00308"></a>00308                         <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00309"></a>00309                     }
<a name="l00310"></a>00310                 }
<a name="l00311"></a>00311             }
<a name="l00312"></a>00312             <span class="keywordflow">break</span>;
<a name="l00313"></a>00313         }
<a name="l00314"></a>00314         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a723241390fabc3b46cb79e9f5541b01b">SCTP_I_DATA_NOTIFICATION</a>:
<a name="l00315"></a>00315         {
<a name="l00316"></a>00316             <a class="code" href="class_s_c_t_p_server.html#a733ca06a94bdde0ff88484fa36068e9a">notifications</a>++;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 
<a name="l00319"></a>00319             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a9675d1e5bfa56a81a7e09d172f13302d">schedule</a>==<span class="keyword">false</span>)
<a name="l00320"></a>00320             {
<a name="l00321"></a>00321                 <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a>&gt;0 &amp;&amp; !<a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>-&gt;isScheduled())
<a name="l00322"></a>00322                 {
<a name="l00323"></a>00323 
<a name="l00324"></a>00324                     cmsg=<a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">makeReceiveRequest</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00325"></a>00325                     scheduleAt(simulation.getSimTime()+<a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a>, cmsg);
<a name="l00326"></a>00326                     scheduleAt(simulation.getSimTime()+<a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a>, <a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>);
<a name="l00327"></a>00327                 }
<a name="l00328"></a>00328                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a> &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#ae0a0de00763a065f55e2421cec66fdff">firstData</a>)
<a name="l00329"></a>00329                 {
<a name="l00330"></a>00330                     <a class="code" href="class_s_c_t_p_server.html#ae0a0de00763a065f55e2421cec66fdff">firstData</a>=<span class="keyword">false</span>;
<a name="l00331"></a>00331                     cmsg=<a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">makeReceiveRequest</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00332"></a>00332                     scheduleAt(simulation.getSimTime()+(simtime_t)par(<span class="stringliteral">&quot;readingInterval&quot;</span>), <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00333"></a>00333                     <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00334"></a>00334                 }
<a name="l00335"></a>00335                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a>==0 &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a>==<span class="keyword">false</span>)
<a name="l00336"></a>00336                 {
<a name="l00337"></a>00337                     cmsg=<a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">makeReceiveRequest</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00338"></a>00338                     <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00339"></a>00339                 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341             }
<a name="l00342"></a>00342             <span class="keywordflow">else</span>
<a name="l00343"></a>00343             {
<a name="l00344"></a>00344                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;simulation.getSimTime()&lt;&lt;<span class="stringliteral">&quot; makeReceiveRequest\n&quot;</span>;
<a name="l00345"></a>00345                 cmsg=<a class="code" href="class_s_c_t_p_server.html#a63d027f58f616a07beae45f3b54ccb38">makeReceiveRequest</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00346"></a>00346                 <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00347"></a>00347             }
<a name="l00348"></a>00348             <span class="keyword">delete</span> msg;
<a name="l00349"></a>00349             <span class="keywordflow">break</span>;
<a name="l00350"></a>00350         }
<a name="l00351"></a>00351         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a1eb9f18f68a700c545427ba5231a9dc4">SCTP_I_DATA</a>:
<a name="l00352"></a>00352         {
<a name="l00353"></a>00353             <a class="code" href="class_s_c_t_p_server.html#a733ca06a94bdde0ff88484fa36068e9a">notifications</a>--;
<a name="l00354"></a>00354             <a class="code" href="class_s_c_t_p_server.html#a55929241e5bcd30855a2edab73f24814">packetsRcvd</a>++;
<a name="l00355"></a>00355             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;simulation.getSimTime()&lt;&lt;<span class="stringliteral">&quot; server: data arrived. &quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_server.html#a55929241e5bcd30855a2edab73f24814">packetsRcvd</a>&lt;&lt;<span class="stringliteral">&quot; Packets received now\n&quot;</span>;
<a name="l00356"></a>00356             <a class="code" href="class_s_c_t_p_rcv_command.html">SCTPRcvCommand</a> *ind = check_and_cast&lt;<a class="code" href="class_s_c_t_p_rcv_command.html">SCTPRcvCommand</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00357"></a>00357             <span class="keywordtype">id</span> = ind-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>();
<a name="l00358"></a>00358             ServerAssocStatMap::iterator j=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.find(<span class="keywordtype">id</span>);
<a name="l00359"></a>00359             BytesPerAssoc::iterator k=<a class="code" href="class_s_c_t_p_server.html#a89ef3395b677899b156b7658e4d5d6f3">bytesPerAssoc</a>.find(<span class="keywordtype">id</span>);
<a name="l00360"></a>00360             <span class="keywordflow">if</span> (j-&gt;second.rcvdBytes == 0)
<a name="l00361"></a>00361                 j-&gt;second.start = simulation.getSimTime();
<a name="l00362"></a>00362 
<a name="l00363"></a>00363             j-&gt;second.rcvdBytes+= <a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg)-&gt;getByteLength();
<a name="l00364"></a>00364             k-&gt;second-&gt;record(j-&gt;second.rcvdBytes);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a94dbc6b1477183c2fb909a5ff423d5a2">echoFactor</a>==0)
<a name="l00367"></a>00367             {
<a name="l00368"></a>00368                 <span class="keywordflow">if</span> ((<span class="keywordtype">long</span> uint32)par(<span class="stringliteral">&quot;numPacketsToReceivePerClient&quot;</span>)&gt;0)
<a name="l00369"></a>00369                 {
<a name="l00370"></a>00370                     j-&gt;second.rcvdPackets--;
<a name="l00371"></a>00371                     <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a> *smsg=check_and_cast&lt;<a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>*&gt;(msg);
<a name="l00372"></a>00372                     EndToEndDelay::iterator m=<a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>.find(<span class="keywordtype">id</span>);
<a name="l00373"></a>00373                     m-&gt;second-&gt;record(simulation.getSimTime()-smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a7f4c607bc10f75748daf2626a775c7a7">getCreationTime</a>());
<a name="l00374"></a>00374                     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;server: Data received. Left packets to receive=&quot;</span>&lt;&lt;j-&gt;second.rcvdPackets&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00375"></a>00375 
<a name="l00376"></a>00376                     <span class="keywordflow">if</span> (j-&gt;second.rcvdPackets == 0)
<a name="l00377"></a>00377                     {
<a name="l00378"></a>00378                         <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].peerClosed==<span class="keyword">true</span> &amp;&amp; <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].<a class="code" href="class_s_c_t_p_server.html#a4fef3f92f12d3ad426ca17e7a17e789e">abortSent</a>==<span class="keyword">false</span>)
<a name="l00379"></a>00379                         {
<a name="l00380"></a>00380                             <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(<a class="code" href="class_s_c_t_p_server.html#a0fc583f2d5fb63f5b7e5c33e607fd98d">makeAbortNotification</a>(ind));
<a name="l00381"></a>00381                             <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>[<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>].abortSent = <span class="keyword">true</span>;
<a name="l00382"></a>00382                             j-&gt;second.stop = simulation.getSimTime();
<a name="l00383"></a>00383                             j-&gt;second.lifeTime = j-&gt;second.stop - j-&gt;second.start;
<a name="l00384"></a>00384                             <span class="keywordflow">break</span>;
<a name="l00385"></a>00385                         }
<a name="l00386"></a>00386                         <span class="keywordflow">else</span>
<a name="l00387"></a>00387                         {
<a name="l00388"></a>00388                             cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Request&quot;</span>);
<a name="l00389"></a>00389                             <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>* qinfo = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>(<span class="stringliteral">&quot;Info2&quot;</span>);
<a name="l00390"></a>00390                             cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eaaf691bde7e4b92ce33b4579760761a62">SCTP_C_NO_OUTSTANDING</a>);
<a name="l00391"></a>00391                             qinfo-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<span class="keywordtype">id</span>);
<a name="l00392"></a>00392                             cmsg-&gt;setControlInfo(qinfo);
<a name="l00393"></a>00393                             <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00394"></a>00394                             j-&gt;second.stop = simulation.getSimTime();
<a name="l00395"></a>00395                             j-&gt;second.lifeTime = j-&gt;second.stop - j-&gt;second.start;
<a name="l00396"></a>00396                         }
<a name="l00397"></a>00397                     }
<a name="l00398"></a>00398                 }
<a name="l00399"></a>00399                 <span class="keyword">delete</span> msg;
<a name="l00400"></a>00400             }
<a name="l00401"></a>00401             <span class="keywordflow">else</span>
<a name="l00402"></a>00402             {
<a name="l00403"></a>00403                 <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>(<span class="stringliteral">&quot;Send6&quot;</span>);
<a name="l00404"></a>00404                 cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<span class="keywordtype">id</span>);
<a name="l00405"></a>00405                 <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a> *smsg=check_and_cast&lt;<a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>*&gt;(msg-&gt;dup());
<a name="l00406"></a>00406                 EndToEndDelay::iterator n=<a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>.find(<span class="keywordtype">id</span>);
<a name="l00407"></a>00407                 n-&gt;second-&gt;record(simulation.getSimTime()-smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a7f4c607bc10f75748daf2626a775c7a7">getCreationTime</a>());
<a name="l00408"></a>00408                 cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;SVData&quot;</span>);
<a name="l00409"></a>00409                 <a class="code" href="class_s_c_t_p_server.html#a24f25fbfd5abf8039b77dedd4ebaa00d">bytesSent</a>+=smsg-&gt;getBitLength()/8;
<a name="l00410"></a>00410                 cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff4b63211a335d3580c32293a0cc72eb">setSendUnordered</a>(cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#ac3d2ee91a47f3a31d832fa32689a706e">getSendUnordered</a>());
<a name="l00411"></a>00411                 <a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>=(<a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>+1)%<a class="code" href="class_s_c_t_p_server.html#a40783a4ecb36dc4921aa6d668b0b271f">outboundStreams</a>;
<a name="l00412"></a>00412                 cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(<a class="code" href="class_s_c_t_p_server.html#a17ec661fe75a335bddb0ee07b7fed021">lastStream</a>);
<a name="l00413"></a>00413                 cmd-&gt;<a class="code" href="class_s_c_t_p_send_command.html#a014dfdf2b2d35254c0aa2e2e79bef280">setLast</a>(<span class="keyword">true</span>);
<a name="l00414"></a>00414                 cmsg-&gt;encapsulate(smsg);
<a name="l00415"></a>00415                 cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eacb34da0d2a8bc9071c353d5e92ab0d94">SCTP_C_SEND</a>);
<a name="l00416"></a>00416                 cmsg-&gt;setControlInfo(cmd);
<a name="l00417"></a>00417                 <a class="code" href="class_s_c_t_p_server.html#a288aa635dcea19fb16d48ec4022e6704">packetsSent</a>++;
<a name="l00418"></a>00418                 <span class="keyword">delete</span> msg;
<a name="l00419"></a>00419                 <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00420"></a>00420             }
<a name="l00421"></a>00421             <span class="keyword">delete</span> ind;
<a name="l00422"></a>00422             <span class="keywordflow">break</span>;
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a21bb0580e0fb02c3a89d63062a14b88b">SCTP_I_SHUTDOWN_RECEIVED</a>:
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426             <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *command = check_and_cast&lt;<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00427"></a>00427             <span class="keywordtype">id</span> = command-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>();
<a name="l00428"></a>00428             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;server: SCTP_I_SHUTDOWN_RECEIVED for assoc &quot;</span>&lt;&lt;<span class="keywordtype">id</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00429"></a>00429             ServerAssocStatMap::iterator i=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.find(<span class="keywordtype">id</span>);
<a name="l00430"></a>00430             <span class="keywordflow">if</span> (i-&gt;second.sentPackets == 0 || (<span class="keywordtype">long</span>) par(<span class="stringliteral">&quot;numPacketsToSendPerClient&quot;</span>)==0)
<a name="l00431"></a>00431             {
<a name="l00432"></a>00432                 cPacket* cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Request&quot;</span>);
<a name="l00433"></a>00433                 <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>* qinfo = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_info.html">SCTPInfo</a>(<span class="stringliteral">&quot;Info3&quot;</span>);
<a name="l00434"></a>00434                 cmsg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eaaf691bde7e4b92ce33b4579760761a62">SCTP_C_NO_OUTSTANDING</a>);
<a name="l00435"></a>00435                 qinfo-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<span class="keywordtype">id</span>);
<a name="l00436"></a>00436                 cmsg-&gt;setControlInfo(qinfo);
<a name="l00437"></a>00437                 <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00438"></a>00438                 i-&gt;second.stop = simulation.getSimTime();
<a name="l00439"></a>00439                 i-&gt;second.lifeTime = i-&gt;second.stop - i-&gt;second.start;
<a name="l00440"></a>00440             }
<a name="l00441"></a>00441             <span class="keyword">delete</span> command;
<a name="l00442"></a>00442             <a class="code" href="class_s_c_t_p_server.html#a85ff1b90c417e2bd0090b5d76de7efcd">shutdownReceived</a> = <span class="keyword">true</span>;
<a name="l00443"></a>00443             <span class="keyword">delete</span> msg;
<a name="l00444"></a>00444             <span class="keywordflow">break</span>;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3ace58e516838fe8c15ac9ce67f4f4409c">SCTP_I_CLOSED</a>:
<a name="l00447"></a>00447             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>-&gt;isScheduled())
<a name="l00448"></a>00448                 cancelEvent(<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00449"></a>00449             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a6cafc0845397f64cfba52c7bf3ad3059">finishEndsSimulation</a>) {
<a name="l00450"></a>00450                 endSimulation();
<a name="l00451"></a>00451             }
<a name="l00452"></a>00452             <span class="keyword">delete</span> msg;
<a name="l00453"></a>00453         <span class="keywordflow">break</span>;
<a name="l00454"></a>00454         <span class="keywordflow">default</span>: <span class="keyword">delete</span> msg;
<a name="l00455"></a>00455     }
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457 }
<a name="l00458"></a>00458 
<a name="l00459"></a><a class="code" href="class_s_c_t_p_server.html#a093fe8eef5ec0367decd9a8a4a7d743b">00459</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#a093fe8eef5ec0367decd9a8a4a7d743b">SCTPServer::handleTimer</a>(cMessage *msg)
<a name="l00460"></a>00460 {
<a name="l00461"></a>00461     cPacket* cmsg;
<a name="l00462"></a>00462     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>* cmd;
<a name="l00463"></a>00463     int32 id;
<a name="l00464"></a>00464     <span class="keywordtype">double</span> tempInterval;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (msg==<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>)
<a name="l00467"></a>00467     {
<a name="l00468"></a>00468         ServerAssocStatMap::iterator i=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.find(<a class="code" href="class_s_c_t_p_server.html#aab27b4848f05f4ed3970e5816a4e7257">assocId</a>);
<a name="l00469"></a>00469         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;simulation.getSimTime()&lt;&lt;<span class="stringliteral">&quot; delayTimer expired\n&quot;</span>;
<a name="l00470"></a>00470         <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(<a class="code" href="class_s_c_t_p_server.html#a9079c3bc9e2380b15e4124cb3197c854">makeDefaultReceive</a>());
<a name="l00471"></a>00471         scheduleAt(simulation.getSimTime()+(double)par(<span class="stringliteral">&quot;readingInterval&quot;</span>), <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00472"></a>00472         <span class="keywordflow">return</span>;
<a name="l00473"></a>00473     }
<a name="l00474"></a>00474     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg==<a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>)
<a name="l00475"></a>00475     {
<a name="l00476"></a>00476         <a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a> = 0;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478         <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a> &amp;&amp; !<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>-&gt;isScheduled())
<a name="l00479"></a>00479         {
<a name="l00480"></a>00480             tempInterval = (double)par(<span class="stringliteral">&quot;readingInterval&quot;</span>);
<a name="l00481"></a>00481             scheduleAt(simulation.getSimTime()+(simtime_t)tempInterval, <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00482"></a>00482             scheduleAt(simulation.getSimTime()+(simtime_t)tempInterval, <a class="code" href="class_s_c_t_p_server.html#a9079c3bc9e2380b15e4124cb3197c854">makeDefaultReceive</a>());
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484         <span class="keywordflow">return</span>;
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="keywordflow">switch</span> (msg-&gt;getKind())
<a name="l00488"></a>00488     {
<a name="l00489"></a>00489     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eacb34da0d2a8bc9071c353d5e92ab0d94">SCTP_C_SEND</a>:
<a name="l00490"></a>00490         <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>&gt;0)
<a name="l00491"></a>00491         {
<a name="l00492"></a>00492             <a class="code" href="class_s_c_t_p_server.html#a49594599727e46b391d45c5e4988a5f2">generateAndSend</a>();
<a name="l00493"></a>00493             <span class="keywordflow">if</span> ((simtime_t)par(<span class="stringliteral">&quot;thinkTime&quot;</span>) &gt; 0)
<a name="l00494"></a>00494                 scheduleAt(simulation.getSimTime()+(simtime_t)par(<span class="stringliteral">&quot;thinkTime&quot;</span>), <a class="code" href="class_s_c_t_p_server.html#aa39760cbcbc9f13ce9abbfa319eb498b">timeoutMsg</a>);
<a name="l00495"></a>00495             <a class="code" href="class_s_c_t_p_server.html#a96df668c37434fc7f0b1945c16d80158">numRequestsToSend</a>--;
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497         <span class="keywordflow">break</span>;
<a name="l00498"></a>00498     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a72ee49d265f6c75166038f085a52a1bf">SCTP_I_ABORT</a>:
<a name="l00499"></a>00499 
<a name="l00500"></a>00500         cmsg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;CLOSE&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea36c1bad836563c7468a9877491b1db5d">SCTP_C_CLOSE</a>);
<a name="l00501"></a>00501         cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>(<span class="stringliteral">&quot;Send6&quot;</span>);
<a name="l00502"></a>00502         <span class="keywordtype">id</span> = atoi(msg-&gt;getName());
<a name="l00503"></a>00503               cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<span class="keywordtype">id</span>);
<a name="l00504"></a>00504         cmsg-&gt;setControlInfo(cmd);
<a name="l00505"></a>00505         <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(cmsg);
<a name="l00506"></a>00506         <span class="keywordflow">break</span>;
<a name="l00507"></a>00507     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea2ba582af18939c296a16e1b083e74397">SCTP_C_RECEIVE</a>:
<a name="l00508"></a>00508         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;simulation.getSimTime()&lt;&lt;<span class="stringliteral">&quot; SCTPServer:SCTP_C_RECEIVE\n&quot;</span>;
<a name="l00509"></a>00509         <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a25bd2693d0f6fbb51cf55d218cfcb240">readInt</a> || <a class="code" href="class_s_c_t_p_server.html#aa0ff7f5562682a0a7f255ab8fa697ffc">delayFirstRead</a> &gt; 0)
<a name="l00510"></a>00510             <a class="code" href="class_s_c_t_p_server.html#a9675d1e5bfa56a81a7e09d172f13302d">schedule</a> = <span class="keyword">false</span>;
<a name="l00511"></a>00511         <span class="keywordflow">else</span>
<a name="l00512"></a>00512             <a class="code" href="class_s_c_t_p_server.html#a9675d1e5bfa56a81a7e09d172f13302d">schedule</a> = <span class="keyword">true</span>;
<a name="l00513"></a>00513         <a class="code" href="class_s_c_t_p_server.html#af7344aa519b392472752795fada8610c">sendOrSchedule</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00514"></a>00514         <span class="keywordflow">break</span>;
<a name="l00515"></a>00515     <span class="keywordflow">default</span>:
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;MsgKind =&quot;</span>&lt;&lt;msg-&gt;getKind()&lt;&lt;<span class="stringliteral">&quot; unknown\n&quot;</span>;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="keywordflow">break</span>;
<a name="l00520"></a>00520     }
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 
<a name="l00523"></a><a class="code" href="class_s_c_t_p_server.html#a8e5afdc7ab8bc43df5780d356309fd2e">00523</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_server.html#a8e5afdc7ab8bc43df5780d356309fd2e">SCTPServer::finish</a>()
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525     <span class="keyword">delete</span> <a class="code" href="class_s_c_t_p_server.html#aa39760cbcbc9f13ce9abbfa319eb498b">timeoutMsg</a>;
<a name="l00526"></a>00526     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>-&gt;isScheduled())
<a name="l00527"></a>00527         cancelEvent(<a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>);
<a name="l00528"></a>00528     <span class="keyword">delete</span> <a class="code" href="class_s_c_t_p_server.html#a83c9f8076eed512a6baa0ca46bfd08c9">delayTimer</a>;
<a name="l00529"></a>00529     <span class="keyword">delete</span> <a class="code" href="class_s_c_t_p_server.html#a70e57a6b568e8c41f10893c925e1ac95">delayFirstReadTimer</a>;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;: opened &quot;</span> &lt;&lt; <a class="code" href="class_s_c_t_p_server.html#a0e171815eedbf2379e1d869284374fed">numSessions</a> &lt;&lt; <span class="stringliteral">&quot; sessions\n&quot;</span>;
<a name="l00532"></a>00532     ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;: sent &quot;</span> &lt;&lt; <a class="code" href="class_s_c_t_p_server.html#a24f25fbfd5abf8039b77dedd4ebaa00d">bytesSent</a> &lt;&lt; <span class="stringliteral">&quot; bytes in &quot;</span> &lt;&lt; <a class="code" href="class_s_c_t_p_server.html#a288aa635dcea19fb16d48ec4022e6704">packetsSent</a> &lt;&lt; <span class="stringliteral">&quot; packets\n&quot;</span>;
<a name="l00533"></a>00533     <span class="keywordflow">for</span> (ServerAssocStatMap::iterator l=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.begin(); l!=<a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.end(); l++)
<a name="l00534"></a>00534     {
<a name="l00535"></a>00535         ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot; Assoc: &quot;</span>&lt;&lt;l-&gt;first&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00536"></a>00536         ev &lt;&lt; <span class="stringliteral">&quot;\tstart time: &quot;</span>&lt;&lt;l-&gt;second.start &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00537"></a>00537         ev &lt;&lt; <span class="stringliteral">&quot;\tstop time: &quot;</span>&lt;&lt;l-&gt;second.stop &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00538"></a>00538         ev &lt;&lt; <span class="stringliteral">&quot;\tlife time: &quot;</span>&lt;&lt;l-&gt;second.lifeTime &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00539"></a>00539         ev &lt;&lt; <span class="stringliteral">&quot;\treceived bytes:&quot;</span> &lt;&lt; l-&gt;second.rcvdBytes &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00540"></a>00540         ev &lt;&lt; <span class="stringliteral">&quot;\tthroughput: &quot;</span>&lt;&lt;(l-&gt;second.rcvdBytes / l-&gt;second.lifeTime.dbl())*8 &lt;&lt;<span class="stringliteral">&quot; bit/sec\n&quot;</span>;
<a name="l00541"></a>00541         recordScalar(<span class="stringliteral">&quot;bytes rcvd&quot;</span>, l-&gt;second.rcvdBytes);
<a name="l00542"></a>00542         recordScalar(<span class="stringliteral">&quot;throughput&quot;</span>, (l-&gt;second.rcvdBytes / l-&gt;second.lifeTime.dbl())*8);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545     ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;Over all &quot;</span> &lt;&lt; <a class="code" href="class_s_c_t_p_server.html#a55929241e5bcd30855a2edab73f24814">packetsRcvd</a> &lt;&lt; <span class="stringliteral">&quot; packets received\n &quot;</span>;
<a name="l00546"></a>00546     ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;Over all &quot;</span> &lt;&lt; <a class="code" href="class_s_c_t_p_server.html#a733ca06a94bdde0ff88484fa36068e9a">notifications</a> &lt;&lt; <span class="stringliteral">&quot; notifications received\n &quot;</span>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     BytesPerAssoc::iterator j;
<a name="l00549"></a>00549     <span class="keywordflow">while</span> ((j = <a class="code" href="class_s_c_t_p_server.html#a89ef3395b677899b156b7658e4d5d6f3">bytesPerAssoc</a>.begin())!= <a class="code" href="class_s_c_t_p_server.html#a89ef3395b677899b156b7658e4d5d6f3">bytesPerAssoc</a>.end())
<a name="l00550"></a>00550     {
<a name="l00551"></a>00551         <span class="keyword">delete</span> j-&gt;second;
<a name="l00552"></a>00552         <a class="code" href="class_s_c_t_p_server.html#a89ef3395b677899b156b7658e4d5d6f3">bytesPerAssoc</a>.erase(j);
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554     EndToEndDelay::iterator k;
<a name="l00555"></a>00555     <span class="keywordflow">while</span> ((k = <a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>.begin())!= <a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>.end())
<a name="l00556"></a>00556     {
<a name="l00557"></a>00557         <span class="keyword">delete</span> k-&gt;second;
<a name="l00558"></a>00558         <a class="code" href="class_s_c_t_p_server.html#ab8f7cd058dd9da883c18c56f3e4a863c">endToEndDelay</a>.erase(k);
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     <a class="code" href="class_s_c_t_p_server.html#a35a644924ea688fc6bfef860571e2e8b">serverAssocStatMap</a>.clear();
<a name="l00561"></a>00561     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Server finished\n&quot;</span>;
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="class_s_c_t_p_server.html#abc8b1c9c58c358c331738a0975941384">00564</a> <a class="code" href="class_s_c_t_p_server.html#abc8b1c9c58c358c331738a0975941384">SCTPServer::~SCTPServer</a>()
<a name="l00565"></a>00565 {
<a name="l00566"></a>00566     <span class="keyword">delete</span> <a class="code" href="class_s_c_t_p_server.html#a9ccf3d527896588b2590ef24523813dc">socket</a>;
<a name="l00567"></a>00567 }
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:30 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
