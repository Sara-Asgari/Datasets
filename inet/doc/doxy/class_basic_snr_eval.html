<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: BasicSnrEval Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>BasicSnrEval Class Reference</h1><!-- doxytag: class="BasicSnrEval" --><!-- doxytag: inherits="ChannelAccess" -->
<p>The basic class for all snrEval modules.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BasicSnrEval:</div>
<div class="dynsection">
 <div class="center">
  <img src="class_basic_snr_eval.gif" usemap="#BasicSnrEval_map" alt=""/>
  <map id="BasicSnrEval_map" name="BasicSnrEval_map">
<area href="class_channel_access.html" alt="ChannelAccess" shape="rect" coords="55,112,156,136"/>
<area href="class_basic_module.html" alt="BasicModule" shape="rect" coords="55,56,156,80"/>
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="55,0,156,24"/>
<area href="class_snr_eval.html" alt="SnrEval" shape="rect" coords="55,224,156,248"/>
<area href="class_gilbert_elliot_snr.html" alt="GilbertElliotSnr" shape="rect" coords="0,280,101,304"/>
<area href="class_snr_eval80211.html" alt="SnrEval80211" shape="rect" coords="111,280,212,304"/>
</map>
 </div>
</div>

<p><a href="class_basic_snr_eval-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a89445ede6f19960b30f74d17335ee30f">initialize</a> (int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#a89445ede6f19960b30f74d17335ee30f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a63f8fd5fab971fe18a609c1053624dc1">handleMessage</a> (cMessage *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called every time a message arrives.  <a href="#a63f8fd5fab971fe18a609c1053624dc1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a3670766c937b99c04bdcd84663092c7c">calcDuration</a> (cPacket *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function calculates the duration of the <a class="el" href="class_air_frame.html">AirFrame</a>.  <a href="#a3670766c937b99c04bdcd84663092c7c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a1865474b5fc30b052459a3cb2b9d35fa">getChannelNumber</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the channel we're listening on. This version always returns 0 (single radio channel supported).  <a href="#a1865474b5fc30b052459a3cb2b9d35fa"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader">Handle Messages</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpab8d27efd7842b98784514a28b760dd0"></a>Functions to redefine by the programmer </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a2eec34538f64365af3d19825140dacb8">handleUpperMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fill the header fields, redefine for your own needs...  <a href="#a2eec34538f64365af3d19825140dacb8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a6056d3736b5f4440aa95067f1e03386c">handleSelfMsg</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timer...  <a href="#a6056d3736b5f4440aa95067f1e03386c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a58f6bd32dd024e3bf3bdeb84126f3bb9">handleLowerMsgStart</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate Snr Information before buffering.  <a href="#a58f6bd32dd024e3bf3bdeb84126f3bb9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#aacd0c25177016c20be7e0b6090a7f191">handleLowerMsgEnd</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate SnrInfo after buffering and add the PhySnrList to the message.  <a href="#aacd0c25177016c20be7e0b6090a7f191"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader">Convenience Functions</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrp53bdfa711ff12fb44fc5694cc4f74c67"></a>Functions for convenience - NOT to be modified</p>
<p>These are functions taking care of message encapsulation and message sending. Normally you should not need to alter these but should use them to handle message encasulation and sending. They will wirte all necessary information into packet headers and add or strip the appropriate headers for each layer. </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a2b3c76b94adf5ef26526d4ac0c8db686">bufferMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *frame)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffers message for 'transmission time'.  <a href="#a2b3c76b94adf5ef26526d4ac0c8db686"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a2319ad5b97819e6a106980dd3cf67cf3">unbufferMsg</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffers a message after 'transmission time'.  <a href="#a2319ad5b97819e6a106980dd3cf67cf3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a94a474e2deb6ce756900b1b64ba779df">sendUp</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *, <a class="el" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61">SnrList</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the upper layer.  <a href="#a94a474e2deb6ce756900b1b64ba779df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#ab24fce7973732d213aa991c89de1cf97">sendDown</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the channel.  <a href="#ab24fce7973732d213aa991c89de1cf97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#ad8268ab8f023e50ca32dca40356fa933">encapsMsg</a> (cPacket *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates a MAC frame into an Air Frame.  <a href="#ad8268ab8f023e50ca32dca40356fa933"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader">Abstraction layer</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrp4ed95925e5c49c688bf7d37b5b33f812"></a>Factory function to create <a class="el" href="class_air_frame.html">AirFrame</a> into which a MAC frame is encapsulated.</p>
<p><a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> authors should be able to use their own <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> packets. The framework does not need to know about them, but must be able to produce new ones. Both goals can be reached by using a factory method.</p>
<p>Overwrite this function in derived classes to use your own AirFrames </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#af1205d1afd8805d7f7a0ca16cd9f6e5b">createCapsulePkt</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new <a class="el" href="class_air_frame.html">AirFrame</a>.  <a href="#af1205d1afd8805d7f7a0ca16cd9f6e5b"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a515b273855ffc377f579922d5eb68dfb">bitrate</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">a parameter that has to be read in from omnetpp.ini  <a href="#a515b273855ffc377f579922d5eb68dfb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a25d3734b058a75c1a42b637db4b65902">headerLength</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">a parameter that has to be read in from omnetpp.ini  <a href="#a25d3734b058a75c1a42b637db4b65902"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#adb9a71c73bd1cb87cc91a4708ecc289f">transmitterPower</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">power used to transmit messages  <a href="#adb9a71c73bd1cb87cc91a4708ecc289f"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a8651e49c751d8e8c488eadf25eba2047">uppergateOut</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate id  <a href="#a8651e49c751d8e8c488eadf25eba2047"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_snr_eval.html#a973b2265e5854d65b9ed5e8631b16aa3">uppergateIn</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The basic class for all snrEval modules. </p>
<p>The <a class="el" href="class_basic_snr_eval.html" title="The basic class for all snrEval modules.">BasicSnrEval</a> module provides functionality like en- and decapsulation of messages. If you use the standard message formats everything should work fine. Before a packet is sent some information, e.g. transmission power, can be written to the <a class="el" href="class_air_frame.html">AirFrame</a> header. If you write your own snrEval, just subclass and redefine the handleUpperMsg function (see description of the function). After receiving a message it can be processed in handleLowerMsgStart. Then it is buffered for the time the transmission would last in reality, and then can be handled again. Again you can redefine the 1. handleLowerMsgStart and 2. handleLowerMsgEnd for your own needs (see description). So, the call of these functions represent the following events: 1. received a message (i.e. transmission startet) 2. message will be handed on to the upper layer (i.e. transmission time is over)</p>
<p>This supports a single radio channel only</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Marc Loebbers </dd></dl>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00055">55</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2b3c76b94adf5ef26526d4ac0c8db686"></a><!-- doxytag: member="BasicSnrEval::bufferMsg" ref="a2b3c76b94adf5ef26526d4ac0c8db686" args="(AirFrame *frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::bufferMsg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>frame</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Buffers message for 'transmission time'. </p>
<p>The packet is put in a buffer for the time the transmission would last in reality. A timer indicates when the transmission is complete. So, look at unbufferMsg to see what happens when the transmission is complete.. </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00120">120</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval_8cc_source.html#l00430">SnrEval::changeChannel()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00120"></a>00120                                                     : add <span class="keyword">explicit</span> simtime_t atTime arg?
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122     <span class="comment">// set timer to indicate transmission is complete</span>
<a name="l00123"></a>00123     <a class="code" href="class_transm_complete.html">TransmComplete</a> *endRxTimer = <span class="keyword">new</span> <a class="code" href="class_transm_complete.html">TransmComplete</a>(NULL);
<a name="l00124"></a>00124     endRxTimer-&gt;setContextPointer(frame);
<a name="l00125"></a>00125     frame-&gt;setContextPointer(endRxTimer);
<a name="l00126"></a>00126     <span class="comment">// NOTE: use arrivalTime instead of simTime, because we might be calling this</span>
<a name="l00127"></a>00127     <span class="comment">// function during a channel change, when we&apos;re picking up ongoing transmissions</span>
<a name="l00128"></a>00128     <span class="comment">// on the channel -- and then the message&apos;s arrival time is in the past!</span>
<a name="l00129"></a>00129     scheduleAt(frame-&gt;getArrivalTime() + frame-&gt;<a class="code" href="class_air_frame.html#a564aa81be93f77dfd92846f53d6c9f40">getDuration</a>(), endRxTimer);
<a name="l00130"></a>00130 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3670766c937b99c04bdcd84663092c7c"></a><!-- doxytag: member="BasicSnrEval::calcDuration" ref="a3670766c937b99c04bdcd84663092c7c" args="(cPacket *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BasicSnrEval::calcDuration </td>
          <td>(</td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>af</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function calculates the duration of the <a class="el" href="class_air_frame.html">AirFrame</a>. </p>
<p>Usually the duration is just the frame length divided by the bitrate. However there may be cases (like 802.11) where the header has a different modulation (and thus a different bitrate) than the rest of the message.</p>
<p>Just redefine this function in such a case! </p>

<p>Reimplemented in <a class="el" href="class_snr_eval80211.html#a4839d233ef2b15b59d18b6347316d4b1">SnrEval80211</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00159">159</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">encapsMsg()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00160"></a>00160 {
<a name="l00161"></a>00161     <span class="keywordtype">double</span> duration;
<a name="l00162"></a>00162     duration = (double) af-&gt;getBitLength() / (double) <a class="code" href="class_basic_snr_eval.html#a515b273855ffc377f579922d5eb68dfb" title="a parameter that has to be read in from omnetpp.ini">bitrate</a>;
<a name="l00163"></a>00163     <span class="keywordflow">return</span> duration;
<a name="l00164"></a>00164 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af1205d1afd8805d7f7a0ca16cd9f6e5b"></a><!-- doxytag: member="BasicSnrEval::createCapsulePkt" ref="af1205d1afd8805d7f7a0ca16cd9f6e5b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="class_air_frame.html">AirFrame</a>* BasicSnrEval::createCapsulePkt </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new <a class="el" href="class_air_frame.html">AirFrame</a>. </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00159">159</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">encapsMsg()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00159"></a>00159                                          {
<a name="l00160"></a>00160         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_air_frame.html">AirFrame</a>();
<a name="l00161"></a>00161     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad8268ab8f023e50ca32dca40356fa933"></a><!-- doxytag: member="BasicSnrEval::encapsMsg" ref="ad8268ab8f023e50ca32dca40356fa933" args="(cPacket *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_air_frame.html">AirFrame</a> * BasicSnrEval::encapsMsg </td>
          <td>(</td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encapsulates a MAC frame into an Air Frame. </p>
<p>This function encapsulates messages from the upper layer into an <a class="el" href="class_air_frame.html">AirFrame</a>, copies the type and channel fields, adds the headerLength, sets the pSend (transmitterPower) and returns the <a class="el" href="class_air_frame.html">AirFrame</a>. </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">138</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <a class="code" href="class_air_frame.html">AirFrame</a> *frame = <a class="code" href="class_basic_snr_eval.html#af1205d1afd8805d7f7a0ca16cd9f6e5b" title="Create a new AirFrame.">createCapsulePkt</a>();
<a name="l00141"></a>00141     frame-&gt;setName(msg-&gt;getName());
<a name="l00142"></a>00142     frame-&gt;<a class="code" href="class_air_frame.html#a9d278d987573a57dbd6654e83347d9de">setPSend</a>(<a class="code" href="class_basic_snr_eval.html#adb9a71c73bd1cb87cc91a4708ecc289f" title="power used to transmit messages">transmitterPower</a>);
<a name="l00143"></a>00143     frame-&gt;setBitLength(<a class="code" href="class_basic_snr_eval.html#a25d3734b058a75c1a42b637db4b65902" title="a parameter that has to be read in from omnetpp.ini">headerLength</a>);
<a name="l00144"></a>00144     frame-&gt;<a class="code" href="class_air_frame.html#adb8af0755b960ae4c43e9852a1170c9c">setChannelNumber</a>(<a class="code" href="class_basic_snr_eval.html#a1865474b5fc30b052459a3cb2b9d35fa" title="Returns the channel we&amp;#39;re listening on. This version always returns 0 (single...">getChannelNumber</a>());
<a name="l00145"></a>00145     frame-&gt;encapsulate(msg);
<a name="l00146"></a>00146     frame-&gt;<a class="code" href="class_air_frame.html#a1fb0ced1ea85d343ef257da90d0552e8">setDuration</a>(<a class="code" href="class_basic_snr_eval.html#a3670766c937b99c04bdcd84663092c7c" title="This function calculates the duration of the AirFrame.">calcDuration</a>(frame));
<a name="l00147"></a>00147     frame-&gt;<a class="code" href="class_air_frame.html#a74542f549bb58fd36400b0313a63f364">setSenderPos</a>(<a class="code" href="class_channel_access.html#a9e51969a624ff64101cf808514d50d4f" title="Returns the host&amp;#39;s position.">getMyPosition</a>());
<a name="l00148"></a>00148     <span class="keywordflow">return</span> frame;
<a name="l00149"></a>00149 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1865474b5fc30b052459a3cb2b9d35fa"></a><!-- doxytag: member="BasicSnrEval::getChannelNumber" ref="a1865474b5fc30b052459a3cb2b9d35fa" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int BasicSnrEval::getChannelNumber </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the channel we're listening on. This version always returns 0 (single radio channel supported). </p>

<p>Reimplemented in <a class="el" href="class_snr_eval.html#a7e3112193898e920f38094a8782f1861">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00142">142</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">encapsMsg()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00142"></a>00142 {<span class="keywordflow">return</span> 0;}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aacd0c25177016c20be7e0b6090a7f191"></a><!-- doxytag: member="BasicSnrEval::handleLowerMsgEnd" ref="aacd0c25177016c20be7e0b6090a7f191" args="(AirFrame *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::handleLowerMsgEnd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>frame</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate SnrInfo after buffering and add the PhySnrList to the message. </p>
<p>Redefine this function if you want to process messages from the channel before they are forwarded to upper layers</p>
<p>This function is called right before a packet is handed on to the upper layer, i.e. right after unbufferMsg. Again you can caluculate some more SNR information if you want.</p>
<p>You have to copy / create the SnrList related to the message and pass it to <a class="el" href="class_basic_snr_eval.html#a94a474e2deb6ce756900b1b64ba779df" title="Sends a message to the upper layer.">sendUp()</a> if you want to pass the message to the decider.</p>
<p>Do not forget to send the message to the upper layer with <a class="el" href="class_basic_snr_eval.html#a94a474e2deb6ce756900b1b64ba779df" title="Sends a message to the upper layer.">sendUp()</a></p>
<p>For a "real" implementaion take a look at <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a></p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61" title="List to store SNR information for a message.">SnrList</a>, <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> </dd></dl>

<p>Reimplemented in <a class="el" href="class_gilbert_elliot_snr.html#a8cce1850da492f871c08ddcb3647b2ed">GilbertElliotSnr</a>, and <a class="el" href="class_snr_eval.html#ae4c093f6dc4dc649070947da6051f3b2">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00243">243</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00244"></a>00244 {
<a name="l00245"></a>00245     <a class="code" href="_basic_module_8cc.html#a27f667d27591f62ecf86a99a79ea8f42">coreEV</a> &lt;&lt; <span class="stringliteral">&quot;in handleLowerMsgEnd\n&quot;</span>;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">// We need to create a &quot;dummy&quot; snr list that we can pass together</span>
<a name="l00248"></a>00248     <span class="comment">// with the message to the decider module so that also the</span>
<a name="l00249"></a>00249     <span class="comment">// BasicSnrEval is able to work.</span>
<a name="l00250"></a>00250     <a class="code" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61" title="List to store SNR information for a message.">SnrList</a> snrList;
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <span class="comment">// However you can take this as a reference how to create your own</span>
<a name="l00253"></a>00253     <span class="comment">// snr entries.</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="comment">// Everytime you want to add something to the snr information list</span>
<a name="l00256"></a>00256     <span class="comment">// it has to look like this:</span>
<a name="l00257"></a>00257     <span class="comment">// 1. create a list entry and fill the fields</span>
<a name="l00258"></a>00258     <a class="code" href="struct_snr_list_entry.html" title="struct for SNR information">SnrListEntry</a> listEntry;
<a name="l00259"></a>00259     listEntry.<a class="code" href="struct_snr_list_entry.html#a0a91ab67cfd340b315a7badf6da14ce8" title="timestamp for this SNR value">time</a> = simTime();
<a name="l00260"></a>00260     listEntry.<a class="code" href="struct_snr_list_entry.html#a9126b6070ee24b0a586a267de6ebc94b" title="the SNR value">snr</a> = 3;          <span class="comment">//just a senseless example</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="comment">// 2. add an entry to the SnrList</span>
<a name="l00263"></a>00263     snrList.push_back(listEntry);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="comment">// 3. pass the message together with the list to the decider</span>
<a name="l00266"></a>00266     <a class="code" href="class_basic_snr_eval.html#a94a474e2deb6ce756900b1b64ba779df" title="Sends a message to the upper layer.">sendUp</a>(frame, snrList);
<a name="l00267"></a>00267 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a58f6bd32dd024e3bf3bdeb84126f3bb9"></a><!-- doxytag: member="BasicSnrEval::handleLowerMsgStart" ref="a58f6bd32dd024e3bf3bdeb84126f3bb9" args="(AirFrame *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::handleLowerMsgStart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>frame</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate Snr Information before buffering. </p>
<p>Redefine this function if you want to process messages from the channel before they are forwarded to upper layers</p>
<p>This function is called right after a message is received, i.e. right before it is buffered for 'transmission time'.</p>
<p>Here you should decide whether the message is "really" received or whether it's receive power is so low that it is just treated as noise.</p>
<p>If the energy of the message is high enough to really receive it you should create an snr list (<a class="el" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61">SnrList</a>) to be able to store sn(i)r information for that message. Every time a new message arrives you can add a new snr value together with a timestamp to that list. Make sure to store a pointer to the mesage together with the snr information to be able to retrieve it later.</p>
<p>In this function also an initial SNR value can be calculated for this message.</p>
<p>Please take a look at <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> to see a "real" example.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61" title="List to store SNR information for a message.">SnrList</a>, <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> </dd></dl>

<p>Reimplemented in <a class="el" href="class_gilbert_elliot_snr.html#a7e5d2fb286b5a2a78834a6d5a7ccd392">GilbertElliotSnr</a>, and <a class="el" href="class_snr_eval.html#aa4128b029feeaa5427ad6522fabce2eb">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00294">294</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00295"></a>00295 {
<a name="l00296"></a>00296     <a class="code" href="_basic_module_8cc.html#a27f667d27591f62ecf86a99a79ea8f42">coreEV</a> &lt;&lt; <span class="stringliteral">&quot;in handleLowerMsgStart, receiving frame &quot;</span> &lt;&lt; frame-&gt;getName() &lt;&lt; endl;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     <span class="comment">//calculate the receive power</span>
<a name="l00299"></a>00299 
<a name="l00300"></a>00300     <span class="comment">// calculate snr information, like snr=pSend/noise or whatever....</span>
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="comment">// if receive power is actually high enough to be able to read the</span>
<a name="l00303"></a>00303     <span class="comment">// message and no other message is currently being received, store</span>
<a name="l00304"></a>00304     <span class="comment">// the snr information for the message someweher where you can find</span>
<a name="l00305"></a>00305     <span class="comment">// it in handleLowerMsgEnd</span>
<a name="l00306"></a>00306 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a63f8fd5fab971fe18a609c1053624dc1"></a><!-- doxytag: member="BasicSnrEval::handleMessage" ref="a63f8fd5fab971fe18a609c1053624dc1" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called every time a message arrives. </p>
<p>The basic handle message function.</p>
<p>Depending on the gate a message arrives handleMessage just calls different handle*Msg functions to further process the message.</p>
<p>Messages from the channel are also buffered here in order to simulate a transmission delay</p>
<p>You should not make any changes in this function but implement all your functionality into the handle*Msg functions called from here.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_basic_snr_eval.html#a2eec34538f64365af3d19825140dacb8" title="Fill the header fields, redefine for your own needs...">handleUpperMsg</a>, <a class="el" href="class_basic_snr_eval.html#a58f6bd32dd024e3bf3bdeb84126f3bb9" title="Calculate Snr Information before buffering.">handleLowerMsgStart</a>, <a class="el" href="class_basic_snr_eval.html#aacd0c25177016c20be7e0b6090a7f191" title="Calculate SnrInfo after buffering and add the PhySnrList to the message.">handleLowerMsgEnd</a>, <a class="el" href="class_basic_snr_eval.html#a6056d3736b5f4440aa95067f1e03386c" title="Handle self messages such as timer...">handleSelfMsg</a> </dd></dl>

<p>Reimplemented in <a class="el" href="class_snr_eval.html#adbb4ecfc99b5b37ce10ca8f4db1ca495">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">79</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keywordflow">if</span> (msg-&gt;getArrivalGateId() == <a class="code" href="class_basic_snr_eval.html#a973b2265e5854d65b9ed5e8631b16aa3">uppergateIn</a>)
<a name="l00082"></a>00082     {
<a name="l00083"></a>00083         <a class="code" href="class_air_frame.html">AirFrame</a> *frame = <a class="code" href="class_basic_snr_eval.html#ad8268ab8f023e50ca32dca40356fa933" title="Encapsulates a MAC frame into an Air Frame.">encapsMsg</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
<a name="l00084"></a>00084         <a class="code" href="class_basic_snr_eval.html#a2eec34538f64365af3d19825140dacb8" title="Fill the header fields, redefine for your own needs...">handleUpperMsg</a>(frame);
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
<a name="l00087"></a>00087     {
<a name="l00088"></a>00088         <span class="keywordflow">if</span> (dynamic_cast&lt;TransmComplete *&gt;(msg) != 0)
<a name="l00089"></a>00089         {
<a name="l00090"></a>00090             <a class="code" href="_basic_module_8cc.html#a27f667d27591f62ecf86a99a79ea8f42">coreEV</a> &lt;&lt; <span class="stringliteral">&quot;frame is completely received now\n&quot;</span>;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092             <span class="comment">// unbuffer the message</span>
<a name="l00093"></a>00093             <a class="code" href="class_air_frame.html">AirFrame</a> *frame = <a class="code" href="class_basic_snr_eval.html#a2319ad5b97819e6a106980dd3cf67cf3" title="Unbuffers a message after &amp;#39;transmission time&amp;#39;.">unbufferMsg</a>(msg);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095             <a class="code" href="class_basic_snr_eval.html#aacd0c25177016c20be7e0b6090a7f191" title="Calculate SnrInfo after buffering and add the PhySnrList to the message.">handleLowerMsgEnd</a>(frame);
<a name="l00096"></a>00096         }
<a name="l00097"></a>00097         <span class="keywordflow">else</span>
<a name="l00098"></a>00098             <a class="code" href="class_basic_snr_eval.html#a6056d3736b5f4440aa95067f1e03386c" title="Handle self messages such as timer...">handleSelfMsg</a>(msg);
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (check_and_cast&lt;AirFrame *&gt;(msg)-&gt;<a class="code" href="class_basic_snr_eval.html#a1865474b5fc30b052459a3cb2b9d35fa" title="Returns the channel we&amp;#39;re listening on. This version always returns 0 (single...">getChannelNumber</a>() == <a class="code" href="class_basic_snr_eval.html#a1865474b5fc30b052459a3cb2b9d35fa" title="Returns the channel we&amp;#39;re listening on. This version always returns 0 (single...">getChannelNumber</a>())
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102         <span class="comment">// must be an AirFrame</span>
<a name="l00103"></a>00103         <a class="code" href="class_air_frame.html">AirFrame</a> *frame = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg;
<a name="l00104"></a>00104         <a class="code" href="class_basic_snr_eval.html#a58f6bd32dd024e3bf3bdeb84126f3bb9" title="Calculate Snr Information before buffering.">handleLowerMsgStart</a>(frame);
<a name="l00105"></a>00105         <a class="code" href="class_basic_snr_eval.html#a2b3c76b94adf5ef26526d4ac0c8db686" title="Buffers message for &amp;#39;transmission time&amp;#39;.">bufferMsg</a>(frame);
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     <span class="keywordflow">else</span>
<a name="l00108"></a>00108     {
<a name="l00109"></a>00109         <a class="code" href="_basic_module_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;listening to different channel when receiving message -- dropping it\n&quot;</span>;
<a name="l00110"></a>00110         <span class="keyword">delete</span> msg;
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6056d3736b5f4440aa95067f1e03386c"></a><!-- doxytag: member="BasicSnrEval::handleSelfMsg" ref="a6056d3736b5f4440aa95067f1e03386c" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BasicSnrEval::handleSelfMsg </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle self messages such as timer... </p>
<p>Define this function if you want to process timer or other kinds of self messages </p>

<p>Reimplemented in <a class="el" href="class_gilbert_elliot_snr.html#a16deedca42913461c667c319487eb4a4">GilbertElliotSnr</a>, and <a class="el" href="class_snr_eval.html#ad2d58ffa8f07856cfb6b6a7afc788e51">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00097">97</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00097"></a>00097 {<span class="keyword">delete</span> msg;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2eec34538f64365af3d19825140dacb8"></a><!-- doxytag: member="BasicSnrEval::handleUpperMsg" ref="a2eec34538f64365af3d19825140dacb8" args="(AirFrame *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::handleUpperMsg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>frame</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fill the header fields, redefine for your own needs... </p>
<p>Redefine this function if you want to process messages from upper layers before they are send to the channel.</p>
<p>The MAC frame is already encapsulated in an <a class="el" href="class_air_frame.html">AirFrame</a> and all standard header fields are set.</p>
<p>To forward the message to lower layers after processing it please use <a class="el" href="class_basic_snr_eval.html#ab24fce7973732d213aa991c89de1cf97">sendDown</a>. It will take care of decapsulation and anything else needed </p>

<p>Reimplemented in <a class="el" href="class_snr_eval.html#aa001956884b5729fd1d6fabb3013d8ec">SnrEval</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00221">221</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00222"></a>00222 {
<a name="l00223"></a>00223     <a class="code" href="class_basic_snr_eval.html#ab24fce7973732d213aa991c89de1cf97" title="Sends a message to the channel.">sendDown</a>(frame);
<a name="l00224"></a>00224 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a89445ede6f19960b30f74d17335ee30f"></a><!-- doxytag: member="BasicSnrEval::initialize" ref="a89445ede6f19960b30f74d17335ee30f" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::initialize </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialization of the module and some variables. </p>
<p>First we have to initialize the module from which we derived ours, in this case <a class="el" href="class_channel_access.html" title="Basic class for all physical layers, please don&#39;t touch!!">ChannelAccess</a>.</p>
<p>Then we have to intialize the gates and - if necessary - some own variables.</p>
<p>If you want to use your own AirFrames you have to redefine createCapsulePkt function. </p>

<p>Reimplemented from <a class="el" href="class_channel_access.html#af4c4d6652f6e3d4846cb3d2e826f4bed">ChannelAccess</a>.</p>

<p>Reimplemented in <a class="el" href="class_gilbert_elliot_snr.html#a0886205c3ab74194fb14ccd7495498df">GilbertElliotSnr</a>, <a class="el" href="class_snr_eval.html#a10f81696b873c5acf9b65f04592c9918">SnrEval</a>, and <a class="el" href="class_snr_eval80211.html#a0ebbde9edf4489102ea539ba04c13a3e">SnrEval80211</a>.</p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">40</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00041"></a>00041 {
<a name="l00042"></a>00042     <a class="code" href="class_basic_snr_eval.html#a89445ede6f19960b30f74d17335ee30f" title="Initialization of the module and some variables.">ChannelAccess::initialize</a>(stage);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044     <a class="code" href="_basic_module_8cc.html#a27f667d27591f62ecf86a99a79ea8f42">coreEV</a> &lt;&lt; <span class="stringliteral">&quot;Initializing BasicSnrEval, stage=&quot;</span> &lt;&lt; stage &lt;&lt; endl;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046     <span class="keywordflow">if</span> (stage == 0)
<a name="l00047"></a>00047     {
<a name="l00048"></a>00048         gate(<span class="stringliteral">&quot;radioIn&quot;</span>)-&gt;setDeliverOnReceptionStart(<span class="keyword">true</span>);
<a name="l00049"></a>00049 
<a name="l00050"></a>00050         <a class="code" href="class_basic_snr_eval.html#a973b2265e5854d65b9ed5e8631b16aa3">uppergateIn</a> = findGate(<span class="stringliteral">&quot;uppergateIn&quot;</span>);
<a name="l00051"></a>00051         <a class="code" href="class_basic_snr_eval.html#a8651e49c751d8e8c488eadf25eba2047" title="gate id">uppergateOut</a> = findGate(<span class="stringliteral">&quot;uppergateOut&quot;</span>);
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <a class="code" href="class_basic_snr_eval.html#a25d3734b058a75c1a42b637db4b65902" title="a parameter that has to be read in from omnetpp.ini">headerLength</a> = par(<span class="stringliteral">&quot;headerLength&quot;</span>);
<a name="l00054"></a>00054         <a class="code" href="class_basic_snr_eval.html#a515b273855ffc377f579922d5eb68dfb" title="a parameter that has to be read in from omnetpp.ini">bitrate</a> = par(<span class="stringliteral">&quot;bitrate&quot;</span>);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056         <a class="code" href="class_basic_snr_eval.html#adb9a71c73bd1cb87cc91a4708ecc289f" title="power used to transmit messages">transmitterPower</a> = par(<span class="stringliteral">&quot;transmitterPower&quot;</span>);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058         <span class="comment">// transmitter power CANNOT be greater than in ChannelControl</span>
<a name="l00059"></a>00059         <span class="keywordflow">if</span> (<a class="code" href="class_basic_snr_eval.html#adb9a71c73bd1cb87cc91a4708ecc289f" title="power used to transmit messages">transmitterPower</a> &gt; (<span class="keywordtype">double</span>) (<a class="code" href="class_channel_access.html#a0f42b731ff69be4b1193929356e75aff" title="Pointer to the ChannelControl module.">cc</a>-&gt;par(<span class="stringliteral">&quot;pMax&quot;</span>)))
<a name="l00060"></a>00060             error(<span class="stringliteral">&quot;transmitterPower cannot be bigger than pMax in ChannelControl!&quot;</span>);
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab24fce7973732d213aa991c89de1cf97"></a><!-- doxytag: member="BasicSnrEval::sendDown" ref="ab24fce7973732d213aa991c89de1cf97" args="(AirFrame *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::sendDown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a message to the channel. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_channel_access.html#a562995b3d9c5b279ed8a55c5221dd7b7" title="Sends a message to all hosts in range.">sendToChannel</a> </dd></dl>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00192">192</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval_8cc_source.html#l00124">SnrEval::handleUpperMsg()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00221">handleUpperMsg()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00193"></a>00193 {
<a name="l00194"></a>00194     <a class="code" href="class_channel_access.html#a562995b3d9c5b279ed8a55c5221dd7b7" title="Sends a message to all hosts in range.">sendToChannel</a>(msg);
<a name="l00195"></a>00195 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a94a474e2deb6ce756900b1b64ba779df"></a><!-- doxytag: member="BasicSnrEval::sendUp" ref="a94a474e2deb6ce756900b1b64ba779df" args="(AirFrame *, SnrList &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSnrEval::sendUp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_snr_list_8h.html#a241b5e7c9575e932988a55f7a5012a61">SnrList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a message to the upper layer. </p>
<p>Attach control info to the message and send message to the upper layer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td><a class="el" href="class_air_frame.html">AirFrame</a> to pass to the decider </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>list</em>&nbsp;</td><td>Snr list to attach as control info</td></tr>
  </table>
  </dd>
</dl>
<p>to be called within <a class="el" href="class_basic_snr_eval.html#aacd0c25177016c20be7e0b6090a7f191">handleLowerMsgEnd</a>. </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00175">175</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval_8cc_source.html#l00348">SnrEval::handleLowerMsgEnd()</a>, <a class="el" href="_gilbert_elliot_snr_8cc_source.html#l00215">GilbertElliotSnr::handleLowerMsgEnd()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00243">handleLowerMsgEnd()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00176"></a>00176 {
<a name="l00177"></a>00177     <span class="comment">// create ControlInfo</span>
<a name="l00178"></a>00178     <a class="code" href="class_snr_control_info.html">SnrControlInfo</a> *cInfo = <span class="keyword">new</span> <a class="code" href="class_snr_control_info.html">SnrControlInfo</a>;
<a name="l00179"></a>00179     <span class="comment">// attach the list to cInfo</span>
<a name="l00180"></a>00180     cInfo-&gt;<a class="code" href="class_snr_control_info.html#a46cc51831daf0c0dd82aee7263f3e62b">setSnrList</a>(list);
<a name="l00181"></a>00181     <span class="comment">// attach the cInfo to the AirFrame</span>
<a name="l00182"></a>00182     msg-&gt;setControlInfo(cInfo);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     send(msg, <a class="code" href="class_basic_snr_eval.html#a8651e49c751d8e8c488eadf25eba2047" title="gate id">uppergateOut</a>);
<a name="l00185"></a>00185 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2319ad5b97819e6a106980dd3cf67cf3"></a><!-- doxytag: member="BasicSnrEval::unbufferMsg" ref="a2319ad5b97819e6a106980dd3cf67cf3" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_air_frame.html">AirFrame</a> * BasicSnrEval::unbufferMsg </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unbuffers a message after 'transmission time'. </p>
<p>Get the context pointer to the now completely received <a class="el" href="class_air_frame.html">AirFrame</a> and delete the self message </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8cc_source.html#l00201">201</a> of file <a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 {
<a name="l00203"></a>00203     <a class="code" href="class_air_frame.html">AirFrame</a> *frame = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg-&gt;getContextPointer();
<a name="l00204"></a>00204     <span class="comment">//delete the self message</span>
<a name="l00205"></a>00205     <span class="keyword">delete</span> msg;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="keywordflow">return</span> frame;
<a name="l00208"></a>00208 }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a515b273855ffc377f579922d5eb68dfb"></a><!-- doxytag: member="BasicSnrEval::bitrate" ref="a515b273855ffc377f579922d5eb68dfb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_basic_snr_eval.html#a515b273855ffc377f579922d5eb68dfb">BasicSnrEval::bitrate</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>a parameter that has to be read in from omnetpp.ini </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00059">59</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval80211_8cc_source.html#l00039">SnrEval80211::calcDuration()</a>, <a class="el" href="_basic_snr_eval_8cc_source.html#l00159">calcDuration()</a>, <a class="el" href="_snr_eval80211_8cc_source.html#l00020">SnrEval80211::initialize()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a25d3734b058a75c1a42b637db4b65902"></a><!-- doxytag: member="BasicSnrEval::headerLength" ref="a25d3734b058a75c1a42b637db4b65902" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_basic_snr_eval.html#a25d3734b058a75c1a42b637db4b65902">BasicSnrEval::headerLength</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>a parameter that has to be read in from omnetpp.ini </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00062">62</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval80211_8cc_source.html#l00039">SnrEval80211::calcDuration()</a>, <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">encapsMsg()</a>, <a class="el" href="_snr_eval80211_8cc_source.html#l00020">SnrEval80211::initialize()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="adb9a71c73bd1cb87cc91a4708ecc289f"></a><!-- doxytag: member="BasicSnrEval::transmitterPower" ref="adb9a71c73bd1cb87cc91a4708ecc289f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_basic_snr_eval.html#adb9a71c73bd1cb87cc91a4708ecc289f">BasicSnrEval::transmitterPower</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>power used to transmit messages </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00065">65</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00138">encapsMsg()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a973b2265e5854d65b9ed5e8631b16aa3"></a><!-- doxytag: member="BasicSnrEval::uppergateIn" ref="a973b2265e5854d65b9ed5e8631b16aa3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_basic_snr_eval.html#a973b2265e5854d65b9ed5e8631b16aa3">BasicSnrEval::uppergateIn</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00070">70</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_snr_eval_8cc_source.html#l00100">SnrEval::handleMessage()</a>, <a class="el" href="_basic_snr_eval_8cc_source.html#l00079">handleMessage()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a8651e49c751d8e8c488eadf25eba2047"></a><!-- doxytag: member="BasicSnrEval::uppergateOut" ref="a8651e49c751d8e8c488eadf25eba2047" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_basic_snr_eval.html#a8651e49c751d8e8c488eadf25eba2047">BasicSnrEval::uppergateOut</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>gate id </p>

<p>Definition at line <a class="el" href="_basic_snr_eval_8h_source.html#l00069">69</a> of file <a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a>.</p>

<p>Referenced by <a class="el" href="_basic_snr_eval_8cc_source.html#l00040">initialize()</a>, and <a class="el" href="_basic_snr_eval_8cc_source.html#l00175">sendUp()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_basic_snr_eval_8h_source.html">BasicSnrEval.h</a></li>
<li><a class="el" href="_basic_snr_eval_8cc_source.html">BasicSnrEval.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:32 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
