<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: SCTPSocket.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_34a6fbd47227bd78d46d19b24c6937db.html">transport</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_bdf562644f4b8f6b6efc4d8dd6de82e7.html">contract</a>
  </div>
</div>
<div class="contents">
<h1>SCTPSocket.cc</h1><a href="_s_c_t_p_socket_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// Copyright (C) 2008 Irene Ruengeler</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// This program is free software; you can redistribute it and/or</span>
<a name="l00005"></a>00005 <span class="comment">// modify it under the terms of the GNU General Public License</span>
<a name="l00006"></a>00006 <span class="comment">// as published by the Free Software Foundation; either version 2</span>
<a name="l00007"></a>00007 <span class="comment">// of the License, or (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">// This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment">// GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment">// along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00016"></a>00016 <span class="comment">//</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;omnetpp.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_socket_8h.html">SCTPSocket.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_8h.html">SCTP.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_association_8h.html">SCTPAssociation.h</a>&quot;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="class_s_c_t_p_socket.html#a1695937ed0ed6829c14c044e01399a8b">00023</a> <a class="code" href="class_s_c_t_p_socket.html#a1695937ed0ed6829c14c044e01399a8b">SCTPSocket::SCTPSocket</a>(<span class="keywordtype">bool</span> type)
<a name="l00024"></a>00024 {
<a name="l00025"></a>00025     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a>;
<a name="l00026"></a>00026     <a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a> = <a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a> = 0;
<a name="l00027"></a>00027     <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a> = NULL;
<a name="l00028"></a>00028     <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a> = NULL;
<a name="l00029"></a>00029     <a class="code" href="class_s_c_t_p_socket.html#a4d0f10de3806bea1ab7133071710e0b0">gateToSctp</a> = NULL;
<a name="l00030"></a>00030     <a class="code" href="class_s_c_t_p_socket.html#a622615d86a5fe1becb54467f047313ab">lastStream</a>=-1;
<a name="l00031"></a>00031     <a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> = type;
<a name="l00032"></a>00032     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00033"></a>00033         <a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a> = <a class="code" href="class_s_c_t_p.html#a3eddd3a5ef9f40583d51b4eac4204f5f">SCTP::getNewConnId</a>();
<a name="l00034"></a>00034     <span class="keywordflow">else</span>
<a name="l00035"></a>00035         <a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a> = 0;
<a name="l00036"></a>00036     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;sockstate=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="class_s_c_t_p_socket.html#a810f2e5ae32d9a11803d5bad333d7035">00039</a> <a class="code" href="class_s_c_t_p_socket.html#a810f2e5ae32d9a11803d5bad333d7035">SCTPSocket:: ~SCTPSocket</a>()
<a name="l00040"></a>00040 {
<a name="l00041"></a>00041     <a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>.clear();
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="class_s_c_t_p_socket.html#a9fd58e3c20a1767ed7df83b69d15e298">00044</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="class_s_c_t_p_socket.html#a9fd58e3c20a1767ed7df83b69d15e298">SCTPSocket::stateName</a>(<span class="keywordtype">int</span> state)
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00048"></a>00048     <span class="keywordflow">switch</span> (state)
<a name="l00049"></a>00049     {
<a name="l00050"></a>00050         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a>);
<a name="l00051"></a>00051         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>);
<a name="l00052"></a>00052         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>);
<a name="l00053"></a>00053         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcab65e31e5bcbbd1d12b79ddc40468b7d8">CONNECTING</a>);
<a name="l00054"></a>00054         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a>);
<a name="l00055"></a>00055         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca31eac1be271666d015d39ca69e027d30">PEER_CLOSED</a>);
<a name="l00056"></a>00056         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca4260b3ebd964ad921c422a694afcb857">LOCALLY_CLOSED</a>);
<a name="l00057"></a>00057         <a class="code" href="_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcac8f1b8d9cd311b8628b547d702de7fdb">SOCKERROR</a>);
<a name="l00058"></a>00058     }
<a name="l00059"></a>00059     <span class="keywordflow">return</span> s;
<a name="l00060"></a>00060 <span class="preprocessor">#undef CASE</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>}
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">00063</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">SCTPSocket::sendToSCTP</a>(cPacket *msg)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065     <span class="keywordflow">if</span> (!<a class="code" href="class_s_c_t_p_socket.html#a4d0f10de3806bea1ab7133071710e0b0">gateToSctp</a>)
<a name="l00066"></a>00066         opp_error(<span class="stringliteral">&quot;SCTPSocket: setOutputGate() must be invoked before socket can be used&quot;</span>);
<a name="l00067"></a>00067     check_and_cast&lt;cSimpleModule *&gt;(<a class="code" href="class_s_c_t_p_socket.html#a4d0f10de3806bea1ab7133071710e0b0">gateToSctp</a>-&gt;getOwnerModule())-&gt;<a class="code" href="class_s_c_t_p_socket.html#a237f0e66511d5f343eeec96992151e4c">send</a>(msg, <a class="code" href="class_s_c_t_p_socket.html#a4d0f10de3806bea1ab7133071710e0b0">gateToSctp</a>);
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="class_s_c_t_p_socket.html#a109050219a13edd8713995f41a8d7259">00070</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a109050219a13edd8713995f41a8d7259">SCTPSocket::bind</a>(<span class="keywordtype">int</span> lPort)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a>)
<a name="l00073"></a>00073         opp_error(<span class="stringliteral">&quot;SCTPSocket::bind(): socket already bound&quot;</span>);
<a name="l00074"></a>00074     <a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>.push_back(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>));
<a name="l00075"></a>00075     <a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a> = lPort;
<a name="l00076"></a>00076     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="class_s_c_t_p_socket.html#ad1daff3c2a621027a78e1584b37733c7">00079</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a109050219a13edd8713995f41a8d7259">SCTPSocket::bind</a>(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> lAddr, <span class="keywordtype">int</span> lPort)
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;bind address &quot;</span>&lt;&lt;lAddr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00082"></a>00082     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a>)
<a name="l00083"></a>00083         opp_error(<span class="stringliteral">&quot;SCTPSocket::bind(): socket already bound&quot;</span>);
<a name="l00084"></a>00084     <a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>.push_back(lAddr);
<a name="l00085"></a>00085     <a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a> = lPort;
<a name="l00086"></a>00086     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00087"></a>00087 }
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="class_s_c_t_p_socket.html#adbd9a22ce67e0727e74102b9bfd83c14">00089</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#adbd9a22ce67e0727e74102b9bfd83c14">SCTPSocket::addAddress</a>(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> addr)
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;add address &quot;</span>&lt;&lt;addr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00092"></a>00092     <a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>.push_back(addr);
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="class_s_c_t_p_socket.html#a9a33f1da38b12d217ee106a9eb801601">00095</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a9a33f1da38b12d217ee106a9eb801601">SCTPSocket::bindx</a>(<a class="code" href="_s_c_t_p_association_8h.html#a83ecc618606af11f87a228a6ab74049b">AddressVector</a> lAddresses, <span class="keywordtype">int</span> lPort)
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097     <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> lAddr;
<a name="l00098"></a>00098     <span class="keywordflow">for</span> (AddressVector::iterator i=lAddresses.begin(); i!=lAddresses.end(); ++i)
<a name="l00099"></a>00099     {
<a name="l00100"></a>00100         ev&lt;&lt;<span class="stringliteral">&quot;bindx: bind address &quot;</span>&lt;&lt;(*i)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00101"></a>00101         <a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>.push_back((*i));
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103     <a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a> = lPort;
<a name="l00104"></a>00104     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="class_s_c_t_p_socket.html#aaf460eed5521fb6c1a587075bec6f6b4">00107</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#aaf460eed5521fb6c1a587075bec6f6b4">SCTPSocket::listen</a>(<span class="keywordtype">bool</span> fork, uint32 requests, uint32 messagesToPush)
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>)
<a name="l00110"></a>00110         opp_error(<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>==<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a> ? <span class="stringliteral">&quot;SCTPSocket: must call bind() before listen()&quot;</span>
<a name="l00111"></a>00111                                        : <span class="stringliteral">&quot;SCTPSocket::listen(): connect() or listen() already called&quot;</span>);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;PassiveOPEN&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea4660ef9a2685b60b3aa2388461c43deb">SCTP_C_OPEN_PASSIVE</a>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a> *openCmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a>();
<a name="l00116"></a>00116     <span class="comment">//openCmd-&gt;setLocalAddr(localAddr);</span>
<a name="l00117"></a>00117     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a4d780c3d1cb376633be49015e3872767">setLocalAddresses</a>(<a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>);
<a name="l00118"></a>00118     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a5959f7d278c21b59d3a6c6615f48f15e">setLocalPort</a>(<a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a>);
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00120"></a>00120         openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00121"></a>00121     <span class="keywordflow">else</span>
<a name="l00122"></a>00122         openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p.html#a3eddd3a5ef9f40583d51b4eac4204f5f">SCTP::getNewConnId</a>());
<a name="l00123"></a>00123     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a7a1aecd5a48ff886315c255477cbefb6">setFork</a>(fork);
<a name="l00124"></a>00124    openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#ad7976e71404ea87830a351649e9b119a">setInboundStreams</a>(<a class="code" href="class_s_c_t_p_socket.html#a8a5eca34480958488a093a48ed96dac1">inboundStreams</a>);
<a name="l00125"></a>00125     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a1709e599ba4e9fa321865e6f4ae941d5">setOutboundStreams</a>(<a class="code" href="class_s_c_t_p_socket.html#a72097418bb2b141c3aae69a8303dd129">outboundStreams</a>);
<a name="l00126"></a>00126     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a8bfb58359ad6d1da96a8dbe56895993d">setNumRequests</a>(requests);
<a name="l00127"></a>00127     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a38e0c543f6b04e51fd385373ad66abf8">setMessagesToPush</a>(messagesToPush);
<a name="l00128"></a>00128     msg-&gt;setControlInfo(openCmd);
<a name="l00129"></a>00129     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Assoc &quot;</span>&lt;&lt;openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>()&lt;&lt;<span class="stringliteral">&quot;::send PassiveOPEN to SCTP from socket:listen \n&quot;</span>;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00132"></a>00132     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>;
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="class_s_c_t_p_socket.html#aec3241da9f007e4a3d1211c314f7dcc5">00135</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#aec3241da9f007e4a3d1211c314f7dcc5">SCTPSocket::connect</a>(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> remoteAddress, int32 remotePort, uint32 numRequests)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Socket connect. Assoc=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>&lt;&lt;<span class="stringliteral">&quot;, sockstate=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00138"></a>00138     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>)
<a name="l00139"></a>00139         opp_error( <span class="stringliteral">&quot;SCTPSocket::connect(): connect() or listen() already called&quot;</span>);
<a name="l00140"></a>00140     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>)
<a name="l00141"></a>00141         opp_error( <span class="stringliteral">&quot;SCTPSocket::connect: One-to-many style socket must be listening&quot;</span>);
<a name="l00142"></a>00142     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Associate&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea408002f9592dcab6ceb60f683bee7e83">SCTP_C_ASSOCIATE</a>);
<a name="l00143"></a>00143     <a class="code" href="class_s_c_t_p_socket.html#a67eaf48604f87ed0e872b03a0a583778">remoteAddr</a> = remoteAddress;
<a name="l00144"></a>00144     <a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a> = remotePort;
<a name="l00145"></a>00145     <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a> *openCmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a>();
<a name="l00146"></a>00146     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00147"></a>00147         openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00148"></a>00148     <span class="keywordflow">else</span>
<a name="l00149"></a>00149         openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p.html#a3eddd3a5ef9f40583d51b4eac4204f5f">SCTP::getNewConnId</a>());
<a name="l00150"></a>00150     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Socket connect. Assoc=&quot;</span>&lt;&lt;openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff1456151f23aa69419b271f5b93164b">getAssocId</a>()&lt;&lt;<span class="stringliteral">&quot;, sockstate=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_socket.html#a9fd58e3c20a1767ed7df83b69d15e298">stateName</a>(sockstate)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00151"></a>00151     <span class="comment">//openCmd-&gt;setAssocId(assocId);</span>
<a name="l00152"></a>00152     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a4d780c3d1cb376633be49015e3872767">setLocalAddresses</a>(<a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>);
<a name="l00153"></a>00153     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a5959f7d278c21b59d3a6c6615f48f15e">setLocalPort</a>(<a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a>);
<a name="l00154"></a>00154     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a7d2a408830ba7f503415e756547341a6">setRemoteAddr</a>(<a class="code" href="class_s_c_t_p_socket.html#a67eaf48604f87ed0e872b03a0a583778">remoteAddr</a>);
<a name="l00155"></a>00155     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#ae507ed266642f53b294367e74ab2f77c">setRemotePort</a>(<a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a>);
<a name="l00156"></a>00156     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a1709e599ba4e9fa321865e6f4ae941d5">setOutboundStreams</a>(<a class="code" href="class_s_c_t_p_socket.html#a72097418bb2b141c3aae69a8303dd129">outboundStreams</a>);
<a name="l00157"></a>00157    openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a1709e599ba4e9fa321865e6f4ae941d5">setOutboundStreams</a>(<a class="code" href="class_s_c_t_p_socket.html#a8a5eca34480958488a093a48ed96dac1">inboundStreams</a>);
<a name="l00158"></a>00158     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a8bfb58359ad6d1da96a8dbe56895993d">setNumRequests</a>(numRequests);
<a name="l00159"></a>00159     msg-&gt;setControlInfo(openCmd);
<a name="l00160"></a>00160     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00162"></a>00162         sockstate = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcab65e31e5bcbbd1d12b79ddc40468b7d8">CONNECTING</a>;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="class_s_c_t_p_socket.html#a2e28b1324ddf84d878c96f4448d188cb">00166</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a2e28b1324ddf84d878c96f4448d188cb">SCTPSocket::connectx</a>(<a class="code" href="_s_c_t_p_association_8h.html#a83ecc618606af11f87a228a6ab74049b">AddressVector</a> remoteAddressList, int32 remotePort, uint32 numRequests)
<a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Socket connectx.  sockstate=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00169"></a>00169     <span class="comment">/*if (sockstate!=NOT_BOUND &amp;&amp; sockstate!=CLOSED)</span>
<a name="l00170"></a>00170 <span class="comment">        opp_error( &quot;SCTPSocket::connect(): connect() or listen() already called&quot;);*/</span>
<a name="l00171"></a>00171     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>)
<a name="l00172"></a>00172         opp_error( <span class="stringliteral">&quot;SCTPSocket::connect(): connect() or listen() already called&quot;</span>);
<a name="l00173"></a>00173     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; sockstate!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>)
<a name="l00174"></a>00174         opp_error( <span class="stringliteral">&quot;SCTPSocket::connect: One-to-many style socket must be listening&quot;</span>);
<a name="l00175"></a>00175     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Associate&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea408002f9592dcab6ceb60f683bee7e83">SCTP_C_ASSOCIATE</a>);
<a name="l00176"></a>00176     <a class="code" href="class_s_c_t_p_socket.html#ad7950eb104a3806f0baecaf4de1044f3">remoteAddresses</a> = remoteAddressList;
<a name="l00177"></a>00177     <a class="code" href="class_s_c_t_p_socket.html#a67eaf48604f87ed0e872b03a0a583778">remoteAddr</a> = <a class="code" href="class_s_c_t_p_socket.html#ad7950eb104a3806f0baecaf4de1044f3">remoteAddresses</a>.front();
<a name="l00178"></a>00178     <a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a> = remotePort;
<a name="l00179"></a>00179     <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a> *openCmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_open_command.html">SCTPOpenCommand</a>();
<a name="l00180"></a>00180     openCmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00181"></a>00181     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a4d780c3d1cb376633be49015e3872767">setLocalAddresses</a>(<a class="code" href="class_s_c_t_p_socket.html#a20ba70e9638a2a6ef0692e19a8c5f420">localAddresses</a>);
<a name="l00182"></a>00182     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a5959f7d278c21b59d3a6c6615f48f15e">setLocalPort</a>(<a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a>);
<a name="l00183"></a>00183     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a7d2a408830ba7f503415e756547341a6">setRemoteAddr</a>(<a class="code" href="class_s_c_t_p_socket.html#a67eaf48604f87ed0e872b03a0a583778">remoteAddr</a>);
<a name="l00184"></a>00184     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a1ff0e133761317f7848fe97595eb10ae">setRemoteAddresses</a>(<a class="code" href="class_s_c_t_p_socket.html#ad7950eb104a3806f0baecaf4de1044f3">remoteAddresses</a>);
<a name="l00185"></a>00185     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#ae507ed266642f53b294367e74ab2f77c">setRemotePort</a>(<a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a>);
<a name="l00186"></a>00186     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a1709e599ba4e9fa321865e6f4ae941d5">setOutboundStreams</a>(<a class="code" href="class_s_c_t_p_socket.html#a72097418bb2b141c3aae69a8303dd129">outboundStreams</a>);
<a name="l00187"></a>00187     openCmd-&gt;<a class="code" href="class_s_c_t_p_open_command.html#a8bfb58359ad6d1da96a8dbe56895993d">setNumRequests</a>(numRequests);
<a name="l00188"></a>00188     msg-&gt;setControlInfo(openCmd);
<a name="l00189"></a>00189     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00190"></a>00190     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00191"></a>00191         sockstate = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcab65e31e5bcbbd1d12b79ddc40468b7d8">CONNECTING</a>;
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a><a class="code" href="class_s_c_t_p_socket.html#a237f0e66511d5f343eeec96992151e4c">00194</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a237f0e66511d5f343eeec96992151e4c">SCTPSocket::send</a>(cPacket *msg, <span class="keywordtype">bool</span> last, <span class="keywordtype">bool</span> primary)
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcab65e31e5bcbbd1d12b79ddc40468b7d8">CONNECTING</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca31eac1be271666d015d39ca69e027d30">PEER_CLOSED</a>) {
<a name="l00197"></a>00197         opp_error(<span class="stringliteral">&quot;SCTPSocket::send(): not connected or connecting&quot;</span>);
<a name="l00198"></a>00198    }
<a name="l00199"></a>00199     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>) {
<a name="l00200"></a>00200         opp_error( <span class="stringliteral">&quot;SCTPSocket::send: One-to-many style socket must be listening&quot;</span>);
<a name="l00201"></a>00201    }
<a name="l00202"></a>00202     <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_send_command.html">SCTPSendCommand</a>();
<a name="l00203"></a>00203     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00204"></a>00204     <span class="keywordflow">if</span> (msg-&gt;getKind() == <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea6b3b36984ab51a0714609ca913bbb54f">SCTP_C_SEND_ORDERED</a>)
<a name="l00205"></a>00205         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff4b63211a335d3580c32293a0cc72eb">setSendUnordered</a>(<a class="code" href="_s_c_t_p_association_8h.html#a6f5cc3c80258127f32f9afd435791f1fa58b47731ff085e85a7462873e1284441">COMPLETE_MESG_ORDERED</a>);
<a name="l00206"></a>00206     <span class="keywordflow">else</span>
<a name="l00207"></a>00207         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aff4b63211a335d3580c32293a0cc72eb">setSendUnordered</a>(<a class="code" href="_s_c_t_p_association_8h.html#a6f5cc3c80258127f32f9afd435791f1fa624a2bc1f97816d9d48c796f8ddab573">COMPLETE_MESG_UNORDERED</a>);
<a name="l00208"></a>00208     <a class="code" href="class_s_c_t_p_socket.html#a622615d86a5fe1becb54467f047313ab">lastStream</a>=(<a class="code" href="class_s_c_t_p_socket.html#a622615d86a5fe1becb54467f047313ab">lastStream</a>+1)%<a class="code" href="class_s_c_t_p_socket.html#a72097418bb2b141c3aae69a8303dd129">outboundStreams</a>;
<a name="l00209"></a>00209     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a5e425cdf9ecc6360e1dcea80b055162d">setSid</a>(<a class="code" href="class_s_c_t_p_socket.html#a622615d86a5fe1becb54467f047313ab">lastStream</a>);
<a name="l00210"></a>00210     cmd-&gt;<a class="code" href="class_s_c_t_p_send_command.html#a014dfdf2b2d35254c0aa2e2e79bef280">setLast</a>(last);
<a name="l00211"></a>00211     cmd-&gt;<a class="code" href="class_s_c_t_p_send_command.html#ac7392222726e79fb6953d025b97a32be">setPrimary</a>(primary);
<a name="l00212"></a>00212     msg-&gt;setKind(<a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eacb34da0d2a8bc9071c353d5e92ab0d94">SCTP_C_SEND</a>);
<a name="l00213"></a>00213     msg-&gt;setControlInfo(cmd);
<a name="l00214"></a>00214     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="class_s_c_t_p_socket.html#a0e9188a10b1914bd97adf2857636129f">00218</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a0e9188a10b1914bd97adf2857636129f">SCTPSocket::sendNotification</a>(cPacket *msg)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcab65e31e5bcbbd1d12b79ddc40468b7d8">CONNECTING</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca31eac1be271666d015d39ca69e027d30">PEER_CLOSED</a>) {
<a name="l00221"></a>00221         opp_error(<span class="stringliteral">&quot;SCTPSocket::sendNotification(%s): not connected or connecting&quot;</span>, msg-&gt;getName());
<a name="l00222"></a>00222    }
<a name="l00223"></a>00223     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcaaebb3b34c5fbf93f42cee1c75b5b16d4">LISTENING</a>) {
<a name="l00224"></a>00224         opp_error( <span class="stringliteral">&quot;SCTPSocket::send: One-to-many style socket must be listening&quot;</span>);
<a name="l00225"></a>00225    }
<a name="l00226"></a>00226     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="class_s_c_t_p_socket.html#a8f4c0c8dc30620cd20f5b0e2262f6492">00229</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a8f4c0c8dc30620cd20f5b0e2262f6492">SCTPSocket::sendRequest</a>(cPacket *msg)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="class_s_c_t_p_socket.html#a59fadc92af0cfc43d505d98cef374c73">00234</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a59fadc92af0cfc43d505d98cef374c73">SCTPSocket::close</a>()
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTPSocket: close\n&quot;</span>;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;CLOSE&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea36c1bad836563c7468a9877491b1db5d">SCTP_C_CLOSE</a>);
<a name="l00239"></a>00239     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>();
<a name="l00240"></a>00240     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00241"></a>00241     msg-&gt;setControlInfo(cmd);
<a name="l00242"></a>00242     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00243"></a>00243     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>==<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a> ? <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca4260b3ebd964ad921c422a694afcb857">LOCALLY_CLOSED</a> : <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="class_s_c_t_p_socket.html#a96a44bf84aadf72bd6b6ea929ad597d3">00246</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a96a44bf84aadf72bd6b6ea929ad597d3">SCTPSocket::shutdown</a>()
<a name="l00247"></a>00247 {
<a name="l00248"></a>00248     ev&lt;&lt;<span class="stringliteral">&quot;SCTPSocket: shutdown\n&quot;</span>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;Shutdown&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea349e117c148f5b223ecef4d8334b7077">SCTP_C_SHUTDOWN</a>);
<a name="l00251"></a>00251     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>();
<a name="l00252"></a>00252     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00253"></a>00253     msg-&gt;setControlInfo(cmd);
<a name="l00254"></a>00254     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="class_s_c_t_p_socket.html#a4db6465b68c53543eec91d07d52f05f4">00257</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a4db6465b68c53543eec91d07d52f05f4">SCTPSocket::abort</a>()
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcae2a12430f83d2cb6f2f386440b8c7dec">NOT_BOUND</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a> &amp;&amp; <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>!=<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcac8f1b8d9cd311b8628b547d702de7fdb">SOCKERROR</a>)
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261         cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;ABORT&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463ea7d45ef3a5ccaa811a5edd77a342bc3b0">SCTP_C_ABORT</a>);
<a name="l00262"></a>00262         <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>();
<a name="l00263"></a>00263         <span class="comment">//sctpEV3&lt;&lt;&quot;Message cmd=&quot;&lt;&lt;&amp;cmd&lt;&lt;&quot;\n&quot;;</span>
<a name="l00264"></a>00264         cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00265"></a>00265         msg-&gt;setControlInfo(cmd);
<a name="l00266"></a>00266         <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268     <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00271"></a><a class="code" href="class_s_c_t_p_socket.html#a5ae03a4b87d274415fac26d8e12d667e">00271</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a5ae03a4b87d274415fac26d8e12d667e">SCTPSocket::requestStatus</a>()
<a name="l00272"></a>00272 {
<a name="l00273"></a>00273     cPacket *msg = <span class="keyword">new</span> cPacket(<span class="stringliteral">&quot;STATUS&quot;</span>, <a class="code" href="_s_c_t_p_command_8h.html#a5ec9c6f1ed5e1ef36d79227bcb81463eae6535b42c094a1812adfc19d4b59d69b">SCTP_C_STATUS</a>);
<a name="l00274"></a>00274     <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a>();
<a name="l00275"></a>00275     cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#aba989bb5fd07d31faf68d42bd90cbd02">setAssocId</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00276"></a>00276     msg-&gt;setControlInfo(cmd);
<a name="l00277"></a>00277     <a class="code" href="class_s_c_t_p_socket.html#a8c57769cb0508925dafdfede4a4ada87">sendToSCTP</a>(msg);
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="class_s_c_t_p_socket.html#aaa2948569cd6f1aac0d8cd5102680356">00280</a> <span class="keywordtype">bool</span> <a class="code" href="class_s_c_t_p_socket.html#aaa2948569cd6f1aac0d8cd5102680356">SCTPSocket::belongsToSocket</a>(cPacket *msg)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282     <span class="keywordtype">bool</span> ret= <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *<span class="keyword">&gt;</span>(msg-&gt;getControlInfo()) &amp;&amp;
<a name="l00283"></a>00283            ((<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *)(msg-&gt;getControlInfo()))-&gt;getAssocId()==<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>;
<a name="l00284"></a>00284     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;assoc=&quot;</span>&lt;&lt;((<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *)(msg-&gt;getControlInfo()))-&gt;getAssocId()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00285"></a>00285     <span class="keywordflow">return</span> ret;
<a name="l00286"></a>00286 }
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="class_s_c_t_p_socket.html#add4455efbfe52732e9dd44178a8c8cde">00288</a> <span class="keywordtype">bool</span> <a class="code" href="class_s_c_t_p_socket.html#add4455efbfe52732e9dd44178a8c8cde">SCTPSocket::belongsToAnySCTPSocket</a>(cPacket *msg)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290     <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *<span class="keyword">&gt;</span>(msg-&gt;getControlInfo());
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="class_s_c_t_p_socket.html#a4d550ae15025b9fcf90ab085c3f52fcf">00293</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a4d550ae15025b9fcf90ab085c3f52fcf">SCTPSocket::setCallbackObject</a>(<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html">CallbackInterface</a> *callback, <span class="keywordtype">void</span> *yourPointer)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295     <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a> = callback;
<a name="l00296"></a>00296     <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a> = yourPointer;
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00299"></a><a class="code" href="class_s_c_t_p_socket.html#a5f729a9a7cdd6d43fb1089ce82d47a87">00299</a> <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_socket.html#a5f729a9a7cdd6d43fb1089ce82d47a87">SCTPSocket::processMessage</a>(cPacket *msg)
<a name="l00300"></a>00300 {
<a name="l00301"></a>00301     <a class="code" href="class_s_c_t_p_status_info.html">SCTPStatusInfo</a> *status;
<a name="l00302"></a>00302     <span class="keywordflow">switch</span> (msg-&gt;getKind())
<a name="l00303"></a>00303     {
<a name="l00304"></a>00304         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a1eb9f18f68a700c545427ba5231a9dc4">SCTP_I_DATA</a>:
<a name="l00305"></a>00305             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTP_I_DATA\n&quot;</span>;
<a name="l00306"></a>00306             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00307"></a>00307                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#a839bdd2504cabe1edc8770c1a432a7cb">socketDataArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>, msg, <span class="keyword">false</span>);
<a name="l00308"></a>00308             <span class="keywordflow">break</span>;
<a name="l00309"></a>00309         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a723241390fabc3b46cb79e9f5541b01b">SCTP_I_DATA_NOTIFICATION</a>:
<a name="l00310"></a>00310             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTP_I_NOTIFICATION\n&quot;</span>;
<a name="l00311"></a>00311             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00312"></a>00312                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#a8bc5f5c6db42d745f1aebf609cee8a49">socketDataNotificationArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>, msg);
<a name="l00313"></a>00313             <span class="keywordflow">break</span>;
<a name="l00314"></a>00314         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a781cc2063dc1656c84a04fde2991e2d2">SCTP_I_SEND_MSG</a>:
<a name="l00315"></a>00315             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00316"></a>00316                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#a1b1801c61d94671d5aae346759abad3d">sendRequestArrived</a>();
<a name="l00317"></a>00317             <span class="keywordflow">break</span>;
<a name="l00318"></a>00318         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a6b85de91f4bd3609fc7bcd7994101a3d">SCTP_I_ESTABLISHED</a>:
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00321"></a>00321                 <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a>;
<a name="l00322"></a>00322             <a class="code" href="class_s_c_t_p_connect_info.html">SCTPConnectInfo</a> *connectInfo = check_and_cast&lt;<a class="code" href="class_s_c_t_p_connect_info.html">SCTPConnectInfo</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00323"></a>00323             <a class="code" href="class_s_c_t_p_socket.html#aeca58a61f6f579981eb5a324c2ba4319">localAddr</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_command.html#aacd49caceaec4610bbaaa99a226b924f">getLocalAddr</a>();
<a name="l00324"></a>00324             <a class="code" href="class_s_c_t_p_socket.html#a67eaf48604f87ed0e872b03a0a583778">remoteAddr</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_command.html#a70de7026095cf55bb817329d0d0f2a1d">getRemoteAddr</a>();
<a name="l00325"></a>00325             <a class="code" href="class_s_c_t_p_socket.html#ab6e4f70d4c1b8e63b71ae25e1524fb8d">localPrt</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#ad7795fe67f60670397278140e5e0a1ba">getLocalPort</a>();
<a name="l00326"></a>00326             <a class="code" href="class_s_c_t_p_socket.html#a3aa1cb0c1e820568094aeccb81ac15a0">remotePrt</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#a0da8c0bf1eb965322e1d5f88f5a650ec">getRemotePort</a>();;
<a name="l00327"></a>00327             <a class="code" href="class_s_c_t_p_socket.html#abe9fe0a2deba9a7e2dc96311da75e318">fsmStatus</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#a8aab38fc857b11274c27e0e541c4025a">getStatus</a>();
<a name="l00328"></a>00328             <a class="code" href="class_s_c_t_p_socket.html#a8a5eca34480958488a093a48ed96dac1">inboundStreams</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#abb8ae2048274398bbc89734c6ae3766e">getInboundStreams</a>();
<a name="l00329"></a>00329             <a class="code" href="class_s_c_t_p_socket.html#a72097418bb2b141c3aae69a8303dd129">outboundStreams</a> = connectInfo-&gt;<a class="code" href="class_s_c_t_p_connect_info.html#af5195ae63edd8eb3ab64bead078cdf04">getOutboundStreams</a>();
<a name="l00330"></a>00330 
<a name="l00331"></a>00331             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00332"></a>00332                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#acb5da16b51586140535901da233010f8">socketEstablished</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>, connectInfo-&gt;<a class="code" href="class_s_c_t_p_command.html#a92f0f9644b4f5ec70df1dcbd0c242b7d">getNumMsgs</a>());
<a name="l00333"></a>00333             <span class="keyword">delete</span> connectInfo;
<a name="l00334"></a>00334             <span class="keywordflow">break</span>;
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3adcb0d50416fbeb73876eba7d7b8ee930">SCTP_I_PEER_CLOSED</a>:
<a name="l00337"></a>00337             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;peer closed\n&quot;</span>;
<a name="l00338"></a>00338             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a17bd453fc5bddc4802a0fecf1c7e5b6e">oneToOne</a>)
<a name="l00339"></a>00339                 <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a>==<a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca86f1eb1fba7e7144cf7bb0581c64184e">CONNECTED</a> ? <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca31eac1be271666d015d39ca69e027d30">PEER_CLOSED</a> : <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00342"></a>00342                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#abd28bec58121e3eb9ba0fc758f2b7cfb">socketPeerClosed</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>);
<a name="l00343"></a>00343             <span class="keywordflow">break</span>;
<a name="l00344"></a>00344         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a72ee49d265f6c75166038f085a52a1bf">SCTP_I_ABORT</a>:
<a name="l00345"></a>00345         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3afc5424e52a8919715c5f0433afcdd3b5">SCTP_I_CONN_LOST</a>:
<a name="l00346"></a>00346         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3ace58e516838fe8c15ac9ce67f4f4409c">SCTP_I_CLOSED</a>:
<a name="l00347"></a>00347             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTP_I_CLOSED called\n&quot;</span>;
<a name="l00348"></a>00348             <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dca576c1d7cf75c324a462dae9c4055b81f">CLOSED</a>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00351"></a>00351                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#a97a094ccbc814efe3b07cc8076906e21">socketClosed</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>);
<a name="l00352"></a>00352             <span class="keywordflow">break</span>;
<a name="l00353"></a>00353         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a16f2119f34b440b981e5f1e6386ac018">SCTP_I_CONNECTION_REFUSED</a>:
<a name="l00354"></a>00354         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3aee8733c691e3dbeea6dc2f701bcf027b">SCTP_I_CONNECTION_RESET</a>:
<a name="l00355"></a>00355         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3ab114530461e728f84d5db50dd5670620">SCTP_I_TIMED_OUT</a>:
<a name="l00356"></a>00356             <a class="code" href="class_s_c_t_p_socket.html#a5389f2a66c9e133aa319a7c2b5c85916">sockstate</a> = <a class="code" href="class_s_c_t_p_socket.html#a54995ab1377ac24941b0f043c8bc78dcac8f1b8d9cd311b8628b547d702de7fdb">SOCKERROR</a>;
<a name="l00357"></a>00357             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00358"></a>00358                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#aedcd1603b4cf4849c78108de87f3df24">socketFailure</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>, msg-&gt;getKind());
<a name="l00359"></a>00359 
<a name="l00360"></a>00360             <span class="keywordflow">break</span>;
<a name="l00361"></a>00361         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3abbf25758d570841736d12727b53ff2be">SCTP_I_STATUS</a>:
<a name="l00362"></a>00362             status = check_and_cast&lt;<a class="code" href="class_s_c_t_p_status_info.html">SCTPStatusInfo</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00363"></a>00363 
<a name="l00364"></a>00364             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00365"></a>00365                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#ad5a0fb4838a3b37cfa1263b9956b9160">socketStatusArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, <a class="code" href="class_s_c_t_p_socket.html#a110976cf91865c9bb334e7ff409ca5f1">yourPtr</a>, status);
<a name="l00366"></a>00366             <span class="keyword">delete</span> status;
<a name="l00367"></a>00367             <span class="keywordflow">break</span>;
<a name="l00368"></a>00368         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a21bb0580e0fb02c3a89d63062a14b88b">SCTP_I_SHUTDOWN_RECEIVED</a>:
<a name="l00369"></a>00369             <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTP_I_SHUTDOWN_RECEIVED\n&quot;</span>;
<a name="l00370"></a>00370         <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00371"></a>00371                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#aa0ed7f0493982b23e07556591b77db6d">shutdownReceivedArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00372"></a>00372             <span class="keywordflow">break</span>;
<a name="l00373"></a>00373         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a75904bee9e03f629a2657337857f4e52">SCTP_I_SENDQUEUE_FULL</a>:
<a name="l00374"></a>00374             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00375"></a>00375                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#a7dfb071fbe4dbbbad061fa3bca48a437">sendqueueFullArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>);
<a name="l00376"></a>00376             <span class="keywordflow">break</span>;
<a name="l00377"></a>00377         <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_command_8h.html#a066d6fbbc858ac42638c402e8ab1a5f3a4ed59ad366001ebd94844599c3ed76ec">SCTP_I_SENDQUEUE_ABATED</a>:
<a name="l00378"></a>00378         {
<a name="l00379"></a>00379             <a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *cmd = check_and_cast&lt;<a class="code" href="class_s_c_t_p_command.html">SCTPCommand</a> *&gt;(msg-&gt;removeControlInfo());
<a name="l00380"></a>00380             <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>)
<a name="l00381"></a>00381             {
<a name="l00382"></a>00382                 <a class="code" href="class_s_c_t_p_socket.html#a3be254ec4521ebf87f369bee4d140140">cb</a>-&gt;<a class="code" href="class_s_c_t_p_socket_1_1_callback_interface.html#af1ba4281e669037920f2cd96f46ac043">sendqueueAbatedArrived</a>(<a class="code" href="class_s_c_t_p_socket.html#ab49217651e5b91fb67657a4cb517803f">assocId</a>, cmd-&gt;<a class="code" href="class_s_c_t_p_command.html#a92f0f9644b4f5ec70df1dcbd0c242b7d">getNumMsgs</a>());
<a name="l00383"></a>00383             }
<a name="l00384"></a>00384             <span class="keyword">delete</span> cmd;
<a name="l00385"></a>00385             <span class="keywordflow">break</span>;
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387         <span class="keywordflow">default</span>:
<a name="l00388"></a>00388             opp_error(<span class="stringliteral">&quot;SCTPSocket: invalid msg kind %d, one of the SCTP_I_xxx constants expected&quot;</span>, msg-&gt;getKind());
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="keyword">delete</span> msg;
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:30 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
