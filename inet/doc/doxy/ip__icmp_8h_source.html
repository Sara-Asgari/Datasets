<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: ip_icmp.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1a1cc47ff911b796c3b0426b22e55889.html">util</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a76da0457022aaae9a599ef816f66f88.html">headerserializers</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_b38737cbe47a886fccfe3d09af2a3a60.html">headers</a>
  </div>
</div>
<div class="contents">
<h1>ip_icmp.h</h1><a href="ip__icmp_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 1982, 1986, 1993</span>
<a name="l00003"></a>00003 <span class="comment"> *      The Regents of the University of California.  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="l00007"></a>00007 <span class="comment"> * are met:</span>
<a name="l00008"></a>00008 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="l00009"></a>00009 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="l00010"></a>00010 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="l00011"></a>00011 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
<a name="l00012"></a>00012 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
<a name="l00013"></a>00013 <span class="comment"> * 3. All advertising materials mentioning features or use of this software</span>
<a name="l00014"></a>00014 <span class="comment"> *    must display the following acknowledgement:</span>
<a name="l00015"></a>00015 <span class="comment"> *      This product includes software developed by the University of</span>
<a name="l00016"></a>00016 <span class="comment"> *      California, Berkeley and its contributors.</span>
<a name="l00017"></a>00017 <span class="comment"> * 4. Neither the name of the University nor the names of its contributors</span>
<a name="l00018"></a>00018 <span class="comment"> *    may be used to endorse or promote products derived from this software</span>
<a name="l00019"></a>00019 <span class="comment"> *    without specific prior written permission.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS&apos;&apos; AND</span>
<a name="l00022"></a>00022 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="l00023"></a>00023 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<a name="l00024"></a>00024 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE</span>
<a name="l00025"></a>00025 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00026"></a>00026 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
<a name="l00027"></a>00027 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<a name="l00028"></a>00028 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
<a name="l00029"></a>00029 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
<a name="l00030"></a>00030 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
<a name="l00031"></a>00031 <span class="comment"> * SUCH DAMAGE.</span>
<a name="l00032"></a>00032 <span class="comment"> *</span>
<a name="l00033"></a>00033 <span class="comment"> *      @(#)ip_icmp.h   8.1 (Berkeley) 6/10/93</span>
<a name="l00034"></a>00034 <span class="comment"> * $FreeBSD: src/sys/netinet/ip_icmp.h,v 1.16 1999/12/29 04:41:01 peter Exp $</span>
<a name="l00035"></a>00035 <span class="comment"> */</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#ifndef OPPSIM_NETINET_IP_ICMP_H_</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#define OPPSIM_NETINET_IP_ICMP_H_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a>00040 <span class="comment">/*</span>
<a name="l00041"></a>00041 <span class="comment"> * Interface Control Message Protocol Definitions.</span>
<a name="l00042"></a>00042 <span class="comment"> * Per RFC 792, September 1981.</span>
<a name="l00043"></a>00043 <span class="comment"> */</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">/*</span>
<a name="l00046"></a>00046 <span class="comment"> * Internal of an ICMP Router Advertisement</span>
<a name="l00047"></a>00047 <span class="comment"> */</span>
<a name="l00048"></a><a class="code" href="structicmp__ra__addr.html">00048</a> <span class="keyword">struct </span><a class="code" href="structicmp__ra__addr.html">icmp_ra_addr</a> {
<a name="l00049"></a><a class="code" href="structicmp__ra__addr.html#a85e1565d1ad5723eff5d3dfa3322b3e5">00049</a>         <a class="code" href="bsdint_8h.html#a0d5a2542b430beb8568bacccd2c657ae">u_int32_t</a> <a class="code" href="structicmp__ra__addr.html#a85e1565d1ad5723eff5d3dfa3322b3e5">ira_addr</a>;
<a name="l00050"></a><a class="code" href="structicmp__ra__addr.html#a95585cd789388313f05af6415f169370">00050</a>         <a class="code" href="bsdint_8h.html#a0d5a2542b430beb8568bacccd2c657ae">u_int32_t</a> <a class="code" href="structicmp__ra__addr.html#a95585cd789388313f05af6415f169370">ira_preference</a>;
<a name="l00051"></a>00051 };
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="comment">/*</span>
<a name="l00054"></a>00054 <span class="comment"> * Structure of an icmp header.</span>
<a name="l00055"></a>00055 <span class="comment"> */</span>
<a name="l00056"></a><a class="code" href="structicmp.html">00056</a> <span class="keyword">struct </span><a class="code" href="structicmp.html">icmp</a> {
<a name="l00057"></a><a class="code" href="structicmp.html#aa1e03d610e2391565d96ef5ace20caf6">00057</a>         <a class="code" href="bsdint_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structicmp.html#aa1e03d610e2391565d96ef5ace20caf6">icmp_type</a>;              <span class="comment">/* type of message, see below */</span>
<a name="l00058"></a><a class="code" href="structicmp.html#a4db7a65d2113b9800928821b67494ee0">00058</a>         <a class="code" href="bsdint_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structicmp.html#a4db7a65d2113b9800928821b67494ee0">icmp_code</a>;              <span class="comment">/* type sub code */</span>
<a name="l00059"></a><a class="code" href="structicmp.html#af1087f74d787650ed3b46ea777de030f">00059</a>         <a class="code" href="bsdint_8h.html#aa1a19deefc008737e6397f44d983cfd4">u_short</a> <a class="code" href="structicmp.html#af1087f74d787650ed3b46ea777de030f">icmp_cksum</a>;             <span class="comment">/* ones complement cksum of struct */</span>
<a name="l00060"></a>00060         <span class="keyword">union </span>{
<a name="l00061"></a><a class="code" href="structicmp.html#a564e8f67d96299fbb8e8621b752a2109">00061</a>                 <a class="code" href="bsdint_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structicmp.html#a564e8f67d96299fbb8e8621b752a2109">ih_pptr</a>;                 <span class="comment">/* ICMP_PARAMPROB */</span>
<a name="l00062"></a><a class="code" href="structicmp.html#a5dae391ad9a6d91c82d4bfa65720e363">00062</a>                 <span class="keyword">struct </span><a class="code" href="structin__addr.html">in_addr</a> <a class="code" href="structicmp.html#a5dae391ad9a6d91c82d4bfa65720e363">ih_gwaddr</a>;       <span class="comment">/* ICMP_REDIRECT */</span>
<a name="l00063"></a>00063                 <span class="keyword">struct </span><a class="code" href="structicmp.html#a98c5f90fa6b536dc583f311da4ba74da">ih_idseq</a> {
<a name="l00064"></a><a class="code" href="structicmp.html#abeb640a939b9a78debc2240ba96292bf">00064</a>                         <a class="code" href="in__systm_8h.html#ab6cdc14ada3945e3a21719421f0f1c46">n_short</a> <a class="code" href="structicmp.html#abeb640a939b9a78debc2240ba96292bf">icd_id</a>;
<a name="l00065"></a><a class="code" href="structicmp.html#a5cc71b651dad1fd9cc69c042519cc308">00065</a>                         <a class="code" href="in__systm_8h.html#ab6cdc14ada3945e3a21719421f0f1c46">n_short</a> <a class="code" href="structicmp.html#a5cc71b651dad1fd9cc69c042519cc308">icd_seq</a>;
<a name="l00066"></a>00066                 } <a class="code" href="structicmp.html#a98c5f90fa6b536dc583f311da4ba74da">ih_idseq</a>;
<a name="l00067"></a><a class="code" href="structicmp.html#afc83656656ec7b03fe8aee5fbc2f8117">00067</a>                 <span class="keywordtype">int</span> <a class="code" href="structicmp.html#afc83656656ec7b03fe8aee5fbc2f8117">ih_void</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069                 <span class="comment">/* ICMP_UNREACH_NEEDFRAG -- Path MTU Discovery (RFC1191) */</span>
<a name="l00070"></a>00070                 <span class="keyword">struct </span><a class="code" href="structicmp.html#abf188b2a0e1322254d57db3ffb332cf7">ih_pmtu</a> {
<a name="l00071"></a><a class="code" href="structicmp.html#af73e368f9cbcb5e7c05467b2b44468fd">00071</a>                         <a class="code" href="in__systm_8h.html#ab6cdc14ada3945e3a21719421f0f1c46">n_short</a> <a class="code" href="structicmp.html#af73e368f9cbcb5e7c05467b2b44468fd">ipm_void</a>;
<a name="l00072"></a><a class="code" href="structicmp.html#a1c9080b576776867314e797e20186721">00072</a>                         <a class="code" href="in__systm_8h.html#ab6cdc14ada3945e3a21719421f0f1c46">n_short</a> <a class="code" href="structicmp.html#a1c9080b576776867314e797e20186721">ipm_nextmtu</a>;
<a name="l00073"></a>00073                 } <a class="code" href="structicmp.html#abf188b2a0e1322254d57db3ffb332cf7">ih_pmtu</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075                 <span class="keyword">struct </span><a class="code" href="structicmp.html#afada27bbbf6fb841af34990c94cde7f7">ih_rtradv</a> {
<a name="l00076"></a><a class="code" href="structicmp.html#a5714e7802d28ad495e92e9c60faca0dc">00076</a>                         <a class="code" href="bsdint_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structicmp.html#a5714e7802d28ad495e92e9c60faca0dc">irt_num_addrs</a>;
<a name="l00077"></a><a class="code" href="structicmp.html#ad32b6c09bcd164a6b000b397318fe973">00077</a>                         <a class="code" href="bsdint_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structicmp.html#ad32b6c09bcd164a6b000b397318fe973">irt_wpa</a>;
<a name="l00078"></a><a class="code" href="structicmp.html#a4c8905bc31bc42cef676e8fb445b68db">00078</a>                         <a class="code" href="bsdint_8h.html#a5812174a8236d5da1d9add5a828a94bb">u_int16_t</a> <a class="code" href="structicmp.html#a4c8905bc31bc42cef676e8fb445b68db">irt_lifetime</a>;
<a name="l00079"></a>00079                 } <a class="code" href="structicmp.html#afada27bbbf6fb841af34990c94cde7f7">ih_rtradv</a>;
<a name="l00080"></a>00080         } <a class="code" href="structicmp.html#a0329d5c370d7866c51ca888e226cd2aa">icmp_hun</a>;
<a name="l00081"></a><a class="code" href="ip__icmp_8h.html#adc7cc163039bbc2acd42778625840b7c">00081</a> <span class="preprocessor">#define icmp_pptr       icmp_hun.ih_pptr</span>
<a name="l00082"></a><a class="code" href="ip__icmp_8h.html#a674c1075d278307789e93363acc62d05">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_gwaddr     icmp_hun.ih_gwaddr</span>
<a name="l00083"></a><a class="code" href="ip__icmp_8h.html#a6832094d6d482b2569352caffebdcf17">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_id         icmp_hun.ih_idseq.icd_id</span>
<a name="l00084"></a><a class="code" href="ip__icmp_8h.html#a1846768098258c8f755b89b292963305">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_seq        icmp_hun.ih_idseq.icd_seq</span>
<a name="l00085"></a><a class="code" href="ip__icmp_8h.html#a9e4593f2d889228c356847ac48ac3e90">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_void       icmp_hun.ih_void</span>
<a name="l00086"></a><a class="code" href="ip__icmp_8h.html#a6888a30b9ffde1b58a91e9f78fe3610b">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_pmvoid     icmp_hun.ih_pmtu.ipm_void</span>
<a name="l00087"></a><a class="code" href="ip__icmp_8h.html#a5a17149ac6c297d3fdabbef5b3415fd7">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_nextmtu    icmp_hun.ih_pmtu.ipm_nextmtu</span>
<a name="l00088"></a><a class="code" href="ip__icmp_8h.html#a8fcd478739f0f8b9fe1e38b602574f98">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_num_addrs  icmp_hun.ih_rtradv.irt_num_addrs</span>
<a name="l00089"></a><a class="code" href="ip__icmp_8h.html#a220ec65cd2db8a7e34b65dd76ac58360">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_wpa        icmp_hun.ih_rtradv.irt_wpa</span>
<a name="l00090"></a><a class="code" href="ip__icmp_8h.html#a5525cd587008106e35d1be74437f1dac">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_lifetime   icmp_hun.ih_rtradv.irt_lifetime</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>        <span class="keyword">union </span>{
<a name="l00092"></a>00092                 <span class="keyword">struct </span><a class="code" href="structicmp.html#aa095011f8e83442e889eceb48cafe78a">id_ts</a> {
<a name="l00093"></a><a class="code" href="structicmp.html#a2c3daf22cdeaf08729a009f564a07b98">00093</a>                         <a class="code" href="in__systm_8h.html#a697a748be1aa924b67aab95d8de3215b">n_time</a> <a class="code" href="structicmp.html#a2c3daf22cdeaf08729a009f564a07b98">its_otime</a>;
<a name="l00094"></a><a class="code" href="structicmp.html#a70b436ed09e1b4269150b0a95d879932">00094</a>                         <a class="code" href="in__systm_8h.html#a697a748be1aa924b67aab95d8de3215b">n_time</a> <a class="code" href="structicmp.html#a70b436ed09e1b4269150b0a95d879932">its_rtime</a>;
<a name="l00095"></a><a class="code" href="structicmp.html#a66cb96c70aac652d93a1b384fcc184d0">00095</a>                         <a class="code" href="in__systm_8h.html#a697a748be1aa924b67aab95d8de3215b">n_time</a> <a class="code" href="structicmp.html#a66cb96c70aac652d93a1b384fcc184d0">its_ttime</a>;
<a name="l00096"></a>00096                 } <a class="code" href="structicmp.html#aa095011f8e83442e889eceb48cafe78a">id_ts</a>;
<a name="l00097"></a>00097                 <span class="keyword">struct </span><a class="code" href="structicmp.html#a9c00530fd0cca0478d9ab3737162f7a6">id_ip</a>  {
<a name="l00098"></a><a class="code" href="structicmp.html#afd916585a631736b41279ddcac542062">00098</a>                         <span class="keyword">struct </span><a class="code" href="structip.html">ip</a> <a class="code" href="structicmp.html#afd916585a631736b41279ddcac542062">idi_ip</a>;
<a name="l00099"></a>00099                         <span class="comment">/* options and then 64 bits of data */</span>
<a name="l00100"></a>00100                 } <a class="code" href="structicmp.html#a9c00530fd0cca0478d9ab3737162f7a6">id_ip</a>;
<a name="l00101"></a><a class="code" href="structicmp.html#a535cf5aa5f2d8d3ffcd8076029707650">00101</a>                 <span class="keyword">struct </span><a class="code" href="structicmp__ra__addr.html">icmp_ra_addr</a> <a class="code" href="structicmp.html#a535cf5aa5f2d8d3ffcd8076029707650">id_radv</a>;
<a name="l00102"></a><a class="code" href="structicmp.html#a9f2917096ce3a66e05861a69c42788c8">00102</a>                 <a class="code" href="bsdint_8h.html#a0d5a2542b430beb8568bacccd2c657ae">u_int32_t</a> <a class="code" href="structicmp.html#a9f2917096ce3a66e05861a69c42788c8">id_mask</a>;
<a name="l00103"></a><a class="code" href="structicmp.html#a3accffde5e0482f7091db85fa8ed73dd">00103</a>                 <span class="keywordtype">char</span>    <a class="code" href="structicmp.html#a3accffde5e0482f7091db85fa8ed73dd">id_data</a>[1];
<a name="l00104"></a>00104         } <a class="code" href="structicmp.html#ac380e958ce6875336e67dab1e3b8dfac">icmp_dun</a>;
<a name="l00105"></a><a class="code" href="ip__icmp_8h.html#a8bac2b5e6906ad248e6c2a46f02ddb90">00105</a> <span class="preprocessor">#define icmp_otime      icmp_dun.id_ts.its_otime</span>
<a name="l00106"></a><a class="code" href="ip__icmp_8h.html#a3b20e3c85b88ed3b08410d1cefe58590">00106</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_rtime      icmp_dun.id_ts.its_rtime</span>
<a name="l00107"></a><a class="code" href="ip__icmp_8h.html#a06a745e0e8dc401e32f85256aed575e0">00107</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_ttime      icmp_dun.id_ts.its_ttime</span>
<a name="l00108"></a><a class="code" href="ip__icmp_8h.html#af352a429b02a4a385ca78f801b23a541">00108</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_ip         icmp_dun.id_ip.idi_ip</span>
<a name="l00109"></a><a class="code" href="ip__icmp_8h.html#a33040be8eae743da88181a3da44a84b8">00109</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_radv       icmp_dun.id_radv</span>
<a name="l00110"></a><a class="code" href="ip__icmp_8h.html#a3e2342abd5f9e3bd8ee0a5411292ffcd">00110</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_mask       icmp_dun.id_mask</span>
<a name="l00111"></a><a class="code" href="ip__icmp_8h.html#a7eae76e1c45a7a97fc0e050a4df1920f">00111</a> <span class="preprocessor"></span><span class="preprocessor">#define icmp_data       icmp_dun.id_data</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>};
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">/*</span>
<a name="l00115"></a>00115 <span class="comment"> * Lower bounds on packet lengths for various types.</span>
<a name="l00116"></a>00116 <span class="comment"> * For the error advice packets must first insure that the</span>
<a name="l00117"></a>00117 <span class="comment"> * packet is large enough to contain the returned ip header.</span>
<a name="l00118"></a>00118 <span class="comment"> * Only then can we do the check to see if 64 bits of packet</span>
<a name="l00119"></a>00119 <span class="comment"> * data have been returned, since we need to check the returned</span>
<a name="l00120"></a>00120 <span class="comment"> * ip header length.</span>
<a name="l00121"></a>00121 <span class="comment"> */</span>
<a name="l00122"></a><a class="code" href="ip__icmp_8h.html#a4f29f52b21f278ac2f6786b17f0b9d61">00122</a> <span class="preprocessor">#define ICMP_MINLEN     8                               </span><span class="comment">/* abs minimum */</span>
<a name="l00123"></a><a class="code" href="ip__icmp_8h.html#ac88c6c41dfda324c068017b36695de35">00123</a> <span class="preprocessor">#define ICMP_TSLEN      (8 + 3 * sizeof (n_time))       </span><span class="comment">/* timestamp */</span>
<a name="l00124"></a><a class="code" href="ip__icmp_8h.html#a75a31666674028f820564fd152a1abbd">00124</a> <span class="preprocessor">#define ICMP_MASKLEN    12                              </span><span class="comment">/* address mask */</span>
<a name="l00125"></a><a class="code" href="ip__icmp_8h.html#abd3aa4703919ce3d55fa1c102782a563">00125</a> <span class="preprocessor">#define ICMP_ADVLENMIN  (8 + sizeof (struct ip) + 8)    </span><span class="comment">/* min */</span>
<a name="l00126"></a>00126 <span class="preprocessor">#ifndef _IP_VHL</span>
<a name="l00127"></a><a class="code" href="ip__icmp_8h.html#a1ebc93fd61550d0c4c72cce50bc42166">00127</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_ADVLEN(p)  (8 + ((p)-&gt;icmp_ip.ip_hl &lt;&lt; 2) + 8)</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span>        <span class="comment">/* N.B.: must separately check that ip_hl &gt;= 5 */</span>
<a name="l00129"></a>00129 <span class="preprocessor">#else</span>
<a name="l00130"></a>00130 <span class="preprocessor"></span><span class="preprocessor">#define ICMP_ADVLEN(p)  (8 + (IP_VHL_HL((p)-&gt;icmp_ip.ip_vhl) &lt;&lt; 2) + 8)</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>        <span class="comment">/* N.B.: must separately check that header length &gt;= 5 */</span>
<a name="l00132"></a>00132 <span class="preprocessor">#endif</span>
<a name="l00133"></a>00133 <span class="preprocessor"></span>
<a name="l00134"></a>00134 <span class="comment">/*</span>
<a name="l00135"></a>00135 <span class="comment"> * Definition of type and code field values.</span>
<a name="l00136"></a>00136 <span class="comment"> */</span>
<a name="l00137"></a><a class="code" href="ip__icmp_8h.html#a82c3c22ccc3ab020f598fa6832a78d12">00137</a> <span class="preprocessor">#define ICMP_ECHOREPLY          0               </span><span class="comment">/* echo reply */</span>
<a name="l00138"></a><a class="code" href="ip__icmp_8h.html#ad3a53e748928a6746ecf58e63a37a76a">00138</a> <span class="preprocessor">#define ICMP_UNREACH            3               </span><span class="comment">/* dest unreachable, codes: */</span>
<a name="l00139"></a><a class="code" href="ip__icmp_8h.html#ad695f7aac7128e3abc82915c6f2a9721">00139</a> <span class="preprocessor">#define         ICMP_UNREACH_NET        0               </span><span class="comment">/* bad net */</span>
<a name="l00140"></a><a class="code" href="ip__icmp_8h.html#a25d5002e95e22a988eb8ce9122c1daf5">00140</a> <span class="preprocessor">#define         ICMP_UNREACH_HOST       1               </span><span class="comment">/* bad host */</span>
<a name="l00141"></a><a class="code" href="ip__icmp_8h.html#a75a0a4e438c2f095e306318d02897c7c">00141</a> <span class="preprocessor">#define         ICMP_UNREACH_PROTOCOL   2               </span><span class="comment">/* bad protocol */</span>
<a name="l00142"></a><a class="code" href="ip__icmp_8h.html#af9db0dedc4a6ca12e315542afd11db9d">00142</a> <span class="preprocessor">#define         ICMP_UNREACH_PORT       3               </span><span class="comment">/* bad port */</span>
<a name="l00143"></a><a class="code" href="ip__icmp_8h.html#a32101bbef8beda8004e7112ad8af3029">00143</a> <span class="preprocessor">#define         ICMP_UNREACH_NEEDFRAG   4               </span><span class="comment">/* IP_DF caused drop */</span>
<a name="l00144"></a><a class="code" href="ip__icmp_8h.html#a79fc9e676e979520db8247b9302802f5">00144</a> <span class="preprocessor">#define         ICMP_UNREACH_SRCFAIL    5               </span><span class="comment">/* src route failed */</span>
<a name="l00145"></a><a class="code" href="ip__icmp_8h.html#a28c9f635a6551ba5d842f8672a58774c">00145</a> <span class="preprocessor">#define         ICMP_UNREACH_NET_UNKNOWN 6              </span><span class="comment">/* unknown net */</span>
<a name="l00146"></a><a class="code" href="ip__icmp_8h.html#acd00983d980abbda9a0762bb6e7fee69">00146</a> <span class="preprocessor">#define         ICMP_UNREACH_HOST_UNKNOWN 7             </span><span class="comment">/* unknown host */</span>
<a name="l00147"></a><a class="code" href="ip__icmp_8h.html#a4546803be674575ba2ec6424011eb5e8">00147</a> <span class="preprocessor">#define         ICMP_UNREACH_ISOLATED   8               </span><span class="comment">/* src host isolated */</span>
<a name="l00148"></a><a class="code" href="ip__icmp_8h.html#a1386dd7a5fa25c72b3345b086cfaa908">00148</a> <span class="preprocessor">#define         ICMP_UNREACH_NET_PROHIB 9               </span><span class="comment">/* prohibited access */</span>
<a name="l00149"></a><a class="code" href="ip__icmp_8h.html#ae0e91190bde99d43f5c018b2dc762bac">00149</a> <span class="preprocessor">#define         ICMP_UNREACH_HOST_PROHIB 10             </span><span class="comment">/* ditto */</span>
<a name="l00150"></a><a class="code" href="ip__icmp_8h.html#ac9430643f92cb6de557b75fb7ffab333">00150</a> <span class="preprocessor">#define         ICMP_UNREACH_TOSNET     11              </span><span class="comment">/* bad tos for net */</span>
<a name="l00151"></a><a class="code" href="ip__icmp_8h.html#a511e02898ef2f8ab6ff8455eedbd652f">00151</a> <span class="preprocessor">#define         ICMP_UNREACH_TOSHOST    12              </span><span class="comment">/* bad tos for host */</span>
<a name="l00152"></a><a class="code" href="ip__icmp_8h.html#ad0d4d06c5c5b571be8f5a7a1d2ac5518">00152</a> <span class="preprocessor">#define         ICMP_UNREACH_FILTER_PROHIB 13           </span><span class="comment">/* admin prohib */</span>
<a name="l00153"></a><a class="code" href="ip__icmp_8h.html#a529f5737053a7478ba08ab0dd96956e6">00153</a> <span class="preprocessor">#define         ICMP_UNREACH_HOST_PRECEDENCE 14         </span><span class="comment">/* host prec vio. */</span>
<a name="l00154"></a><a class="code" href="ip__icmp_8h.html#a8f7acb47770cdf234afdfa27b6adb43e">00154</a> <span class="preprocessor">#define         ICMP_UNREACH_PRECEDENCE_CUTOFF 15       </span><span class="comment">/* prec cutoff */</span>
<a name="l00155"></a><a class="code" href="ip__icmp_8h.html#a8504ceb34b1a35c57b9d5ae26ad4b2c6">00155</a> <span class="preprocessor">#define ICMP_SOURCEQUENCH       4               </span><span class="comment">/* packet lost, slow down */</span>
<a name="l00156"></a>00156 <span class="comment">//A FIXME the following line conflicts with enum in ICMPMessage.msg, resolve!</span>
<a name="l00157"></a>00157 <span class="comment">//A #define ICMP_REDIRECT           5               /* shorter route, codes: */</span>
<a name="l00158"></a><a class="code" href="ip__icmp_8h.html#ad8e40976e1ea1c02d94c95154c409cbc">00158</a> <span class="preprocessor">#define         ICMP_REDIRECT_NET       0               </span><span class="comment">/* for network */</span>
<a name="l00159"></a><a class="code" href="ip__icmp_8h.html#a6ecef2568746345474500899111438e0">00159</a> <span class="preprocessor">#define         ICMP_REDIRECT_HOST      1               </span><span class="comment">/* for host */</span>
<a name="l00160"></a><a class="code" href="ip__icmp_8h.html#aed025a114e8d4c90a71e4d5c6760f0f8">00160</a> <span class="preprocessor">#define         ICMP_REDIRECT_TOSNET    2               </span><span class="comment">/* for tos and net */</span>
<a name="l00161"></a><a class="code" href="ip__icmp_8h.html#a960ac5195a093f09344ab2799f40efa0">00161</a> <span class="preprocessor">#define         ICMP_REDIRECT_TOSHOST   3               </span><span class="comment">/* for tos and host */</span>
<a name="l00162"></a><a class="code" href="ip__icmp_8h.html#ad58231410d58e34b455328b888a9e73c">00162</a> <span class="preprocessor">#define ICMP_ECHO               8               </span><span class="comment">/* echo service */</span>
<a name="l00163"></a><a class="code" href="ip__icmp_8h.html#a378e8c9e15b519665b52161df53eea56">00163</a> <span class="preprocessor">#define ICMP_ROUTERADVERT       9               </span><span class="comment">/* router advertisement */</span>
<a name="l00164"></a><a class="code" href="ip__icmp_8h.html#a3c94ac7432cd169ab5c9ef37d50ad981">00164</a> <span class="preprocessor">#define ICMP_ROUTERSOLICIT      10              </span><span class="comment">/* router solicitation */</span>
<a name="l00165"></a><a class="code" href="ip__icmp_8h.html#a8e3af9a982f823093f685c01ea77903c">00165</a> <span class="preprocessor">#define ICMP_TIMXCEED           11              </span><span class="comment">/* time exceeded, code: */</span>
<a name="l00166"></a><a class="code" href="ip__icmp_8h.html#a86217329cd3fbb7c747942d172423c42">00166</a> <span class="preprocessor">#define         ICMP_TIMXCEED_INTRANS   0               </span><span class="comment">/* ttl==0 in transit */</span>
<a name="l00167"></a><a class="code" href="ip__icmp_8h.html#ae99744be808ccf1c4dc27c16cd91a7de">00167</a> <span class="preprocessor">#define         ICMP_TIMXCEED_REASS     1               </span><span class="comment">/* ttl==0 in reass */</span>
<a name="l00168"></a><a class="code" href="ip__icmp_8h.html#aa4319c170ff4577ab7bd22a070643db7">00168</a> <span class="preprocessor">#define ICMP_PARAMPROB          12              </span><span class="comment">/* ip header bad */</span>
<a name="l00169"></a><a class="code" href="ip__icmp_8h.html#a3403fed706f95fcb348285336fe2b08b">00169</a> <span class="preprocessor">#define         ICMP_PARAMPROB_ERRATPTR 0               </span><span class="comment">/* error at param ptr */</span>
<a name="l00170"></a><a class="code" href="ip__icmp_8h.html#a863452dc23f115cd09b48b53771fd330">00170</a> <span class="preprocessor">#define         ICMP_PARAMPROB_OPTABSENT 1              </span><span class="comment">/* req. opt. absent */</span>
<a name="l00171"></a><a class="code" href="ip__icmp_8h.html#a3cf9b5f1a7c6e0383cfdc63ecfacbfe0">00171</a> <span class="preprocessor">#define         ICMP_PARAMPROB_LENGTH 2                 </span><span class="comment">/* bad length */</span>
<a name="l00172"></a><a class="code" href="ip__icmp_8h.html#a62bf3a7886f5cbbd6f0f67303a39fc8f">00172</a> <span class="preprocessor">#define ICMP_TSTAMP             13              </span><span class="comment">/* timestamp request */</span>
<a name="l00173"></a><a class="code" href="ip__icmp_8h.html#afa0adb2fb9705db67f1145ab92d581a7">00173</a> <span class="preprocessor">#define ICMP_TSTAMPREPLY        14              </span><span class="comment">/* timestamp reply */</span>
<a name="l00174"></a><a class="code" href="ip__icmp_8h.html#a3fd3b310a59aa6bad86a0c37a99aeb8c">00174</a> <span class="preprocessor">#define ICMP_IREQ               15              </span><span class="comment">/* information request */</span>
<a name="l00175"></a><a class="code" href="ip__icmp_8h.html#ac25271988d45328dc281f8ed301d0b2a">00175</a> <span class="preprocessor">#define ICMP_IREQREPLY          16              </span><span class="comment">/* information reply */</span>
<a name="l00176"></a><a class="code" href="ip__icmp_8h.html#ad200822fc3735b19416dbd8376b02e37">00176</a> <span class="preprocessor">#define ICMP_MASKREQ            17              </span><span class="comment">/* address mask request */</span>
<a name="l00177"></a><a class="code" href="ip__icmp_8h.html#aeecbd895301a4ebe549f270a6486b0c5">00177</a> <span class="preprocessor">#define ICMP_MASKREPLY          18              </span><span class="comment">/* address mask reply */</span>
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="ip__icmp_8h.html#a45cc8a1d1420b4048b8ee5bf2c8518a6">00179</a> <span class="preprocessor">#define ICMP_MAXTYPE            18</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>
<a name="l00181"></a><a class="code" href="ip__icmp_8h.html#aa1f2425f19b05145a368dfb2a827a993">00181</a> <span class="preprocessor">#define ICMP_INFOTYPE(type) \</span>
<a name="l00182"></a>00182 <span class="preprocessor">        ((type) == ICMP_ECHOREPLY || (type) == ICMP_ECHO || \</span>
<a name="l00183"></a>00183 <span class="preprocessor">        (type) == ICMP_ROUTERADVERT || (type) == ICMP_ROUTERSOLICIT || \</span>
<a name="l00184"></a>00184 <span class="preprocessor">        (type) == ICMP_TSTAMP || (type) == ICMP_TSTAMPREPLY || \</span>
<a name="l00185"></a>00185 <span class="preprocessor">        (type) == ICMP_IREQ || (type) == ICMP_IREQREPLY || \</span>
<a name="l00186"></a>00186 <span class="preprocessor">        (type) == ICMP_MASKREQ || (type) == ICMP_MASKREPLY)</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span>
<a name="l00188"></a>00188 <span class="comment">/*...*/</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:28 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
