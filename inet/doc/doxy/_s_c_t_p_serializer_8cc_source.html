<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: SCTPSerializer.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1a1cc47ff911b796c3b0426b22e55889.html">util</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a76da0457022aaae9a599ef816f66f88.html">headerserializers</a>
  </div>
</div>
<div class="contents">
<h1>SCTPSerializer.cc</h1><a href="_s_c_t_p_serializer_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// Copyright (C) 2005 Christian Dankbar, Irene Ruengeler, Michael Tuexen, Andras Varga</span>
<a name="l00003"></a>00003 <span class="comment">// Copyright (C) 2010 Thomas Dreibholz</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This program is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment">// modify it under the terms of the GNU General Public License</span>
<a name="l00007"></a>00007 <span class="comment">// as published by the Free Software Foundation; either version 2</span>
<a name="l00008"></a>00008 <span class="comment">// of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">// This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment">// GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">// along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">headers/defs.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="keyword">namespace </span>INETFw <span class="comment">// load headers into a namespace, to avoid conflicts with platform definitions of the same stuff</span>
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="bsdint_8h.html">headers/bsdint.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="in_8h.html">headers/in.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="in__systm_8h.html">headers/in_systm.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="ip_8h.html">headers/ip.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="sctp_8h.html">headers/sctp.h</a>&quot;</span>
<a name="l00027"></a>00027 };
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_serializer_8h.html">SCTPSerializer.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_s_c_t_p_association_8h.html">SCTPAssociation.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;platdep/intxtypes.h&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#if !defined(_WIN32) &amp;&amp; !defined(__WIN32__) &amp;&amp; !defined(WIN32) &amp;&amp; !defined(__CYGWIN__) &amp;&amp; !defined(_WIN64)</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#include &lt;netinet/in.h&gt;</span>  <span class="comment">// htonl, ntohl, ...</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#endif</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="keyword">using namespace </span>INETFw;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 int32 <a class="code" href="class_s_c_t_p_serializer.html#ab955e6ade690a1a3332ec8827af55ddf">SCTPSerializer::serialize</a>(<span class="keyword">const</span> <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *msg, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, uint32 bufsize)
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048     int32 size_init_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>);
<a name="l00049"></a>00049     int32 size_sack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>);
<a name="l00050"></a>00050     int32 size_heartbeat_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>);
<a name="l00051"></a>00051     int32 size_heartbeat_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>);
<a name="l00052"></a>00052     int32 size_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> *ch = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>*) (buf);
<a name="l00056"></a>00056     uint32 writtenbytes = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     <span class="comment">// fill SCTP common header structure</span>
<a name="l00059"></a>00059     ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a16df1d45094b56d46256db05ebb39fc3">source_port</a> = htons(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a558f8691efac42febdfd422ce52a762c">getSrcPort</a>());
<a name="l00060"></a>00060     ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a6b69320aeac29fa21ad450b2104336c1">destination_port</a> = htons(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a813a5ab9db3e1c4ae354bf44de934a5b">getDestPort</a>());
<a name="l00061"></a>00061     ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a7405e47d14a91f6fa6558a25770b94b2">verification_tag</a> = htonl(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#acdebc18b6064656d372b86198736dd67">getTag</a>());
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="comment">// SCTP chunks:</span>
<a name="l00065"></a>00065     int32 noChunks = msg-&gt;<a class="code" href="class_s_c_t_p_message.html#a6f20de2280586794996c56c77bf5c479">getChunksArraySize</a>();
<a name="l00066"></a>00066         <span class="keywordflow">for</span>(int32 cc = 0; cc &lt; noChunks; cc++)
<a name="l00067"></a>00067         {
<a name="l00068"></a>00068             <span class="keyword">const</span> <a class="code" href="class_s_c_t_p_chunk.html">SCTPChunk</a> *<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> = check_and_cast&lt;<a class="code" href="class_s_c_t_p_chunk.html">SCTPChunk</a> *&gt;(((<a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *)msg)-&gt;getChunks(cc));
<a name="l00069"></a>00069             <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> chunkType = <a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>-&gt;getChunkType();
<a name="l00070"></a>00070             <span class="keywordflow">switch</span>(chunkType)
<a name="l00071"></a>00071             {
<a name="l00072"></a>00072                 <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#ad70ed57eb996b190fc586f309107250ea9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
<a name="l00073"></a>00073                 {
<a name="l00074"></a>00074                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Data sent \n&quot;;</span>
<a name="l00075"></a>00075                     <a class="code" href="class_s_c_t_p_data_chunk.html">SCTPDataChunk</a> *dataChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_data_chunk.html">SCTPDataChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00076"></a>00076                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a> *dc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00077"></a>00077                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structdata__chunk.html#aa705d8bf5f389d647f322aa875f12fb6">flags</a> = 0;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079                     <span class="comment">// fill buffer with data from SCTP data chunk structure</span>
<a name="l00080"></a>00080                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a109e8b0a1dcbe8922d54aa7a1e959e33">type</a> = dataChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00081"></a>00081                     <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a7e5d0159206e00474d6d19ca7d67c871">getUBit</a>())
<a name="l00082"></a>00082                         flags |= <a class="code" href="sctp_8h.html#a5d2f622082102fd699ac9d0bee5d58eb">UNORDERED_BIT</a>;
<a name="l00083"></a>00083                     <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a09be0795444196f77657d82cfc0a1e8e">getBBit</a>())
<a name="l00084"></a>00084                         flags |= <a class="code" href="sctp_8h.html#a138a317c166a9972907b7d1543a56398">BEGIN_BIT</a>;
<a name="l00085"></a>00085                     <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a53ca18ab3a98a501cdc5800c1037afe2">getEBit</a>())
<a name="l00086"></a>00086                         flags |= <a class="code" href="sctp_8h.html#a49f85dedca778ecc4208f7c9cf5f9ca7">END_BIT</a>;
<a name="l00087"></a>00087                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> = flags;
<a name="l00088"></a>00088                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a0ab55ad1c1ba0ab2aa4082aed1ccf537">length</a> = htons(dataChunk-&gt;getByteLength());
<a name="l00089"></a>00089                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a25db3ec53867059f7ffe5b050a43ae14">tsn</a> = htonl(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a3b70fe8e5afc376f25caa199b117c9f2">getTsn</a>());
<a name="l00090"></a>00090                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a22aace84bd5e2295d4e706a55437cc1d">sid</a> = htons(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a8e381b0653e3fc6a34ae896e040b30bf">getSid</a>());
<a name="l00091"></a>00091                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a240c6255e13bad8f6a7d41f5ec3559ef">ssn</a> = htons(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a1473a86a339c6d1821a42ee85da6b792">getSsn</a>());
<a name="l00092"></a>00092                     dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a379ae5a1ddc385ee44d98cffd39632ee">ppi</a> = htonl(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#af0daf8b4cbb2620106d449c065ac4a4d">getPpid</a>());
<a name="l00093"></a>00093                     writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#aad0be78d1352b9d9fa6a695ed18c9d65">SCTP_DATA_CHUNK_LENGTH</a>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095                     <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a> *smsg = check_and_cast&lt;<a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a> *&gt;(dataChunk-&gt;getEncapsulatedMsg());
<a name="l00096"></a>00096                         <span class="comment">// T.D. 09.02.2010: Only copy data when there is something to copy!</span>
<a name="l00097"></a>00097                         <span class="keyword">const</span> uint32 datalen = smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a4838827e65f3ed85291583a6b629852f">getDataLen</a>();
<a name="l00098"></a>00098                         <span class="keywordflow">if</span>( smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a622610c3483c746bcdb2873d2c31bb5e">getDataArraySize</a>() &gt;= datalen) {
<a name="l00099"></a>00099                             <span class="keywordflow">for</span> (uint32 i = 0; i &lt; datalen; i++) {
<a name="l00100"></a>00100                                 dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a3747c423ac3fa73c5954351d1e38ded0">user_data</a>[i] = smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a0a498c322e58707458a0ab5b33b80ff8">getData</a>(i);
<a name="l00101"></a>00101                             }
<a name="l00102"></a>00102                         }
<a name="l00103"></a>00103                         writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(datalen);
<a name="l00104"></a>00104                     <span class="keywordflow">break</span>;
<a name="l00105"></a>00105                 }
<a name="l00106"></a>00106                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
<a name="l00107"></a>00107                 {
<a name="l00108"></a>00108                     <span class="comment">//sctpEV3&lt;&lt;&quot;serialize INIT sizeKeyVector=&quot;&lt;&lt;sizeKeyVector&lt;&lt;&quot;\n&quot;;</span>
<a name="l00109"></a>00109                     <span class="comment">// source data from internal struct:</span>
<a name="l00110"></a>00110                     <a class="code" href="class_s_c_t_p_init_chunk.html">SCTPInitChunk</a> *initChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_init_chunk.html">SCTPInitChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00111"></a>00111                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Init sent \n&quot;;</span>
<a name="l00112"></a>00112                     <span class="comment">// destination is send buffer:</span>
<a name="l00113"></a>00113                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> *ic = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00114"></a>00114                     <span class="comment">//buflen += (initChunk-&gt;getBitLength() / 8);</span>
<a name="l00115"></a>00115 
<a name="l00116"></a>00116                     <span class="comment">// fill buffer with data from SCTP init chunk structure</span>
<a name="l00117"></a>00117                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a9cdebf76f678051b3692f14e6d92aae0">type</a> = initChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00118"></a>00118                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a8b0d56d06d49b51197d6200cddba834a">flags</a> = 0; <span class="comment">// no flags available in this type of SCTPChunk</span>
<a name="l00119"></a>00119                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a7315d4164cc15995adf0bdec0511af1c">initiate_tag</a> = htonl(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#afa1021475befe8c6a1c6916c71409458">getInitTag</a>());
<a name="l00120"></a>00120                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a54cf1029a7b2d050336e4c76cd197654">a_rwnd</a> = htonl(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ac3e3b0bfb2f205d91a1c0f451f214fde">getA_rwnd</a>());
<a name="l00121"></a>00121                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a947a36c02bac8bb6549ad270fe51714e">mos</a> = htons(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a9216f42a96bd384ccd5fc7efbe429646">getNoOutStreams</a>());
<a name="l00122"></a>00122                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ae3094436bd6843ba61ab9b20f44e87f9">mis</a> = htons(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a7d5b4ee8a00cd330a724936d3ad0403d">getNoInStreams</a>());
<a name="l00123"></a>00123                     ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ad0e25ef59a88465391ed7ed5608f9b70">initial_tsn</a> = htonl(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ae4065b9263e0e1fb023fa04cfbdf25d3">getInitTSN</a>());
<a name="l00124"></a>00124                     int32 parPtr = 0;
<a name="l00125"></a>00125                     <span class="comment">// Var.-Len. Parameters</span>
<a name="l00126"></a>00126                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>* sup_addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)ic) + size_init_chunk + parPtr);
<a name="l00127"></a>00127                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a149ee2f7dad36d74724e488903940246">type</a> = htons(<a class="code" href="sctp_8h.html#a19e00fdb6119cefd4b310c27a117739f">INIT_SUPPORTED_ADDRESS</a>);
<a name="l00128"></a>00128                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a51610238a939c7fd088bf7a795d70357">length</a> = htons(6);
<a name="l00129"></a>00129                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a11dffde51b23deb764cd03e2f340db26">address_type</a> = htons(<a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>);
<a name="l00130"></a>00130                     parPtr += 8;
<a name="l00131"></a>00131                     int32 numaddr = initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ab8d75b13425628af279f244c43e17637">getAddressesArraySize</a>();
<a name="l00132"></a>00132                     <span class="keywordflow">for</span>(int32 i=0; i&lt;numaddr; i++)
<a name="l00133"></a>00133                     {
<a name="l00134"></a>00134                             <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *ipv4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)ic) + size_init_chunk + parPtr);
<a name="l00135"></a>00135                             ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#ae6f54209bc788f8225512e9caf290da0">type</a> = htons(<a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>);
<a name="l00136"></a>00136                             ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a823367d591586e1469d57df9a3278d30">length</a> = htons(8);
<a name="l00137"></a>00137                             ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a> = htonl(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a959b2cb8375fd157035cad0b4e37c00e">getAddresses</a>(i).<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>());
<a name="l00138"></a>00138                             parPtr += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>);
<a name="l00139"></a>00139                     }
<a name="l00140"></a>00140                     ic-&gt;length = htons(<a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr);
<a name="l00141"></a>00141                     writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr;
<a name="l00142"></a>00142                     <span class="keywordflow">break</span>;
<a name="l00143"></a>00143                 }
<a name="l00144"></a>00144                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
<a name="l00145"></a>00145                 {
<a name="l00146"></a>00146                     <span class="comment">//sctpEV3&lt;&lt;&quot;serialize INIT_ACK sizeKeyVector=&quot;&lt;&lt;sizeKeyVector&lt;&lt;&quot;\n&quot;;</span>
<a name="l00147"></a>00147                     <a class="code" href="class_s_c_t_p_init_ack_chunk.html">SCTPInitAckChunk</a> *initAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html">SCTPInitAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00148"></a>00148                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: InitAck sent \n&quot;;</span>
<a name="l00149"></a>00149                     <span class="comment">// destination is send buffer:</span>
<a name="l00150"></a>00150                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a> *iac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00151"></a>00151                     <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
<a name="l00152"></a>00152                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a0b3250c76a08f6fa3363814b5f91f25c">type</a> = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00153"></a>00153 <span class="comment">//                  iac-&gt;flags = initAckChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
<a name="l00154"></a>00154                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a7a54bd2ed88345cdb5c902f56bc8d3c7">initiate_tag</a> = htonl(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a067000126a6938965bc9deaeed4f33d2">getInitTag</a>());
<a name="l00155"></a>00155                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#aa95033ee21e5290df42be51a8b696679">a_rwnd</a> = htonl(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aa625f04bffd8ec87bb7226eb3ed1abb8">getA_rwnd</a>());
<a name="l00156"></a>00156                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af32685d03e6d9489916b3e6824261ac5">mos</a> = htons(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a64b761b71a09ea953f5bce83fd97ffdd">getNoOutStreams</a>());
<a name="l00157"></a>00157                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af18c98e1baef7393f88d5141b17e0c91">mis</a> = htons(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad5c6481930be3268165af4939b911bd3">getNoInStreams</a>());
<a name="l00158"></a>00158                     iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af9294b9a9ff18b46973e93b122b74413">initial_tsn</a> = htonl(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ab0621aa5ef96b63f7a2660c421149179">getInitTSN</a>());
<a name="l00159"></a>00159                     <span class="comment">// Var.-Len. Parameters</span>
<a name="l00160"></a>00160                     int32 parPtr=0;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>* sup_addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
<a name="l00163"></a>00163                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a149ee2f7dad36d74724e488903940246">type</a> = htons(<a class="code" href="sctp_8h.html#a19e00fdb6119cefd4b310c27a117739f">INIT_SUPPORTED_ADDRESS</a>);
<a name="l00164"></a>00164                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a51610238a939c7fd088bf7a795d70357">length</a> = htons(6);
<a name="l00165"></a>00165                     sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a11dffde51b23deb764cd03e2f340db26">address_type</a> = htons(<a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>);
<a name="l00166"></a>00166                     parPtr += 8;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a>00169                     int32 numaddr = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5c7c883d19db47b99bc1549fb5000a2f">getAddressesArraySize</a>();
<a name="l00170"></a>00170                     <span class="keywordflow">for</span>(int32 i=0; i&lt;numaddr; i++)
<a name="l00171"></a>00171                     {
<a name="l00172"></a>00172                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *ipv4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
<a name="l00173"></a>00173                         ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#ae6f54209bc788f8225512e9caf290da0">type</a> = htons(<a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>);
<a name="l00174"></a>00174                         ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a823367d591586e1469d57df9a3278d30">length</a> = htons(8);
<a name="l00175"></a>00175                         ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a> = htonl(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ab0b54784a3ce7250ea7319d06c2c1d51">getAddresses</a>(i).<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>());
<a name="l00176"></a>00176                         parPtr += 8;
<a name="l00177"></a>00177                     }
<a name="l00178"></a>00178                     uint32 uLen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a782f1937ded9a07b427f13c9a6a22330">getUnrecognizedParametersArraySize</a>();
<a name="l00179"></a>00179                     <span class="keywordflow">if</span> (uLen&gt;0)
<a name="l00180"></a>00180                     {
<a name="l00181"></a>00181                         <span class="comment">//sctpEV3&lt;&lt;&quot;uLen=&quot;&lt;&lt;uLen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00182"></a>00182                         int32 k=0;
<a name="l00183"></a>00183                         uint32 pLen=0;
<a name="l00184"></a>00184                         <span class="keywordflow">while</span> (uLen&gt;0)
<a name="l00185"></a>00185                         {
<a name="l00186"></a>00186                             <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>* unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
<a name="l00187"></a>00187                             unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = htons(<a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1a84eff3c1951655fd6a05c80649382f6b">UNRECOGNIZED_PARAMETER</a>);
<a name="l00188"></a>00188                             pLen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k+2)*16+initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k+3);
<a name="l00189"></a>00189                             unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = htons(pLen+4);
<a name="l00190"></a>00190                             <span class="comment">//sctpEV3&lt;&lt;&quot;unknown-&gt;length=&quot;&lt;&lt;pLen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00191"></a>00191                             <span class="keywordflow">for</span> (uint32 i=0; i&lt;<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen); i++,k++)
<a name="l00192"></a>00192                                 unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k);
<a name="l00193"></a>00193                             parPtr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen+4);
<a name="l00194"></a>00194                             uLen-=<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen);
<a name="l00195"></a>00195                         }
<a name="l00196"></a>00196                     }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198                     <span class="comment">/*if(cookielen == 0)</span>
<a name="l00199"></a>00199 <span class="comment">                    {</span>
<a name="l00200"></a>00200 <span class="comment">                        cookielen = 4;</span>
<a name="l00201"></a>00201 <span class="comment">                        initAckChunk-&gt;setCookieArraySize(cookielen);</span>
<a name="l00202"></a>00202 <span class="comment">                        initAckChunk-&gt;setCookie(0, &apos;1&apos;);</span>
<a name="l00203"></a>00203 <span class="comment">                        initAckChunk-&gt;setCookie(1, &apos;3&apos;);</span>
<a name="l00204"></a>00204 <span class="comment">                        initAckChunk-&gt;setCookie(2, &apos;3&apos;);</span>
<a name="l00205"></a>00205 <span class="comment">                        initAckChunk-&gt;setCookie(3, &apos;7&apos;);</span>
<a name="l00206"></a>00206 <span class="comment">                        iac-&gt;length = htons(ntohs(iac-&gt;length) + 8);</span>
<a name="l00207"></a>00207 <span class="comment">                    }*/</span>
<a name="l00208"></a>00208                     int32 cookielen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a24e8f6d8289e0f9df13cb0b009591865">getCookieArraySize</a>();
<a name="l00209"></a>00209                     <span class="keywordflow">if</span> (cookielen == 0)
<a name="l00210"></a>00210                     {
<a name="l00211"></a>00211                         <a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>* stateCookie = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>*&gt;(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a18e03b3bbea7b90f09d94bc1c24c97bc">getStateCookie</a>());
<a name="l00212"></a>00212                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html">init_cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html">init_cookie_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
<a name="l00213"></a>00213                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a14e5be998afe475f8ff332622f3bfc5f">type</a> = htons(<a class="code" href="sctp_8h.html#a34127e7f145642fb19969a905c0511dc">INIT_PARAM_COOKIE</a>);
<a name="l00214"></a>00214                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aca52f335a966cd309357456ebdffdd73">length</a> = htons(<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a> + 4);
<a name="l00215"></a>00215                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aebe858a7bbcb4e6993ce77152b5fdd2a">creationTime</a> = htonl((uint32)stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a7179eff47c800dd97c0f37e7947f595b">getCreationTime</a>().dbl());
<a name="l00216"></a>00216                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#ab2cae663323b64da289760e11bf97a29">localTag</a> = htonl(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a58e344ded6300ff9e53918bdfc9aaf71">getLocalTag</a>());
<a name="l00217"></a>00217                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#af89b5edd30a497adb8d1236173653c16">peerTag</a> = htonl(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ab0b4b413af3d743f9fc768dbf3634f0f">getPeerTag</a>());
<a name="l00218"></a>00218                         <span class="keywordflow">for</span>(int32 i=0; i&lt;32; i++)
<a name="l00219"></a>00219                         {
<a name="l00220"></a>00220                             cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aa289cc30d97125318f42cb82346cb042">localTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a8e219a869570afe5d5bc7dd6c89b38c8">getLocalTieTag</a>(i);
<a name="l00221"></a>00221                             cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a4ef1c054d13571f1aa5c827596f18989">peerTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ae49d49fe8c5bb9734f8b2fc2ba9f40c4">getPeerTieTag</a>(i);
<a name="l00222"></a>00222                         }
<a name="l00223"></a>00223                         parPtr += (<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a> + 4);
<a name="l00224"></a>00224                     }
<a name="l00225"></a>00225                     <span class="keywordflow">else</span>
<a name="l00226"></a>00226                     {
<a name="l00227"></a>00227                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
<a name="l00228"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#abbcc4e9f6ee199a20a25720e333f1453">00228</a>                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = htons(<a class="code" href="sctp_8h.html#a34127e7f145642fb19969a905c0511dc">INIT_PARAM_COOKIE</a>);
<a name="l00229"></a>00229                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = htons(cookielen+4);
<a name="l00230"></a>00230                         <span class="keywordflow">for</span>(int32 i=0; i&lt;cookielen; i++)
<a name="l00231"></a>00231                             cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a8d62a78b87a356c3effaf9f90e3bf86a">getCookie</a>(i);
<a name="l00232"></a>00232                         parPtr += cookielen + 4;
<a name="l00233"></a>00233                     }
<a name="l00234"></a>00234                     iac-&gt;length = htons(<a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr);
<a name="l00235"></a>00235                     writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr;
<a name="l00236"></a>00236                     <span class="keywordflow">break</span>;
<a name="l00237"></a>00237                 }
<a name="l00238"></a>00238                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
<a name="l00239"></a>00239                 {
<a name="l00240"></a>00240                     <a class="code" href="class_s_c_t_p_sack_chunk.html">SCTPSackChunk</a> *sackChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_sack_chunk.html">SCTPSackChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242                     <span class="comment">// destination is send buffer:</span>
<a name="l00243"></a>00243                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00244"></a>00244                     writtenbytes += (sackChunk-&gt;getBitLength() / 8);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246                     <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
<a name="l00247"></a>00247                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a82a5148eb8f2d054a93bc15b01f90ed0">type</a> = sackChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00248"></a>00248 <span class="comment">//                  sac-&gt;flags = sackChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
<a name="l00249"></a>00249                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a00b437d0173221e4f0962cecaafbe7e9">length</a> = htons(sackChunk-&gt;getBitLength() / 8);
<a name="l00250"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a895709708f8f909cf7b7459491d549e7">00250</a>                     uint32 cumtsnack = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a7ecb9662687cd4a5a86b6a2757785aa0">getCumTsnAck</a>();
<a name="l00251"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ae2473f4a88d141d5298f92a4335b714a">00251</a>                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a561d6bef13b80381e25a0712b3b283a0">cum_tsn_ack</a> = htonl(cumtsnack);
<a name="l00252"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ae8afe1e04bb9bad791443556c3b2cd73">00252</a>                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a9d989ff6f677f8d5afcbbe2d73ece439">a_rwnd</a> = htonl(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a0029266b1d7d234f37e26e9d9ff40be8">getA_rwnd</a>());
<a name="l00253"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ad059798b16d1f615b5af8770175121ba">00253</a>                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#addf4a98ed2d76970afe2a63340a95f00">nr_of_gaps</a> = htons(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aae89c128c7dabd5515ad02ca30523761">getNumGaps</a>());
<a name="l00254"></a>00254                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a36b9ecced9fc135bc8906b8d5a58c7ed">nr_of_dups</a> = htons(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a5f155c6389f26807fb5626cf96a8d8c7">getNumDupTsns</a>());
<a name="l00255"></a>00255 
<a name="l00256"></a>00256                     <span class="comment">// GAPs and Dup. TSNs:</span>
<a name="l00257"></a>00257                     int32 numgaps = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aae89c128c7dabd5515ad02ca30523761">getNumGaps</a>();
<a name="l00258"></a>00258                     int32 numdups = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a5f155c6389f26807fb5626cf96a8d8c7">getNumDupTsns</a>();
<a name="l00259"></a>00259                     <span class="keywordflow">for</span>(int32 i=0; i&lt;numgaps; i++)
<a name="l00260"></a>00260                     {
<a name="l00261"></a>00261                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a> *gap = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)sac) + size_sack_chunk + i*<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>));
<a name="l00262"></a>00262                         gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#a06092a86c2ef2a22d5412e2d7096563f">start</a> = htons(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#ae4b982717b7ea8c7274eeeed36ebc893">getGapStart</a>(i) - cumtsnack);
<a name="l00263"></a>00263                         gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#aff0a1d1c21dd6d36e7b0fff135c93e23">stop</a> = htons(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aaef7b2cb13cfc88decd207a37d3be7f7">getGapStop</a>(i) - cumtsnack);
<a name="l00264"></a>00264                     }
<a name="l00265"></a>00265                     <span class="keywordflow">for</span>(int32 i=0; i&lt;numdups; i++)
<a name="l00266"></a>00266                     {
<a name="l00267"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a1554ef48c7e8f7bd5d6ef2655e59ed07">00267</a>                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a> *dup = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)sac) + size_sack_chunk + numgaps*<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>) + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>));
<a name="l00268"></a>00268                         dup-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html#a264c16210059305d5716d62f3f44366e">tsn</a> = htonl(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a55e6793cd5de44f59b093debeeae6596">getDupTsns</a>(i));
<a name="l00269"></a>00269                     }
<a name="l00270"></a>00270                     <span class="keywordflow">break</span>;
<a name="l00271"></a>00271                 }
<a name="l00272"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a417721f0e1f1445e71fc0f55e04c7026">00272</a>                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
<a name="l00273"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a130bd030a96cdf2ad079d4d0e452af8c">00273</a>                 {
<a name="l00274"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a4dab62eb6b0c87716f292a38ea179f60">00274</a>                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot;  SCTPAssociation:: Heartbeat sent \n&quot;;</span>
<a name="l00275"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a6dc4cfef3512b905e64164e25a611e54">00275</a>                     <a class="code" href="class_s_c_t_p_heartbeat_chunk.html">SCTPHeartbeatChunk</a> *heartbeatChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html">SCTPHeartbeatChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aea710e788ff43835714af0fe1b128819">00277</a>                     <span class="comment">// destination is send buffer:</span>
<a name="l00278"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ab7e3e1cad9a071b1097f0a94d354ec17">00278</a>                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a> *hbc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00279"></a>00279                     writtenbytes += (heartbeatChunk-&gt;getBitLength() / 8);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281                     <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
<a name="l00282"></a>00282                     hbc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a024a36abc0874b6ec935c82aa1c09e45">type</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00283"></a>00283 <span class="comment">//                  hbc-&gt;flags = heartbeatChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
<a name="l00284"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#abbadb580e845deee10f08617b37c9f76">00284</a>                     hbc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a4417dfe66d15d64507e259dc533adead">length</a> = htons(heartbeatChunk-&gt;getBitLength() / 8);
<a name="l00285"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aad2536be3b05d82e79158c07c0d26142">00285</a> 
<a name="l00286"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ae85f29854b413cd4e025c72dcab4b91b">00286</a>                     <span class="comment">// deliver info:</span>
<a name="l00287"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ae3b1617689bb38814e538ee7fa8156db">00287</a>                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbc) + size_heartbeat_chunk);
<a name="l00288"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ad77807141a68a553295ca04447c90d84">00288</a>                     <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> <a class="code" href="structheartbeat__info.html#aa18d6fa900626bccabebca79a2fe2284">addr</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a671948890fb3346480996dfcd2b16e9c">getRemoteAddr</a>();
<a name="l00289"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a19815ff979eaed79adc64041ac70e3ec">00289</a>                     simtime_t <a class="code" href="structheartbeat__info.html#a42185fa571bdbaf64e6f2697f9fb45a1">time</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a9c0553f66439a5818d86e84e8704feb1">getTimeField</a>();
<a name="l00290"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a5cf64e373ede3045bf4b1c57ce371383">00290</a>                     int32 infolen = <span class="keyword">sizeof</span>(addr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>()) + <span class="keyword">sizeof</span>(uint32);
<a name="l00291"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#abc94cde17aa2536a76fd5904fd2b25e8">00291</a>                     hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = htons(1);   <span class="comment">// mandatory</span>
<a name="l00292"></a>00292                     hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = htons(infolen+4);
<a name="l00293"></a>00293                     <a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi) = htonl(addr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>());
<a name="l00294"></a>00294                     <a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi) = htonl((uint32)time.dbl());
<a name="l00295"></a>00295                     <span class="keywordflow">break</span>;
<a name="l00296"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a2f576310e1dd324526b1ec03b36c1dd0">00296</a>                 }
<a name="l00297"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a4cdf02a87b8ae7d4a55fff548c9a09fa">00297</a>                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
<a name="l00298"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ad2ea3e192069e64294ed9ac6b4dfa462">00298</a>                 {
<a name="l00299"></a>00299                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: HeartbeatAck sent \n&quot;;</span>
<a name="l00300"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aa3948f2989d22110df00b0301c0737e7">00300</a>                     <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html">SCTPHeartbeatAckChunk</a> *heartbeatAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html">SCTPHeartbeatAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00301"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a91bdc607d6324d5e68e4ef7d61bbd2d1">00301</a> 
<a name="l00302"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a2354b40fe6732b1f1ae473f7e6f7323d">00302</a>                     <span class="comment">// destination is send buffer:</span>
<a name="l00303"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a0b475a0720d067692ee62f40aa8f419b">00303</a>                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a> *hbac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00304"></a>00304                     writtenbytes += (heartbeatAckChunk-&gt;getBitLength() / 8);
<a name="l00305"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ac2869192c4bfaa89e4bdd6ab2c98ae10">00305</a> 
<a name="l00306"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a5e4aedfe163639f80c2468f1a8dd6788">00306</a>                     <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
<a name="l00307"></a>00307                     hbac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#aaef8cb3cb98d2936416619092e1409de">type</a> = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00308"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a9f851f42f39dbe9ff8703b595a644e7b">00308</a> <span class="comment">//                  hbac-&gt;flags = heartbeatAckChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
<a name="l00309"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aec6d37aacfaeaf5593d85596a8669249">00309</a>                     hbac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#af05e4e0ce777bc2ce5272709d26bfb1e">length</a> = htons(heartbeatAckChunk-&gt;getBitLength() / 8);
<a name="l00310"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a8e54d98b4cfd49a65cfc74e03ab44d6c">00310</a> 
<a name="l00311"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#adc4d2331a3afd78eec093954b690cba8">00311</a>                     <span class="comment">// deliver info:</span>
<a name="l00312"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a516eecde3b5f0838f7abfe48a9c92df3">00312</a>                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbac) + size_heartbeat_ack_chunk);
<a name="l00313"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ae0d24c291d3c7b0cdca26d4cb976d3c1">00313</a>                     int32 infolen = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a4239007b703f906e770471ca6757fefb">getInfoArraySize</a>();
<a name="l00314"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ada562d99bf7cb8a4cecdbbe9b831b0cd">00314</a>                     hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = htons(1); <span class="comment">//mandatory</span>
<a name="l00315"></a>00315                     <span class="keywordflow">if</span> (infolen &gt; 0)
<a name="l00316"></a>00316                     {
<a name="l00317"></a>00317                         hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = htons(infolen+4);
<a name="l00318"></a>00318                         <span class="keywordflow">for</span>(int32 i=0; i&lt;infolen; i++)
<a name="l00319"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aacddf7c2b5ba5c5ea3d2a2f1caa3c825">00319</a>                         {
<a name="l00320"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a334fafc1507c026b2f17469efb246bec">00320</a>                             <a class="code" href="sctp_8h.html#a35a07f4d1137779b208b608ac62f7561">HBI_INFO</a>(hbi)[i] = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a6a665db7ff1af98f5b61b0789952a32d">getInfo</a>(i);
<a name="l00321"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a7f27c48643e3b3994dbd572b7bfacf39">00321</a>                         }
<a name="l00322"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a4dc517fdf859f51d63178223ccfa9a4e">00322</a>                     }
<a name="l00323"></a>00323                     <span class="keywordflow">else</span>
<a name="l00324"></a>00324                     {
<a name="l00325"></a>00325                         <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> addr = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a59638fa6af7a15845301f38dc49145d9">getRemoteAddr</a>();
<a name="l00326"></a>00326                         infolen = <span class="keyword">sizeof</span>(addr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>()) + <span class="keyword">sizeof</span>(uint32);
<a name="l00327"></a>00327                         hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = htons(1);   <span class="comment">// mandatory</span>
<a name="l00328"></a>00328                         hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = htons(infolen+4);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330                         simtime_t time = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#ad42968f09a2532b8fa4dfdb1fd58bb69">getTimeField</a>();
<a name="l00331"></a>00331                         <a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi) = htonl(addr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>().<a class="code" href="class_i_p_address.html#a807ca46964a8403cf0c70f0772179524">getInt</a>());
<a name="l00332"></a>00332                         <a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi) = htonl((uint32)time.dbl());
<a name="l00333"></a>00333                     }
<a name="l00334"></a>00334                     <span class="keywordflow">break</span>;
<a name="l00335"></a>00335                 }
<a name="l00336"></a>00336                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
<a name="l00337"></a>00337                 {
<a name="l00338"></a>00338                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Abort sent \n&quot;;</span>
<a name="l00339"></a>00339                     <a class="code" href="class_s_c_t_p_abort_chunk.html">SCTPAbortChunk</a> *abortChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_abort_chunk.html">SCTPAbortChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00340"></a>00340 
<a name="l00341"></a>00341                     <span class="comment">// destination is send buffer:</span>
<a name="l00342"></a>00342                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a> *ac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
<a name="l00343"></a>00343                     writtenbytes += (abortChunk-&gt;getBitLength() / 8);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345                     <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
<a name="l00346"></a>00346                     ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#afd7b4ac79c01f4f7daf23664cd483832">type</a> = abortChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00347"></a>00347                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> flags = 0;
<a name="l00348"></a>00348                     <span class="keywordflow">if</span>(abortChunk-&gt;<a class="code" href="class_s_c_t_p_abort_chunk.html#adc385c709185844a9d2104026c41f835">getT_Bit</a>())
<a name="l00349"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aece8b1ca2334675a11d1c2b5db05c347">00349</a>                         flags |= <a class="code" href="sctp_8h.html#ace344d543daa81e5cbfbba5fabb29d27">T_BIT</a>;
<a name="l00350"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a97454703cfe4ae9632b3a73d1f1511e7">00350</a>                     ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#af7c6588f89c568b6ca8dcf40cb32daf7">flags</a> = flags;
<a name="l00351"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#af4e2e8e242f96af283deff1707edbcba">00351</a>                     ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#ac0550cef90bd35ba1bf8430ee783743d">length</a> = htons(abortChunk-&gt;getBitLength() / 8);
<a name="l00352"></a>00352                     <span class="keywordflow">break</span>;
<a name="l00353"></a>00353                 }
<a name="l00354"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a3d77d518dcdc111da8b787184369f5af">00354</a>                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
<a name="l00355"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#af12d45d892c69a53bb474a275623755f">00355</a>                 {
<a name="l00356"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a7511337b6071f0d916d80ead4ba69e52">00356</a>                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: CookieEcho sent \n&quot;;</span>
<a name="l00357"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a5c7856e3bddefdb5480e7d55c167e30c">00357</a>                     <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html">SCTPCookieEchoChunk</a> *cookieChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html">SCTPCookieEchoChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00358"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ac33987ef5244891278f4d84bf3a67ac4">00358</a> 
<a name="l00359"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aa52b93944b9f51f46c11f0e6f427657a">00359</a>                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a> *cec = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a>*) (buf + writtenbytes);
<a name="l00360"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a044f6230b745428951a9d9ea15267ab0">00360</a> 
<a name="l00361"></a>00361 
<a name="l00362"></a>00362                     cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aacca81a316c96b6a54ea6d7d6daedc97">type</a> = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00363"></a>00363                     cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#a952814830fb2a5568b7a0b540ae8841e">length</a> = htons(cookieChunk-&gt;getBitLength() / 8);
<a name="l00364"></a>00364                     int32 cookielen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a25f09010d055ab8d1eff2dcbfed08611">getCookieArraySize</a>();
<a name="l00365"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ab8974c8c20e3a7cfdf98dfcb9c184c0c">00365</a>                     <span class="keywordflow">if</span> (cookielen&gt;0)
<a name="l00366"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a96b0b2c3456f31b9c5d4ff5ffe2b4144">00366</a>                     {
<a name="l00367"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#add16d7c3fd617a08256d86dbf61057a1">00367</a>                         <span class="keywordflow">for</span>(int32 i=0; i&lt;cookielen; i++)
<a name="l00368"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a083e5d1a4b4a9b3e41c957bc2f43b1dd">00368</a>                             cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aef00e45b7a6273712cb7c75b4b459c10">state_cookie</a>[i] = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#aed9f912e0b7c694f865e20e1163e1877">getCookie</a>(i);
<a name="l00369"></a>00369                     }
<a name="l00370"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ac1be60dbb2e443d125d88c1b9e51f55c">00370</a>                     <span class="keywordflow">else</span>
<a name="l00371"></a>00371                     {
<a name="l00372"></a>00372                         <a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>* stateCookie = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>*&gt;(cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a08fee47c7a7d7f89a49949156069e267">getStateCookie</a>());
<a name="l00373"></a>00373                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a>*) (buf + writtenbytes+4);
<a name="l00374"></a>00374                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a96b0f36a38c9886943c75ba5b29c0ef0">creationTime</a> = htonl((uint32)stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a7179eff47c800dd97c0f37e7947f595b">getCreationTime</a>().dbl());
<a name="l00375"></a>00375                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a023a4299beb2cfb28dd2ef1dfd0478c7">localTag</a> = htonl(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a58e344ded6300ff9e53918bdfc9aaf71">getLocalTag</a>());
<a name="l00376"></a>00376                         cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a648153b48ec8424e1f72ff921b8a644d">peerTag</a> = htonl(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ab0b4b413af3d743f9fc768dbf3634f0f">getPeerTag</a>());
<a name="l00377"></a>00377                         <span class="keywordflow">for</span>(int32 i=0; i&lt;32; i++)
<a name="l00378"></a>00378                         {
<a name="l00379"></a>00379                             cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#ad99c0071b11d8dfd434ec386226611f7">localTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a8e219a869570afe5d5bc7dd6c89b38c8">getLocalTieTag</a>(i);
<a name="l00380"></a>00380                             cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a34286a6e985ef4527a947f4199333dc0">peerTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ae49d49fe8c5bb9734f8b2fc2ba9f40c4">getPeerTieTag</a>(i);
<a name="l00381"></a>00381                         }
<a name="l00382"></a>00382                     }
<a name="l00383"></a>00383                     writtenbytes += (<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(cookieChunk-&gt;getBitLength() / 8));
<a name="l00384"></a>00384                     <span class="comment">//sctpEV3&lt;&lt;&quot;buflen cookie_echo=&quot;&lt;&lt;buflen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00385"></a>00385                     uint32 uLen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a66537a5a996ca8113360105d3c59e8b9">getUnrecognizedParametersArraySize</a>();
<a name="l00386"></a>00386                     <span class="keywordflow">if</span> (uLen&gt;0)
<a name="l00387"></a>00387                     {
<a name="l00388"></a>00388                         <span class="comment">//sctpEV3&lt;&lt;&quot;uLen=&quot;&lt;&lt;uLen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00389"></a>00389                         <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>* error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*)(buf + writtenbytes);
<a name="l00390"></a>00390                         error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a3ba5d36bfe9d3c3b41b6fe6ebb94a87e">type</a> = <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>;
<a name="l00391"></a>00391                         error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a8a289af1659045a9b902cf5c6334fc59">flags</a> = 0;
<a name="l00392"></a>00392                         int32 k=0;
<a name="l00393"></a>00393                         uint32 pLen=0;
<a name="l00394"></a>00394                         uint32 ecLen = <a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>;
<a name="l00395"></a>00395                         uint32 ecParPtr = 0;
<a name="l00396"></a>00396                         <span class="keywordflow">while</span> (uLen&gt;0)
<a name="l00397"></a>00397                         {
<a name="l00398"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a5d2f622082102fd699ac9d0bee5d58eb">00398</a>                             <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>* unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)error) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>) + ecParPtr);
<a name="l00399"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a138a317c166a9972907b7d1543a56398">00399</a>                             unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = htons(<a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1a84eff3c1951655fd6a05c80649382f6b">UNRECOGNIZED_PARAMETER</a>);
<a name="l00400"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a49f85dedca778ecc4208f7c9cf5f9ca7">00400</a>                             pLen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k+2)*16+cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k+3);
<a name="l00401"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ace344d543daa81e5cbfbba5fabb29d27">00401</a>                             unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = htons(pLen+4);
<a name="l00402"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aa29c80f7f7f901ec7a2c57887f56585d">00402</a>                             ecLen += pLen+4;
<a name="l00403"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a247a414d3f8ce01913edcebbba38fa6a">00403</a>                             <span class="comment">//sctpEV3&lt;&lt;&quot;plength=&quot;&lt;&lt;pLen&lt;&lt;&quot; ecLen=&quot;&lt;&lt;ecLen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00404"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aab56b26929e1200ce22390f2b99752bb">00404</a>                             <span class="keywordflow">for</span> (uint32 i=0; i&lt;<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen); i++,k++)
<a name="l00405"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ab70c2ad45335f9d96e5af8569eab14d5">00405</a>                                 unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k);
<a name="l00406"></a>00406                             ecParPtr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen+4);
<a name="l00407"></a>00407                             <span class="comment">//sctpEV3&lt;&lt;&quot;ecParPtr=&quot;&lt;&lt;ecParPtr&lt;&lt;&quot;\n&quot;;</span>
<a name="l00408"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#ad3af2094050495f1c8c0857d9fd97813">00408</a>                             uLen-=<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen);
<a name="l00409"></a>00409                         }
<a name="l00410"></a>00410                         error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#ab5bfa384fe76de61e158ddde3d148fc4">length</a> = htons(ecLen);
<a name="l00411"></a>00411                         writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>+ecParPtr;
<a name="l00412"></a>00412                     }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414                     <span class="keywordflow">break</span>;
<a name="l00415"></a>00415                 }
<a name="l00416"></a>00416                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
<a name="l00417"></a>00417                 {
<a name="l00418"></a>00418                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: CookieAck sent \n&quot;;</span>
<a name="l00419"></a>00419                     <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html">SCTPCookieAckChunk</a> *cookieAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie_ack_chunk.html">SCTPCookieAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html">cookie_ack_chunk</a> *cac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html">cookie_ack_chunk</a>*) (buf + writtenbytes);
<a name="l00422"></a>00422                     writtenbytes += (cookieAckChunk-&gt;getBitLength() / 8);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424                     cac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a908232d2d65b3f327c8a8e7712f0ed2c">type</a> = cookieAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00425"></a>00425                     cac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a95acfc6cbf8dfc2f783f2523f071f7f7">length</a> = htons(cookieAckChunk-&gt;getBitLength() / 8);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427                     <span class="keywordflow">break</span>;
<a name="l00428"></a>00428                 }
<a name="l00429"></a>00429                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
<a name="l00430"></a>00430                 {
<a name="l00431"></a>00431                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
<a name="l00432"></a>00432                     <a class="code" href="class_s_c_t_p_shutdown_chunk.html">SCTPShutdownChunk</a> *shutdownChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html">SCTPShutdownChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a>*) (buf + writtenbytes);
<a name="l00435"></a>00435                     writtenbytes += (shutdownChunk-&gt;getBitLength() / 8);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#af51d4366e493acaeda6614987c7572ac">type</a> = shutdownChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00438"></a>00438                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a294183dee80de069c3e9583ff376b791">cumulative_tsn_ack</a> = htonl(shutdownChunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html#a0df1b527aee57a52d2275d061cfb3091">getCumTsnAck</a>());
<a name="l00439"></a>00439                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a3ec4f8285d54892e78ec52507e542f96">length</a> = htons(shutdownChunk-&gt;getBitLength() / 8);
<a name="l00440"></a>00440 
<a name="l00441"></a>00441                     <span class="keywordflow">break</span>;
<a name="l00442"></a>00442                 }
<a name="l00443"></a>00443                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
<a name="l00444"></a>00444                 {
<a name="l00445"></a>00445                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
<a name="l00446"></a>00446                     <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html">SCTPShutdownAckChunk</a> *shutdownAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html">SCTPShutdownAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html">shutdown_ack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html">shutdown_ack_chunk</a>*) (buf + writtenbytes);
<a name="l00449"></a>00449                     writtenbytes += (shutdownAckChunk-&gt;getBitLength() / 8);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#ae746b496e56ae3c2b8855f7ef4f04975">type</a> = shutdownAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00452"></a>00452                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#a5bb998c2808be3907aa9b5475b1c56ce">length</a> = htons(shutdownAckChunk-&gt;getBitLength() / 8);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454                     <span class="keywordflow">break</span>;
<a name="l00455"></a>00455                 }
<a name="l00456"></a>00456                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
<a name="l00457"></a>00457                 {
<a name="l00458"></a>00458                     <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
<a name="l00459"></a>00459                     <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html">SCTPShutdownCompleteChunk</a> *shutdownCompleteChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html">SCTPShutdownCompleteChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00460"></a>00460 
<a name="l00461"></a>00461                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a>*) (buf + writtenbytes);
<a name="l00462"></a>00462                     writtenbytes += (shutdownCompleteChunk-&gt;getBitLength() / 8);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a8f6c99af679dd511647d2747bf0a630d">type</a> = shutdownCompleteChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00465"></a>00465                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a81f2f464f168ed2650f5cf162ba95072">length</a> = htons(shutdownCompleteChunk-&gt;getBitLength() / 8);
<a name="l00466"></a>00466                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> flags = 0;
<a name="l00467"></a>00467                     <span class="keywordflow">if</span>(shutdownCompleteChunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html#a3d0a9e1ee2b63b81970e086fa7c1349f">getTBit</a>())
<a name="l00468"></a>00468                         flags |= <a class="code" href="sctp_8h.html#ace344d543daa81e5cbfbba5fabb29d27">T_BIT</a>;
<a name="l00469"></a>00469                     sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a234c2bbc04b3655058a07315144f5dc8">flags</a> = flags;
<a name="l00470"></a>00470                     <span class="keywordflow">break</span>;
<a name="l00471"></a>00471                 }
<a name="l00472"></a>00472                 <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
<a name="l00473"></a>00473                 {
<a name="l00474"></a>00474                     <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>* errorchunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>*&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
<a name="l00475"></a>00475                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>* error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*)(buf + writtenbytes);
<a name="l00476"></a>00476                     error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a3ba5d36bfe9d3c3b41b6fe6ebb94a87e">type</a> = errorchunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<a name="l00477"></a>00477                     error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a8a289af1659045a9b902cf5c6334fc59">flags</a> = 0;
<a name="l00478"></a><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">00478</a> 
<a name="l00479"></a><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a16df1d45094b56d46256db05ebb39fc3">00479</a>                     <span class="keywordflow">if</span> (errorchunk-&gt;<a class="code" href="class_s_c_t_p_error_chunk.html#a7b3588b447bfe205e5ef507e509e5ff0">getParametersArraySize</a>()&gt;0)
<a name="l00480"></a><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a6b69320aeac29fa21ad450b2104336c1">00480</a>                     {
<a name="l00481"></a><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a7405e47d14a91f6fa6558a25770b94b2">00481</a>                         writtenbytes += size_chunk;
<a name="l00482"></a><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">00482</a>                     }
<a name="l00483"></a>00483                     <span class="keywordflow">else</span>
<a name="l00484"></a>00484                         writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#ab5bfa384fe76de61e158ddde3d148fc4">length</a>);
<a name="l00485"></a><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">00485</a>                     <span class="keywordflow">break</span>;
<a name="l00486"></a><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a69925dfff6d4ce8883b99cfafed2ce27">00486</a>                 }
<a name="l00487"></a><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a99aa72f9aff492e4a5e4447dd0d53e05">00487</a>                 <span class="keywordflow">default</span>:
<a name="l00488"></a><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a022a582b013130ede9f353c628d32b49">00488</a>                     printf(<span class="stringliteral">&quot;Serialize TODO: Implement for outgoing chunk type %d!\n&quot;</span>, chunkType);
<a name="l00489"></a>00489                     <span class="keywordflow">throw</span> <span class="keyword">new</span> cRuntimeError(<span class="stringliteral">&quot;TODO: unknown chunktype in outgoing packet on external interface! Implement it!&quot;</span>);
<a name="l00490"></a>00490                 <span class="comment">// break;</span>
<a name="l00491"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">00491</a> 
<a name="l00492"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a109e8b0a1dcbe8922d54aa7a1e959e33">00492</a>             }
<a name="l00493"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">00493</a> 
<a name="l00494"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a0ab55ad1c1ba0ab2aa4082aed1ccf537">00494</a>             <span class="comment">/*drop(chunk);</span>
<a name="l00495"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a25db3ec53867059f7ffe5b050a43ae14">00495</a> <span class="comment">            delete chunk;*/</span>
<a name="l00496"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a22aace84bd5e2295d4e706a55437cc1d">00496</a> 
<a name="l00497"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a240c6255e13bad8f6a7d41f5ec3559ef">00497</a>         }
<a name="l00498"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a379ae5a1ddc385ee44d98cffd39632ee">00498</a>     <span class="comment">// finally, set the CRC32 checksum field in the SCTP common header</span>
<a name="l00499"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a3747c423ac3fa73c5954351d1e38ded0">00499</a> 
<a name="l00500"></a>00500     <span class="comment">/*sctpEV3&lt;&lt;&quot;srcport=&quot;&lt;&lt;msg-&gt;getSrcPort() &lt;&lt;&quot;destport=&quot;&lt;&lt;msg-&gt;getDestPort() &lt;&lt;&quot;writtenbytes vor checksum=&quot;&lt;&lt;writtenbytes&lt;&lt;&quot;\n&quot;;*/</span>
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">00502</a>     ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = <a class="code" href="class_s_c_t_p_serializer.html#a54e51514d36889c0b02409cb9aae9d3b">checksum</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)ch, writtenbytes);
<a name="l00503"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a9cdebf76f678051b3692f14e6d92aae0">00503</a>     <span class="keywordflow">return</span> writtenbytes;
<a name="l00504"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a8b0d56d06d49b51197d6200cddba834a">00504</a> }
<a name="l00505"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#abec859657533276691154da1930ab359">00505</a> 
<a name="l00506"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a7315d4164cc15995adf0bdec0511af1c">00506</a> uint32 <a class="code" href="class_s_c_t_p_serializer.html#a54e51514d36889c0b02409cb9aae9d3b">SCTPSerializer::checksum</a>(<span class="keyword">const</span> uint8_t *buf, <span class="keyword">register</span> uint32 len)
<a name="l00507"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a54cf1029a7b2d050336e4c76cd197654">00507</a> {
<a name="l00508"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a947a36c02bac8bb6549ad270fe51714e">00508</a>     uint32 h;
<a name="l00509"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ae3094436bd6843ba61ab9b20f44e87f9">00509</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte0, byte1, byte2, byte3;
<a name="l00510"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ad0e25ef59a88465391ed7ed5608f9b70">00510</a>     uint32 crc32c;
<a name="l00511"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a574d759c200094feb71a527d39de1c94">00511</a>     <span class="keyword">register</span> uint32 i;
<a name="l00512"></a>00512     <span class="keyword">register</span> uint32 res = (~0L);
<a name="l00513"></a>00513     <span class="keywordflow">for</span> (i = 0; i &lt; len; i++)
<a name="l00514"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">00514</a>       <a class="code" href="sctp_8h.html#ad3af2094050495f1c8c0857d9fd97813">CRC32C</a>(res, buf[i]);
<a name="l00515"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a0b3250c76a08f6fa3363814b5f91f25c">00515</a>     h      = ~res;
<a name="l00516"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a4d70902b4a99a5b76947b077effe19a4">00516</a>     byte0  = h &amp; 0xff;
<a name="l00517"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a8c48ee6a532fe3294acbb64acee05184">00517</a>     byte1  = (h&gt;&gt;8) &amp; 0xff;
<a name="l00518"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a7a54bd2ed88345cdb5c902f56bc8d3c7">00518</a>     byte2  = (h&gt;&gt;16) &amp; 0xff;
<a name="l00519"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#aa95033ee21e5290df42be51a8b696679">00519</a>     byte3  = (h&gt;&gt;24) &amp; 0xff;
<a name="l00520"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af32685d03e6d9489916b3e6824261ac5">00520</a>     crc32c = ((byte0 &lt;&lt; 24) | (byte1 &lt;&lt; 16) | (byte2 &lt;&lt; 8) | byte3);
<a name="l00521"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af18c98e1baef7393f88d5141b17e0c91">00521</a>     <span class="keywordflow">return</span> htonl(crc32c);
<a name="l00522"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af9294b9a9ff18b46973e93b122b74413">00522</a> }
<a name="l00523"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a41f0c942c00df414bce98cea3a93ef7d">00523</a> 
<a name="l00524"></a>00524 <span class="keywordtype">void</span> <a class="code" href="class_s_c_t_p_serializer.html#a6f98120b3c9485fab42e24b9ab455b88">SCTPSerializer::parse</a>(<span class="keyword">const</span> uint8_t *buf, uint32 bufsize, <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *dest)
<a name="l00525"></a>00525 {
<a name="l00526"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">00526</a>     int32 size_common_header = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>);
<a name="l00527"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a82a5148eb8f2d054a93bc15b01f90ed0">00527</a>     int32 size_init_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>);
<a name="l00528"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a1db99d729c62fab4c73713b4859ddb7e">00528</a>     int32 size_init_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>);
<a name="l00529"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a00b437d0173221e4f0962cecaafbe7e9">00529</a>     int32 size_data_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>);
<a name="l00530"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a561d6bef13b80381e25a0712b3b283a0">00530</a>     int32 size_sack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>);
<a name="l00531"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a9d989ff6f677f8d5afcbbe2d73ece439">00531</a>     int32 size_heartbeat_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>);
<a name="l00532"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#addf4a98ed2d76970afe2a63340a95f00">00532</a>     int32 size_heartbeat_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>);
<a name="l00533"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a36b9ecced9fc135bc8906b8d5a58c7ed">00533</a>     int32 size_abort_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>);
<a name="l00534"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a2bd969342983c52a6ee459f819b8c820">00534</a>     int32 size_cookie_echo_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a>);
<a name="l00535"></a>00535     uint16 paramType;
<a name="l00536"></a>00536     int32 parptr, chunklen, cLen, woPadding;
<a name="l00537"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">00537</a>     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> *<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> = (<span class="keyword">struct </span>common_header*) (buf);
<a name="l00538"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a024a36abc0874b6ec935c82aa1c09e45">00538</a>     int32 tempChecksum = common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a>;
<a name="l00539"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a90eda309e3081f402b0fcbd7cb2b4ee9">00539</a>     common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = 0;
<a name="l00540"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a4417dfe66d15d64507e259dc533adead">00540</a>     int32 chksum = <a class="code" href="class_s_c_t_p_serializer.html#a54e51514d36889c0b02409cb9aae9d3b">checksum</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)common_header, bufsize);
<a name="l00541"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a9cfa3ce0d55977ae1e05c3912ca0c754">00541</a>     common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = tempChecksum;
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chunks = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) (buf + size_common_header);
<a name="l00544"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">00544</a>     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTPSerializer::parse SCTPMessage\n&quot;</span>;
<a name="l00545"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#aaef8cb3cb98d2936416619092e1409de">00545</a>     <span class="keywordflow">if</span> (tempChecksum == chksum)
<a name="l00546"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#a40e6a8bc2b1429b5ed0507e5e131051c">00546</a>         dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a26c061cd614d7e818c3f727e0f41bdd8">setChecksumOk</a>(<span class="keyword">true</span>);
<a name="l00547"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#af05e4e0ce777bc2ce5272709d26bfb1e">00547</a>     <span class="keywordflow">else</span>
<a name="l00548"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#a5f854dc5bc74f201f4ff525663242502">00548</a>         dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a26c061cd614d7e818c3f727e0f41bdd8">setChecksumOk</a>(<span class="keyword">false</span>);
<a name="l00549"></a>00549     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;checksumOK=&quot;</span>&lt;&lt;dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a910312a024d42e851fd60799bf76606f">getChecksumOk</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00550"></a>00550     dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a1fc28c5f3b3ff6c808d254b1db9e46f8">setSrcPort</a>(ntohs(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a16df1d45094b56d46256db05ebb39fc3">source_port</a>));
<a name="l00551"></a><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">00551</a>     dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a6944d6ac97e5afa1960a682638881a1b">setDestPort</a>(ntohs(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a6b69320aeac29fa21ad450b2104336c1">destination_port</a>));
<a name="l00552"></a><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#afd7b4ac79c01f4f7daf23664cd483832">00552</a>     dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#aab816f025dd8a85ce2603e161a5afced">setTag</a>(ntohl(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a7405e47d14a91f6fa6558a25770b94b2">verification_tag</a>));
<a name="l00553"></a><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#af7c6588f89c568b6ca8dcf40cb32daf7">00553</a>     dest-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a5cd94d6b80cfc4869b11f345c9de4d93">SCTP_COMMON_HEADER</a>*8);
<a name="l00554"></a><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#ac0550cef90bd35ba1bf8430ee783743d">00554</a>     <span class="comment">// chunks</span>
<a name="l00555"></a><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#a233058ac9e068b3c140312abdf399b36">00555</a>     uint32 chunkPtr = 0;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     <span class="comment">// catch ALL chunks - when a chunk is taken, the chunkPtr is set to the next chunk</span>
<a name="l00558"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">00558</a>     <span class="keywordflow">while</span>(chunkPtr &lt; (bufsize - size_common_header))
<a name="l00559"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#af51d4366e493acaeda6614987c7572ac">00559</a>     {
<a name="l00560"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a8c11a5e6bce33753bede20be4116b3a9">00560</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> * <a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> = (<span class="keyword">struct </span>chunk*)(chunks + chunkPtr);
<a name="l00561"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a3ec4f8285d54892e78ec52507e542f96">00561</a>         int32 chunkType = chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a69925dfff6d4ce8883b99cfafed2ce27">type</a>;
<a name="l00562"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a294183dee80de069c3e9583ff376b791">00562</a> <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;chunkType=&quot;</span>&lt;&lt;chunkType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00563"></a>00563         woPadding = ntohs(chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a022a582b013130ede9f353c628d32b49">length</a>);
<a name="l00564"></a>00564 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;chunk-&gt;length=&quot;</span>&lt;&lt;ntohs(chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a022a582b013130ede9f353c628d32b49">length</a>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00565"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html">00565</a>         cLen = <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(woPadding);
<a name="l00566"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#ae746b496e56ae3c2b8855f7ef4f04975">00566</a>         <span class="keywordflow">switch</span>(chunkType)
<a name="l00567"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#afff3afbebbb06fd240b35d60ace74571">00567</a>         {
<a name="l00568"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#a5bb998c2808be3907aa9b5475b1c56ce">00568</a>             <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#ad70ed57eb996b190fc586f309107250ea9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
<a name="l00569"></a>00569             {
<a name="l00570"></a>00570                 ev&lt;&lt;<span class="stringliteral">&quot;Data received\n&quot;</span>;
<a name="l00571"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">00571</a>                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a> *dc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>*) (chunks + chunkPtr);
<a name="l00572"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a8f6c99af679dd511647d2747bf0a630d">00572</a>                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;cLen=&quot;</span>&lt;&lt;cLen&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00573"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a234c2bbc04b3655058a07315144f5dc8">00573</a>                 <span class="keywordflow">if</span>(cLen == 0)
<a name="l00574"></a><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a81f2f464f168ed2650f5cf162ba95072">00574</a>                     <span class="keywordflow">throw</span> <span class="keyword">new</span> cRuntimeError(<span class="stringliteral">&quot;Incoming SCTP packet contains data chunk with length==0&quot;</span>);
<a name="l00575"></a>00575                 <a class="code" href="class_s_c_t_p_data_chunk.html">SCTPDataChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_data_chunk.html">SCTPDataChunk</a>(<span class="stringliteral">&quot;DATA&quot;</span>);
<a name="l00576"></a>00576                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00577"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">00577</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a4a2128891da44ca9bbc49f528e6d6a64">setUBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; <a class="code" href="sctp_8h.html#a5d2f622082102fd699ac9d0bee5d58eb">UNORDERED_BIT</a>);
<a name="l00578"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aacca81a316c96b6a54ea6d7d6daedc97">00578</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a724fc911f9474506e538493de69b5b44">setBBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; <a class="code" href="sctp_8h.html#a138a317c166a9972907b7d1543a56398">BEGIN_BIT</a>);
<a name="l00579"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#a88961a5a30664c689c92ef91d1e20428">00579</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#ad08b849c2f66737004073fcf9489ea9f">setEBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; <a class="code" href="sctp_8h.html#a49f85dedca778ecc4208f7c9cf5f9ca7">END_BIT</a>);
<a name="l00580"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#a952814830fb2a5568b7a0b540ae8841e">00580</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#ac09fbff350bda6bb9ce90e542ca5f0f6">setTsn</a>(ntohl(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a25db3ec53867059f7ffe5b050a43ae14">tsn</a>));
<a name="l00581"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aef00e45b7a6273712cb7c75b4b459c10">00581</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a5bd268fa40efdc716554009a846cde54">setSid</a>(ntohs(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a22aace84bd5e2295d4e706a55437cc1d">sid</a>));
<a name="l00582"></a>00582                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#ad1875b29fb9b29fafe0b7e0c8e00e16d">setSsn</a>(ntohs(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a240c6255e13bad8f6a7d41f5ec3559ef">ssn</a>));
<a name="l00583"></a>00583                 chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#ae2f2910e3d5d92db00b1e83f48075830">setPpid</a>(ntohl(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a379ae5a1ddc385ee44d98cffd39632ee">ppi</a>));
<a name="l00584"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html">00584</a>                 chunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#aad0be78d1352b9d9fa6a695ed18c9d65">SCTP_DATA_CHUNK_LENGTH</a>*8);
<a name="l00585"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a908232d2d65b3f327c8a8e7712f0ed2c">00585</a>                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;parse data: woPadding=&quot;</span>&lt;&lt;woPadding&lt;&lt;<span class="stringliteral">&quot; size_data_chunk=&quot;</span>&lt;&lt;size_data_chunk&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00586"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#afcb556602ae372c14aafb8f76d6e90f0">00586</a>                 <span class="keywordflow">if</span>(woPadding &gt; size_data_chunk)
<a name="l00587"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a95acfc6cbf8dfc2f783f2523f071f7f7">00587</a>                 {
<a name="l00588"></a>00588                     <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>* msg=<span class="keyword">new</span> <a class="code" href="class_s_c_t_p_simple_message.html">SCTPSimpleMessage</a>(<span class="stringliteral">&quot;data&quot;</span>);
<a name="l00589"></a>00589                     int32 datalen = (woPadding - size_data_chunk);
<a name="l00590"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">00590</a>                     msg-&gt;setBitLength(datalen*8);
<a name="l00591"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a3ba5d36bfe9d3c3b41b6fe6ebb94a87e">00591</a>                     msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a630c1edca53781533d0f8a04a39ab0e1">setDataLen</a>(datalen);
<a name="l00592"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a8a289af1659045a9b902cf5c6334fc59">00592</a>                     msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a19267ba50e2bce996b9290544b436477">setDataArraySize</a>(datalen);
<a name="l00593"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#ab5bfa384fe76de61e158ddde3d148fc4">00593</a>                     <span class="keywordflow">for</span>(int32 i=0; i&lt;datalen; i++)
<a name="l00594"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a5fe24450008ac675af67db68daf82943">00594</a>                         msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#aac4ab53c4235fd4ee9df1ae47769382d">setData</a>(i, dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a3747c423ac3fa73c5954351d1e38ded0">user_data</a>[i]);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596                     chunk-&gt;encapsulate(msg);
<a name="l00597"></a>00597                 }
<a name="l00598"></a>00598                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;datachunkLength=&quot;</span>&lt;&lt;chunk-&gt;getBitLength()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00599"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a42777cc0d8e665b540eb6edc1ee831dd">00599</a>                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00600"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a5e8308210ed9cdacf7346535647bbb00">00600</a>                 <span class="keywordflow">break</span>;
<a name="l00601"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a34127e7f145642fb19969a905c0511dc">00601</a>             }
<a name="l00602"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a19e00fdb6119cefd4b310c27a117739f">00602</a>             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
<a name="l00603"></a>00603             {
<a name="l00604"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">00604</a>                 ev&lt;&lt;<span class="stringliteral">&quot;parse INIT\n&quot;</span>;
<a name="l00605"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#ae6f54209bc788f8225512e9caf290da0">00605</a>                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> *<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> = (<span class="keyword">struct </span>init_chunk*) (chunks + chunkPtr); <span class="comment">// (recvBuffer + size_ip + size_common_header);</span>
<a name="l00606"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a823367d591586e1469d57df9a3278d30">00606</a>                 chunklen = <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>;
<a name="l00607"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">00607</a>                 <a class="code" href="class_s_c_t_p_init_chunk.html">SCTPInitChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_init_chunk.html">SCTPInitChunk</a>(<span class="stringliteral">&quot;INIT&quot;</span>);
<a name="l00608"></a>00608                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00609"></a>00609                 chunk-&gt;setName(<span class="stringliteral">&quot;INIT&quot;</span>);
<a name="l00610"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">00610</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ad413c763401283e0242464a9fa86c0ac">setInitTag</a>(ntohl(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a7315d4164cc15995adf0bdec0511af1c">initiate_tag</a>));
<a name="l00611"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#ac3b7deceb526226f1d728d58d9e66ecd">00611</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a896799a07b82f91211161a5b75c6ef85">setA_rwnd</a>(ntohl(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a54cf1029a7b2d050336e4c76cd197654">a_rwnd</a>));
<a name="l00612"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#af00833badde3e5afe2d0d99d734f59d4">00612</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#aa4436dd2441ff6906064de5cc084d3a8">setNoOutStreams</a>(ntohs(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a947a36c02bac8bb6549ad270fe51714e">mos</a>));
<a name="l00613"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">00613</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#aac06e82e38763b50c4e681a1f1ec60d3">setNoInStreams</a>(ntohs(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ae3094436bd6843ba61ab9b20f44e87f9">mis</a>));
<a name="l00614"></a>00614                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#af322f2b11a006a292f845ad6c8acdbbe">setInitTSN</a>(ntohl(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ad0e25ef59a88465391ed7ed5608f9b70">initial_tsn</a>));
<a name="l00615"></a>00615                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(0);
<a name="l00616"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html">00616</a>                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a8016aa2e43011981afe3029692d2708a">setUnrecognizedParametersArraySize</a>(0);
<a name="l00617"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a14e5be998afe475f8ff332622f3bfc5f">00617</a>                 <span class="comment">//sctpEV3&lt;&lt;&quot;INIT arrived from wire\n&quot;;</span>
<a name="l00618"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aca52f335a966cd309357456ebdffdd73">00618</a>                 <span class="keywordflow">if</span>(cLen &gt; size_init_chunk)
<a name="l00619"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aebe858a7bbcb4e6993ce77152b5fdd2a">00619</a>                 {
<a name="l00620"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#ab2cae663323b64da289760e11bf97a29">00620</a>                     int32 parcounter = 0, addrcounter = 0;
<a name="l00621"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#af89b5edd30a497adb8d1236173653c16">00621</a>                     parptr = 0;
<a name="l00622"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aa289cc30d97125318f42cb82346cb042">00622</a>                     <span class="keywordtype">bool</span> stopProcessing = <span class="keyword">false</span>;
<a name="l00623"></a><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a4ef1c054d13571f1aa5c827596f18989">00623</a>                     <span class="keywordflow">while</span>(cLen &gt; size_init_chunk+parptr &amp;&amp; !stopProcessing)
<a name="l00624"></a>00624                     {
<a name="l00625"></a>00625                         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Process INIT parameters\n&quot;</span>;
<a name="l00626"></a>00626                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *parameter = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*)(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
<a name="l00627"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">00627</a>                         paramType = ntohs(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a>);
<a name="l00628"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a96b0f36a38c9886943c75ba5b29c0ef0">00628</a>                         <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;search for param &quot;</span>&lt;&lt;paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00629"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a023a4299beb2cfb28dd2ef1dfd0478c7">00629</a>                         <span class="keywordflow">switch</span> (paramType)
<a name="l00630"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a648153b48ec8424e1f72ff921b8a644d">00630</a>                         {
<a name="l00631"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#ad99c0071b11d8dfd434ec386226611f7">00631</a>                             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1af17cc3bab233e3bca306ffc579984acc">SUPPORTED_ADDRESS_TYPES</a>:
<a name="l00632"></a><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a34286a6e985ef4527a947f4199333dc0">00632</a>                             {
<a name="l00633"></a>00633                                 <span class="keywordflow">break</span>;
<a name="l00634"></a>00634                             }
<a name="l00635"></a>00635                             <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>:
<a name="l00636"></a><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">00636</a>                             {
<a name="l00637"></a><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">00637</a>                                 <span class="comment">// we supppose an ipv4 address parameter</span>
<a name="l00638"></a><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">00638</a>                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv4\n&quot;</span>;
<a name="l00639"></a><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">00639</a>                                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *v4addr;
<a name="l00640"></a>00640                                 v4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
<a name="l00641"></a>00641                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(++addrcounter);
<a name="l00642"></a>00642                                 <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> *localv4Addr;
<a name="l00643"></a><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">00643</a>                                 localv4Addr = <span class="keyword">new</span> <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>);
<a name="l00644"></a><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a149ee2f7dad36d74724e488903940246">00644</a>                                 localv4Addr-&gt;<a class="code" href="class_i_pv_x_address.html#a723c95dd39fbdc72118f03eb386086fb">set</a>(ntohl(v4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a>));
<a name="l00645"></a><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a51610238a939c7fd088bf7a795d70357">00645</a>                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a707d281ddcd2d9ad1cf9c83e507fedc9">setAddresses</a>(addrcounter-1, *localv4Addr);
<a name="l00646"></a><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a11dffde51b23deb764cd03e2f340db26">00646</a>                                 chunklen += 8;
<a name="l00647"></a>00647                                 <span class="keywordflow">break</span>;
<a name="l00648"></a>00648                             }
<a name="l00649"></a>00649                             <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a5e8308210ed9cdacf7346535647bbb00">INIT_PARAM_IPV6</a>:
<a name="l00650"></a>00650                             {
<a name="l00651"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">00651</a>                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv6\n&quot;</span>;
<a name="l00652"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">00652</a>                                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a> *ipv6addr;
<a name="l00653"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">00653</a>                                 ipv6addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
<a name="l00654"></a>00654                                 <a class="code" href="class_i_pv6_address.html">IPv6Address</a> ipv6Addr = <a class="code" href="class_i_pv6_address.html">IPv6Address</a>(ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[0], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[1],
<a name="l00655"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#ad47607b168dc49b53a70d77bbb632564">00655</a>                                                                     ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[2], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[3]);
<a name="l00656"></a>00656                                 <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> *localv6Addr;
<a name="l00657"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a258d7045a07b119c7a9c582c657042d1">00657</a>                                 localv6Addr = <span class="keyword">new</span> <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(<span class="stringliteral">&quot;0:0:0:0:0:0:0:0&quot;</span>);
<a name="l00658"></a><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a83993d08fbdd2a9773aae936e55c631d">00658</a>                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;address&quot;</span>&lt;&lt;ipv6Addr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00659"></a>00659                                 localv6Addr-&gt;<a class="code" href="class_i_pv_x_address.html#a723c95dd39fbdc72118f03eb386086fb">set</a>(ipv6Addr);
<a name="l00660"></a>00660                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(++addrcounter);
<a name="l00661"></a>00661                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a707d281ddcd2d9ad1cf9c83e507fedc9">setAddresses</a>(addrcounter-1, *localv6Addr);
<a name="l00662"></a>00662                                 chunklen += 20;
<a name="l00663"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a35a07f4d1137779b208b608ac62f7561">00663</a>                                 <span class="keywordflow">break</span>;
<a name="l00664"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#aed9342dc5ddcea1e525b7b449fab35a3">00664</a>                             }
<a name="l00665"></a><a class="code" href="_s_c_t_p_serializer_8cc.html#a350cf5878ce2f8cb42cca735e0f99c1d">00665</a>                             <span class="keywordflow">default</span>:
<a name="l00666"></a>00666                             {
<a name="l00667"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__cause.html">00667</a>                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;ExtInterface: Unknown SCTP INIT parameter type &quot;</span> &lt;&lt; paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00668"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__cause.html#ab4f60e84cc5d646726d5eabfc2fd8d92">00668</a>                                 uint16 skip = (paramType &amp; 0x8000) &gt;&gt; 15;
<a name="l00669"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__cause.html#a78866bd0dbaf4d4c3652fda6362d04ce">00669</a>                                 <span class="keywordflow">if</span> (skip == 0)
<a name="l00670"></a><a class="code" href="struct_i_n_e_t_fw_1_1error__cause.html#a9e7677d29ccdd69535fff27c181e7450">00670</a>                                     stopProcessing = <span class="keyword">true</span>;
<a name="l00671"></a>00671                                 uint16 report = (paramType &amp; 0x4000) &gt;&gt; 14;
<a name="l00672"></a>00672                                 <span class="keywordflow">if</span> (report != 0)
<a name="l00673"></a>00673                                 {
<a name="l00674"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">00674</a>                                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *unknown;
<a name="l00675"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#a06092a86c2ef2a22d5412e2d7096563f">00675</a>                                     unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
<a name="l00676"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#aff0a1d1c21dd6d36e7b0fff135c93e23">00676</a>                                     uint32 unknownLen=chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a823a5de4117c53aae7d59244b02c6e63">getUnrecognizedParametersArraySize</a>();
<a name="l00677"></a>00677                                     chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a8016aa2e43011981afe3029692d2708a">setUnrecognizedParametersArraySize</a>(unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)));
<a name="l00678"></a>00678                                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>* dv = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
<a name="l00679"></a>00679 
<a name="l00680"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">00680</a>                                     <span class="keywordflow">for</span> (uint32 i=unknownLen; i&lt;unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)); i++)
<a name="l00681"></a><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html#a264c16210059305d5716d62f3f44366e">00681</a>                                         chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a83c32d36bc24c93e465fc1d58c29d270">setUnrecognizedParameters</a>(i,dv-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html#afde96dce63b62a4c06a7deb55600afff">data</a>[i-unknownLen]);
<a name="l00682"></a>00682                                 }
<a name="l00683"></a>00683                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;stopProcessing=&quot;</span>&lt;&lt;stopProcessing&lt;&lt;<span class="stringliteral">&quot; report=&quot;</span>&lt;&lt;report&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00684"></a>00684                                 <span class="keywordflow">break</span>;
<a name="l00685"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">00685</a>                             }
<a name="l00686"></a><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html#afde96dce63b62a4c06a7deb55600afff">00686</a>                         }
<a name="l00687"></a>00687                         parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>));
<a name="l00688"></a>00688                         parcounter++;
<a name="l00689"></a>00689                     }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 
<a name="l00692"></a>00692                 }
<a name="l00693"></a>00693                 chunk-&gt;setBitLength(chunklen*8);
<a name="l00694"></a>00694                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00695"></a>00695                 <span class="comment">//chunkPtr += cLen;</span>
<a name="l00696"></a>00696                 <span class="keywordflow">break</span>;
<a name="l00697"></a>00697             }
<a name="l00698"></a>00698             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
<a name="l00699"></a>00699             {
<a name="l00700"></a>00700                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a> *iac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>*) (chunks + chunkPtr);
<a name="l00701"></a>00701                 chunklen = <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>;
<a name="l00702"></a>00702                 <a class="code" href="class_s_c_t_p_init_ack_chunk.html">SCTPInitAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_init_ack_chunk.html">SCTPInitAckChunk</a>(<span class="stringliteral">&quot;INIT_ACK&quot;</span>);
<a name="l00703"></a>00703                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00704"></a>00704                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a2ef9485a254b97e0306b3f638cb18dfa">setInitTag</a>(ntohl(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a7a54bd2ed88345cdb5c902f56bc8d3c7">initiate_tag</a>));
<a name="l00705"></a>00705                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aca89e11d23aba5c9ea06e7bce8e3b652">setA_rwnd</a>(ntohl(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#aa95033ee21e5290df42be51a8b696679">a_rwnd</a>));
<a name="l00706"></a>00706                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a45f3f8ab1fae8c1bbc9879ed5b13db1f">setNoOutStreams</a>(ntohs(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af32685d03e6d9489916b3e6824261ac5">mos</a>));
<a name="l00707"></a>00707                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ace45ebfc454e4ac5867e7febaee16a22">setNoInStreams</a>(ntohs(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af18c98e1baef7393f88d5141b17e0c91">mis</a>));
<a name="l00708"></a>00708                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a24cf153a309a88d3c6fdb6ea11256ff9">setInitTSN</a>(ntohl(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af9294b9a9ff18b46973e93b122b74413">initial_tsn</a>));
<a name="l00709"></a>00709                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ae7750b4f43ce1ba6d61af64d3ff27501">setUnrecognizedParametersArraySize</a>(0);
<a name="l00710"></a>00710                 <span class="keywordflow">if</span>(cLen &gt; size_init_ack_chunk)
<a name="l00711"></a>00711                 {
<a name="l00712"></a>00712                     int32 parcounter = 0, addrcounter = 0;
<a name="l00713"></a>00713                     parptr = 0;
<a name="l00714"></a>00714                     <span class="keywordtype">bool</span> stopProcessing = <span class="keyword">false</span>;
<a name="l00715"></a>00715                     <span class="comment">//sctpEV3&lt;&lt;&quot;cLen=&quot;&lt;&lt;cLen&lt;&lt;&quot;\n&quot;;</span>
<a name="l00716"></a>00716                     <span class="keywordflow">while</span>(cLen &gt; size_init_ack_chunk+parptr &amp;&amp; !stopProcessing)
<a name="l00717"></a>00717                     {
<a name="l00718"></a>00718                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *parameter = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*)(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
<a name="l00719"></a>00719                         paramType = ntohs(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a>);
<a name="l00720"></a>00720                         <span class="comment">//sctpEV3&lt;&lt;&quot;ParamType = &quot;&lt;&lt;paramType&lt;&lt;&quot; parameterLength=&quot;&lt;&lt;ntohs(parameter-&gt;length)&lt;&lt;&quot;\n&quot;;</span>
<a name="l00721"></a>00721                         <span class="keywordflow">switch</span> (paramType)
<a name="l00722"></a>00722                         {
<a name="l00723"></a>00723                             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1af17cc3bab233e3bca306ffc579984acc">SUPPORTED_ADDRESS_TYPES</a>:
<a name="l00724"></a>00724                             {
<a name="l00725"></a>00725                                 <span class="keywordflow">break</span>;
<a name="l00726"></a>00726                             }
<a name="l00727"></a>00727                             <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>:
<a name="l00728"></a>00728                             {
<a name="l00729"></a>00729                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;parse IPv4\n&quot;</span>;
<a name="l00730"></a>00730                                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *v4addr;
<a name="l00731"></a>00731                                 v4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
<a name="l00732"></a>00732                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad70d5abe980530ad3acbf9cbcf419a8a">setAddressesArraySize</a>(++addrcounter);
<a name="l00733"></a>00733                                 <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> *localv4Addr;
<a name="l00734"></a>00734                                 localv4Addr = <span class="keyword">new</span> <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>);
<a name="l00735"></a>00735                                 localv4Addr-&gt;<a class="code" href="class_i_pv_x_address.html#a723c95dd39fbdc72118f03eb386086fb">set</a>(ntohl(v4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a>));
<a name="l00736"></a>00736                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#abac0eafe21562f7220b308e952763cf4">setAddresses</a>(addrcounter-1, *localv4Addr);
<a name="l00737"></a>00737                                 chunklen += 8;
<a name="l00738"></a>00738                                 <span class="keywordflow">break</span>;
<a name="l00739"></a>00739                             }
<a name="l00740"></a>00740                             <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a5e8308210ed9cdacf7346535647bbb00">INIT_PARAM_IPV6</a>:
<a name="l00741"></a>00741                             {
<a name="l00742"></a>00742                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv6\n&quot;</span>;
<a name="l00743"></a>00743                                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a> *ipv6addr;
<a name="l00744"></a>00744                                 ipv6addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_chunk + parptr);
<a name="l00745"></a>00745                                 <a class="code" href="class_i_pv6_address.html">IPv6Address</a> ipv6Addr = <a class="code" href="class_i_pv6_address.html">IPv6Address</a>(ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[0], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[1],
<a name="l00746"></a>00746                                                                     ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[2], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[3]);
<a name="l00747"></a>00747                                 <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> *localv6Addr;
<a name="l00748"></a>00748                                 localv6Addr = <span class="keyword">new</span> <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(<span class="stringliteral">&quot;0:0:0:0:0:0:0:0&quot;</span>);
<a name="l00749"></a>00749                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;address&quot;</span>&lt;&lt;ipv6Addr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00750"></a>00750                                 localv6Addr-&gt;<a class="code" href="class_i_pv_x_address.html#a723c95dd39fbdc72118f03eb386086fb">set</a>(ipv6Addr);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad70d5abe980530ad3acbf9cbcf419a8a">setAddressesArraySize</a>(++addrcounter);
<a name="l00753"></a>00753                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#abac0eafe21562f7220b308e952763cf4">setAddresses</a>(addrcounter-1, *localv6Addr);
<a name="l00754"></a>00754                                 chunklen += 20;
<a name="l00755"></a>00755                                 <span class="keywordflow">break</span>;
<a name="l00756"></a>00756                             }
<a name="l00757"></a>00757                             <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a34127e7f145642fb19969a905c0511dc">INIT_PARAM_COOKIE</a>:
<a name="l00758"></a>00758                             {
<a name="l00759"></a>00759                                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
<a name="l00760"></a>00760                                 int32 cookieLen = ntohs(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>) - 4;
<a name="l00761"></a>00761                                 <span class="comment">// put cookie data into chunk (char array cookie)</span>
<a name="l00762"></a>00762                                 chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aacea71bb3621de42025d61f5b7db987d">setCookieArraySize</a>(cookieLen);
<a name="l00763"></a>00763                                 <span class="keywordflow">for</span>(int32 i=0; i&lt;cookieLen; i++)
<a name="l00764"></a>00764                                     chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a35269ef38a24bd740441e36e0a4c08b3">setCookie</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i]);
<a name="l00765"></a>00765                                 chunklen+=cookieLen+4;
<a name="l00766"></a>00766                                 <span class="keywordflow">break</span>;
<a name="l00767"></a>00767                             }
<a name="l00768"></a>00768                             <span class="keywordflow">default</span>:
<a name="l00769"></a>00769                             {
<a name="l00770"></a>00770                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;ExtInterface: Unknown SCTP INIT-ACK parameter type &quot;</span> &lt;&lt; paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00771"></a>00771                                 uint16 skip = (paramType &amp; 0x8000) &gt;&gt; 15;
<a name="l00772"></a>00772                                 <span class="keywordflow">if</span> (skip == 0)
<a name="l00773"></a>00773                                     stopProcessing = <span class="keyword">true</span>;
<a name="l00774"></a>00774                                 uint16 report = (paramType &amp; 0x4000) &gt;&gt; 14;
<a name="l00775"></a>00775                                 <span class="keywordflow">if</span> (report != 0)
<a name="l00776"></a>00776                                 {
<a name="l00777"></a>00777                                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *unknown;
<a name="l00778"></a>00778                                     unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
<a name="l00779"></a>00779                                     uint32 unknownLen=chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a782f1937ded9a07b427f13c9a6a22330">getUnrecognizedParametersArraySize</a>();
<a name="l00780"></a>00780                                     chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ae7750b4f43ce1ba6d61af64d3ff27501">setUnrecognizedParametersArraySize</a>(unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)));
<a name="l00781"></a>00781                                     <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>* dv = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783                                     <span class="keywordflow">for</span> (uint32 i=unknownLen; i&lt;unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)); i++)
<a name="l00784"></a>00784                                         chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a68185c5126d620ce5aa51c015fb3ff53">setUnrecognizedParameters</a>(i,dv-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html#afde96dce63b62a4c06a7deb55600afff">data</a>[i-unknownLen]);
<a name="l00785"></a>00785                                 }
<a name="l00786"></a>00786                                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;stopProcessing=&quot;</span>&lt;&lt;stopProcessing&lt;&lt;<span class="stringliteral">&quot;  report=&quot;</span>&lt;&lt;report&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00787"></a>00787 
<a name="l00788"></a>00788                                 <span class="keywordflow">break</span>;
<a name="l00789"></a>00789                             }
<a name="l00790"></a>00790                         }
<a name="l00791"></a>00791                         parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>));
<a name="l00792"></a>00792                         <span class="comment">//sctpEV3&lt;&lt;&quot;parptr=&quot;&lt;&lt;parptr&lt;&lt;&quot;\n&quot;;</span>
<a name="l00793"></a>00793                         parcounter++;
<a name="l00794"></a>00794                     }
<a name="l00795"></a>00795                 }
<a name="l00796"></a>00796                 chunk-&gt;setBitLength(chunklen*8);
<a name="l00797"></a>00797                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00798"></a>00798                 <span class="keywordflow">break</span>;
<a name="l00799"></a>00799             }
<a name="l00800"></a>00800             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
<a name="l00801"></a>00801             {
<a name="l00802"></a>00802                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: SACK received\n&quot;</span>;
<a name="l00803"></a>00803                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>*) (chunks + chunkPtr);
<a name="l00804"></a>00804                 <a class="code" href="class_s_c_t_p_sack_chunk.html">SCTPSackChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_sack_chunk.html">SCTPSackChunk</a>(<span class="stringliteral">&quot;SACK&quot;</span>);
<a name="l00805"></a>00805                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00806"></a>00806                 uint32 cumtsnack = ntohl(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a561d6bef13b80381e25a0712b3b283a0">cum_tsn_ack</a>);
<a name="l00807"></a>00807                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a661bfb2fc7e65577d5e0ea4d4024fc0c">setCumTsnAck</a>(cumtsnack);
<a name="l00808"></a>00808                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a085f19b284ea983d325e5a7faa11f76d">setA_rwnd</a>(ntohl(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a9d989ff6f677f8d5afcbbe2d73ece439">a_rwnd</a>));
<a name="l00809"></a>00809 
<a name="l00810"></a>00810                 int32 ngaps = ntohs(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#addf4a98ed2d76970afe2a63340a95f00">nr_of_gaps</a>);
<a name="l00811"></a>00811                 int32 ndups = ntohs(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a36b9ecced9fc135bc8906b8d5a58c7ed">nr_of_dups</a>);
<a name="l00812"></a>00812                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#adc2388671bfa383ace94cd5808655d20">setNumGaps</a>(ngaps);
<a name="l00813"></a>00813                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#ac5fde6fc9369911804fcf31c3e56bb9d">setNumDupTsns</a>(ndups);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aa22cbec49f7fc2ff0aadaabd28e4c6b1">setGapStartArraySize</a>(ngaps);
<a name="l00816"></a>00816                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a0d448534ac6ccbc9b4f8b57a8d522d43">setGapStopArraySize</a>(ngaps);
<a name="l00817"></a>00817                 chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a31719ebfeea4149c98eec8da38013b0a">setDupTsnsArraySize</a>(ndups);
<a name="l00818"></a>00818 
<a name="l00819"></a>00819                 <span class="keywordflow">for</span>(int32 i=0; i&lt;ngaps; i++)
<a name="l00820"></a>00820                 {
<a name="l00821"></a>00821                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a> *gap = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)sac) + size_sack_chunk + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>));
<a name="l00822"></a>00822                     chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a3bcf99f5bb06d8af50dd839129bbbba3">setGapStart</a>(i, ntohs(gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#a06092a86c2ef2a22d5412e2d7096563f">start</a>) + cumtsnack);
<a name="l00823"></a>00823                     chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#acd6f0a88517c2a66b1f70b3bacd39e4c">setGapStop</a>(i, ntohs(gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#aff0a1d1c21dd6d36e7b0fff135c93e23">stop</a>) + cumtsnack);
<a name="l00824"></a>00824                 }
<a name="l00825"></a>00825                 <span class="keywordflow">for</span>(int32 i=0; i&lt;ndups; i++)
<a name="l00826"></a>00826                 {
<a name="l00827"></a>00827                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a> *dup = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)sac) + size_sack_chunk + ngaps*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>) + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>));
<a name="l00828"></a>00828                     chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a201a3b224021e5b1d01be8b067a9d039">setDupTsns</a>(i, ntohl(dup-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html#a264c16210059305d5716d62f3f44366e">tsn</a>));
<a name="l00829"></a>00829                 }
<a name="l00830"></a>00830 
<a name="l00831"></a>00831                 chunk-&gt;setBitLength(cLen*8);
<a name="l00832"></a>00832                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00833"></a>00833                 <span class="keywordflow">break</span>;
<a name="l00834"></a>00834             }
<a name="l00835"></a>00835             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
<a name="l00836"></a>00836             {
<a name="l00837"></a>00837                 <span class="comment">//sctpEV3&lt;&lt;&quot;SCTPMessage: Heartbeat received\n&quot;;</span>
<a name="l00838"></a>00838                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a> *hbc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>*) (chunks + chunkPtr);
<a name="l00839"></a>00839                 <a class="code" href="class_s_c_t_p_heartbeat_chunk.html">SCTPHeartbeatChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_heartbeat_chunk.html">SCTPHeartbeatChunk</a>(<span class="stringliteral">&quot;HEARTBEAT&quot;</span>);
<a name="l00840"></a>00840                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00841"></a>00841                 <span class="keywordflow">if</span>(cLen &gt; size_heartbeat_chunk)
<a name="l00842"></a>00842                 {
<a name="l00843"></a>00843                     int32 parcounter = 0;
<a name="l00844"></a>00844                     parptr = 0;
<a name="l00845"></a>00845                     <span class="keywordflow">while</span>(cLen &gt; size_heartbeat_chunk+parptr)
<a name="l00846"></a>00846                     {
<a name="l00847"></a>00847                         <span class="comment">// we supppose type 1 here</span>
<a name="l00848"></a>00848                         <span class="comment">//sctpEV3&lt;&lt;&quot;HB-chunk+parptr=&quot;&lt;&lt;size_heartbeat_chunk+parptr&lt;&lt;&quot;\n&quot;;</span>
<a name="l00849"></a>00849                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbc) + size_heartbeat_chunk + parptr);
<a name="l00850"></a>00850                         <span class="keywordflow">if</span>(ntohs(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a>) == 1) <span class="comment">// sender specific hb info</span>
<a name="l00851"></a>00851                         {
<a name="l00852"></a>00852                             <span class="comment">//sctpEV3&lt;&lt;&quot;HBInfo\n&quot;;</span>
<a name="l00853"></a>00853                             int32 infoLen = ntohs(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>) - 4;
<a name="l00854"></a>00854                             parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(infoLen) + 4;
<a name="l00855"></a>00855                             parcounter++;
<a name="l00856"></a>00856                             chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a074df611249523d0e39593083d98fc59">setInfoArraySize</a>(infoLen);
<a name="l00857"></a>00857                             <span class="keywordflow">for</span>(int32 i=0; i&lt;infoLen; i++)
<a name="l00858"></a>00858                                 chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#abcaa138d0015f1a9ebdb0666911f5f16">setInfo</a>(i, <a class="code" href="sctp_8h.html#a35a07f4d1137779b208b608ac62f7561">HBI_INFO</a>(hbi)[i]);
<a name="l00859"></a>00859                         }
<a name="l00860"></a>00860                         <span class="keywordflow">else</span>
<a name="l00861"></a>00861                         {
<a name="l00862"></a>00862                             parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(ntohs(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>));  <span class="comment">// set pointer forwards with count of bytes in length field of TLV</span>
<a name="l00863"></a>00863                             parcounter++;
<a name="l00864"></a>00864                             <span class="keywordflow">continue</span>;
<a name="l00865"></a>00865                         }
<a name="l00866"></a>00866                     }
<a name="l00867"></a>00867                 }
<a name="l00868"></a>00868                 chunk-&gt;setBitLength(cLen*8);
<a name="l00869"></a>00869                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00870"></a>00870                 <span class="keywordflow">break</span>;
<a name="l00871"></a>00871             }
<a name="l00872"></a>00872             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
<a name="l00873"></a>00873             {
<a name="l00874"></a>00874                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Heartbeat_Ack received\n&quot;</span>;
<a name="l00875"></a>00875                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a> *hbac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>*) (chunks + chunkPtr);
<a name="l00876"></a>00876                 <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html">SCTPHeartbeatAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html">SCTPHeartbeatAckChunk</a>(<span class="stringliteral">&quot;HEARTBEAT_ACK&quot;</span>);
<a name="l00877"></a>00877                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00878"></a>00878                 <span class="keywordflow">if</span>(cLen&gt;size_heartbeat_ack_chunk)
<a name="l00879"></a>00879                 {
<a name="l00880"></a>00880                     int32 parcounter = 0;
<a name="l00881"></a>00881                     parptr = 0;
<a name="l00882"></a>00882                     <span class="keywordflow">while</span>(cLen &gt; size_heartbeat_ack_chunk+parptr)
<a name="l00883"></a>00883                     {
<a name="l00884"></a>00884                         <span class="comment">// we supppose type 1 here, the same provided in heartbeat chunks</span>
<a name="l00885"></a>00885                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbac) + size_heartbeat_ack_chunk + parptr);
<a name="l00886"></a>00886                         <span class="keywordflow">if</span>(ntohs(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a>) == 1) <span class="comment">// sender specific hb info</span>
<a name="l00887"></a>00887                         {
<a name="l00888"></a>00888                             parptr += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>);
<a name="l00889"></a>00889                             parcounter++;
<a name="l00890"></a>00890                             chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a22ba7bcdf20e1b65cb8a312dcf20a87d">setRemoteAddr</a>(<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(ntohl(<a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi))));
<a name="l00891"></a>00891                             chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#ac40c3fc4bf7d2c57ecd7ac7add556915">setTimeField</a>(ntohl((uint32)<a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi)));
<a name="l00892"></a>00892                         }
<a name="l00893"></a>00893                         <span class="keywordflow">else</span>
<a name="l00894"></a>00894                         {
<a name="l00895"></a>00895                             parptr += ntohs(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>);   <span class="comment">// set pointer forwards with count of bytes in length field of TLV</span>
<a name="l00896"></a>00896                             parcounter++;
<a name="l00897"></a>00897                             <span class="keywordflow">continue</span>;
<a name="l00898"></a>00898                         }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900                     }
<a name="l00901"></a>00901                 }
<a name="l00902"></a>00902                 chunk-&gt;setBitLength(cLen*8);
<a name="l00903"></a>00903                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00904"></a>00904                 <span class="keywordflow">break</span>;
<a name="l00905"></a>00905             }
<a name="l00906"></a>00906             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
<a name="l00907"></a>00907             {
<a name="l00908"></a>00908                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Abort received\n&quot;</span>;
<a name="l00909"></a>00909                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a> *ac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>*) (chunks + chunkPtr);
<a name="l00910"></a>00910                 cLen = ntohs(ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#ac0550cef90bd35ba1bf8430ee783743d">length</a>);
<a name="l00911"></a>00911                 <a class="code" href="class_s_c_t_p_abort_chunk.html">SCTPAbortChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_abort_chunk.html">SCTPAbortChunk</a>(<span class="stringliteral">&quot;ABORT&quot;</span>);
<a name="l00912"></a>00912                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00913"></a>00913                 chunk-&gt;<a class="code" href="class_s_c_t_p_abort_chunk.html#a992f6e445630f0cb902d00dba0ba1ffe">setT_Bit</a>(ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#af7c6588f89c568b6ca8dcf40cb32daf7">flags</a> &amp; <a class="code" href="sctp_8h.html#ace344d543daa81e5cbfbba5fabb29d27">T_BIT</a>);
<a name="l00914"></a>00914                 <span class="keywordflow">if</span>(cLen&gt;size_abort_chunk)
<a name="l00915"></a>00915                 {
<a name="l00916"></a>00916                     <span class="comment">// TODO: handle attached error causes</span>
<a name="l00917"></a>00917                 }
<a name="l00918"></a>00918                 chunk-&gt;setBitLength(cLen*8);
<a name="l00919"></a>00919                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00920"></a>00920                 <span class="keywordflow">break</span>;
<a name="l00921"></a>00921             }
<a name="l00922"></a>00922             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
<a name="l00923"></a>00923             {
<a name="l00924"></a>00924                 <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html">SCTPCookieEchoChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html">SCTPCookieEchoChunk</a>(<span class="stringliteral">&quot;COOKIE_ECHO&quot;</span>);
<a name="l00925"></a>00925                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00926"></a>00926                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Parse Cookie-Echo\n&quot;</span>;
<a name="l00927"></a>00927                 <span class="keywordflow">if</span>(cLen&gt;size_cookie_echo_chunk)
<a name="l00928"></a>00928                 {
<a name="l00929"></a>00929                     int32 cookieSize = woPadding-size_cookie_echo_chunk;
<a name="l00930"></a>00930                     <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;cookieSize=&quot;</span>&lt;&lt;cookieSize&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00931"></a>00931                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a>*)(chunks+chunkPtr+4);
<a name="l00932"></a>00932                     <a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>* stateCookie = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie.html">SCTPCookie</a>();
<a name="l00933"></a>00933                     stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a95882bf91ab2e066c92cc826d144fee5">setCreationTime</a>(ntohl(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a96b0f36a38c9886943c75ba5b29c0ef0">creationTime</a>));
<a name="l00934"></a>00934                     stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ad68609537bab5a4073a9eb70f173d9bf">setLocalTag</a>(ntohl(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a023a4299beb2cfb28dd2ef1dfd0478c7">localTag</a>));
<a name="l00935"></a>00935                     stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#aa9e44596bb0c1f16569b0efe6f52ced8">setPeerTag</a>(ntohl(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a648153b48ec8424e1f72ff921b8a644d">peerTag</a>));
<a name="l00936"></a>00936                     stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a418651ad52ef5a5e436689a21eee0575">setLocalTieTagArraySize</a>(32);
<a name="l00937"></a>00937                     stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a0cab05bbec5ce9ad0f62107a871e3bdd">setPeerTieTagArraySize</a>(32);
<a name="l00938"></a>00938                     <span class="keywordflow">for</span>(int32 i=0; i&lt;32; i++)
<a name="l00939"></a>00939                     {
<a name="l00940"></a>00940                         stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ae6f7653d65d8a5380b96fce7e2a8d757">setLocalTieTag</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#ad99c0071b11d8dfd434ec386226611f7">localTieTag</a>[i]);
<a name="l00941"></a>00941                         stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#aa296384e951b7eb7c17ab4807fb31e56">setPeerTieTag</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a34286a6e985ef4527a947f4199333dc0">peerTieTag</a>[i]);
<a name="l00942"></a>00942                     }
<a name="l00943"></a>00943                     stateCookie-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a>*8);
<a name="l00944"></a>00944                     chunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a992073a4d09627ba9cc9bceb7fae4a18">setStateCookie</a>(stateCookie);
<a name="l00945"></a>00945                 }
<a name="l00946"></a>00946                 chunk-&gt;setBitLength(woPadding*8);
<a name="l00947"></a>00947                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00948"></a>00948                 <span class="keywordflow">break</span>;
<a name="l00949"></a>00949             }
<a name="l00950"></a>00950             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
<a name="l00951"></a>00951             {
<a name="l00952"></a>00952                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Cookie_Ack received\n&quot;</span>;
<a name="l00953"></a>00953                 <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html">SCTPCookieAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html">SCTPCookieAckChunk</a>(<span class="stringliteral">&quot;COOKIE_ACK&quot;</span>);
<a name="l00954"></a>00954                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00955"></a>00955                 chunk-&gt;setBitLength(cLen*8);
<a name="l00956"></a>00956                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00957"></a>00957                 <span class="keywordflow">break</span>;
<a name="l00958"></a>00958             }
<a name="l00959"></a>00959             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
<a name="l00960"></a>00960             {
<a name="l00961"></a>00961                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Shutdown received\n&quot;</span>;
<a name="l00962"></a>00962                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a> *sc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a>*) (chunks + chunkPtr);
<a name="l00963"></a>00963                 <a class="code" href="class_s_c_t_p_shutdown_chunk.html">SCTPShutdownChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_chunk.html">SCTPShutdownChunk</a>(<span class="stringliteral">&quot;SHUTDOWN&quot;</span>);
<a name="l00964"></a>00964                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00965"></a>00965                 uint32 cumtsnack = ntohl(sc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a294183dee80de069c3e9583ff376b791">cumulative_tsn_ack</a>);
<a name="l00966"></a>00966                 chunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html#ac17da447c6cada03dcb8ad7accb72c30">setCumTsnAck</a>(cumtsnack);
<a name="l00967"></a>00967                 chunk-&gt;setBitLength(cLen*8);
<a name="l00968"></a>00968                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00969"></a>00969                 <span class="keywordflow">break</span>;
<a name="l00970"></a>00970             }
<a name="l00971"></a>00971             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
<a name="l00972"></a>00972             {
<a name="l00973"></a>00973                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: ShutdownAck received\n&quot;</span>;
<a name="l00974"></a>00974                 <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html">SCTPShutdownAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html">SCTPShutdownAckChunk</a>(<span class="stringliteral">&quot;SHUTDOWN_ACK&quot;</span>);
<a name="l00975"></a>00975                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00976"></a>00976                 chunk-&gt;setBitLength(cLen*8);
<a name="l00977"></a>00977                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00978"></a>00978                 <span class="keywordflow">break</span>;
<a name="l00979"></a>00979             }
<a name="l00980"></a>00980             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
<a name="l00981"></a>00981             {
<a name="l00982"></a>00982                 ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: ShutdownComplete received\n&quot;</span>;
<a name="l00983"></a>00983                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a> *scc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a>*) (chunks + chunkPtr);
<a name="l00984"></a>00984                 <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html">SCTPShutdownCompleteChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html">SCTPShutdownCompleteChunk</a>(<span class="stringliteral">&quot;SHUTDOWN_COMPLETE&quot;</span>);
<a name="l00985"></a>00985                 chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00986"></a>00986                 chunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html#a497d1fc142ae36f49efa1529db6b65ac">setTBit</a>(scc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a234c2bbc04b3655058a07315144f5dc8">flags</a> &amp; <a class="code" href="sctp_8h.html#ace344d543daa81e5cbfbba5fabb29d27">T_BIT</a>);
<a name="l00987"></a>00987                 chunk-&gt;setBitLength(cLen*8);
<a name="l00988"></a>00988                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(chunk);
<a name="l00989"></a>00989                 <span class="keywordflow">break</span>;
<a name="l00990"></a>00990             }
<a name="l00991"></a>00991             <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
<a name="l00992"></a>00992             {
<a name="l00993"></a>00993                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a> *error;
<a name="l00994"></a>00994                 error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*) (chunks + chunkPtr);
<a name="l00995"></a>00995                 <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a> *errorchunk;
<a name="l00996"></a>00996                 errorchunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>(<span class="stringliteral">&quot;ERROR&quot;</span>);
<a name="l00997"></a>00997                 errorchunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a34fe3ee4c5fc3000b097b959d757b875">setChunkType</a>(chunkType);
<a name="l00998"></a>00998                 errorchunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>*8);
<a name="l00999"></a>00999                 parptr = 0;
<a name="l01000"></a>01000                 dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(errorchunk);
<a name="l01001"></a>01001                 <span class="keywordflow">break</span>;
<a name="l01002"></a>01002             }
<a name="l01003"></a>01003             <span class="keywordflow">default</span>:
<a name="l01004"></a>01004                 <span class="comment">//printf(&quot;TODO: Implement chunk type %d, found in chunk array on %d!\n&quot;, chunkType, ct);</span>
<a name="l01005"></a>01005                 <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;Parser: Unknown SCTP chunk type &quot;</span> &lt;&lt; chunkType;
<a name="l01006"></a>01006 
<a name="l01007"></a>01007                 <span class="comment">/*throw new cRuntimeError(&quot;TODO: unknown chunktype in incoming packet from external interface! Implement it!&quot;);*/</span>
<a name="l01008"></a>01008 
<a name="l01009"></a>01009                 <span class="keywordflow">break</span>;
<a name="l01010"></a>01010         }   <span class="comment">// end of switch(chunkType)</span>
<a name="l01011"></a>01011         chunkPtr += cLen;
<a name="l01012"></a>01012     }   <span class="comment">// end of while()</span>
<a name="l01013"></a>01013 }
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:30 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
