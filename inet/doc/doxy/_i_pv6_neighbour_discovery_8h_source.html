<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: IPv6NeighbourDiscovery.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_10b2eb36c3bc5c55e7882141837be45a.html">networklayer</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_34539289066c093336ad4859481fa656.html">icmpv6</a>
  </div>
</div>
<div class="contents">
<h1>IPv6NeighbourDiscovery.h</h1><a href="_i_pv6_neighbour_discovery_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00019"></a>00019 <span class="preprocessor">#ifndef IPV6NEIGHBOURDISCOVERY_H</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#define IPV6NEIGHBOURDISCOVERY_H</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;set&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;omnetpp.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_address_8h.html">IPv6Address.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_datagram_8h.html">IPv6Datagram.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_n_d_message__m_8h.html">IPv6NDMessage_m.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_control_info_8h.html">IPv6ControlInfo.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_interface_data_8h.html">IPv6InterfaceData.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="_interface_entry_8h.html">InterfaceEntry.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="_i_interface_table_8h.html">IInterfaceTable.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="_interface_table_access_8h.html">InterfaceTableAccess.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="_routing_table6_8h.html">RoutingTable6.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="_routing_table6_access_8h.html">RoutingTable6Access.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv6_neighbour_cache_8h.html">IPv6NeighbourCache.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="_i_c_m_pv6_8h.html">ICMPv6.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="_i_c_m_pv6_access_8h.html">ICMPv6Access.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00044"></a><a class="code" href="class_i_pv6_neighbour_discovery.html">00044</a> <span class="keyword">class </span><a class="code" href="_i_n_e_t_defs_8h.html#ad4fa1dc2a221d8f0c1c417d4b993c51a">INET_API</a> <a class="code" href="class_i_pv6_neighbour_discovery.html">IPv6NeighbourDiscovery</a> : <span class="keyword">public</span> cSimpleModule
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046     <span class="keyword">public</span>:
<a name="l00047"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a0e2372b38f3787dd836bcee6b77eb268">00047</a>         <span class="keyword">typedef</span> std::vector&lt;cMessage*&gt; MsgPtrVector;
<a name="l00048"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a747705ed3b49881e2d144e2d9f0c8044">00048</a>         <span class="keyword">typedef</span> <a class="code" href="struct_i_pv6_neighbour_cache_1_1_key.html">IPv6NeighbourCache::Key</a> <a class="code" href="struct_i_pv6_neighbour_cache_1_1_key.html">Key</a>;<span class="comment">//for convenience</span>
<a name="l00049"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a13e99f7e1505dd01abbf03066e61384c">00049</a>         <span class="keyword">typedef</span> <a class="code" href="struct_i_pv6_neighbour_cache_1_1_neighbour.html">IPv6NeighbourCache::Neighbour</a> <a class="code" href="struct_i_pv6_neighbour_cache_1_1_neighbour.html">Neighbour</a>;  <span class="comment">// for convenience</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="keyword">public</span>:
<a name="l00052"></a>00052         <a class="code" href="class_i_pv6_neighbour_discovery.html">IPv6NeighbourDiscovery</a>();
<a name="l00053"></a>00053         <span class="keyword">virtual</span> ~<a class="code" href="class_i_pv6_neighbour_discovery.html">IPv6NeighbourDiscovery</a>();
<a name="l00054"></a>00054 
<a name="l00055"></a>00055     <span class="keyword">public</span>:
<a name="l00072"></a>00072         <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; resolveNeighbour(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; nextHop, <span class="keywordtype">int</span> interfaceId);
<a name="l00073"></a>00073 
<a name="l00083"></a>00083         <span class="keyword">virtual</span> <span class="keywordtype">void</span> reachabilityConfirmed(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; neighbour, <span class="keywordtype">int</span> interfaceId);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     <span class="keyword">protected</span>:
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         <span class="comment">//Packets awaiting Address Resolution or Next-Hop Determination.</span>
<a name="l00088"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a8cebccf199f96d0903c4663b203199ca">00088</a>         cQueue pendingQueue;
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a4b4f35b761b93c397e2a5a36c1e08d38">00090</a>         <a class="code" href="class_i_interface_table.html">IInterfaceTable</a> *ift;
<a name="l00091"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a0f6a26512cd490f5a09e9bd7ec3bf61f">00091</a>         <a class="code" href="class_routing_table6.html">RoutingTable6</a> *rt6;
<a name="l00092"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a78cfa038ef771566c18a2eec28fd740b">00092</a>         <a class="code" href="class_i_c_m_pv6.html">ICMPv6</a> *icmpv6;
<a name="l00093"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a2034aa8fe938bda7f5e032d95892cf84">00093</a>         <a class="code" href="class_i_pv6_neighbour_cache.html">IPv6NeighbourCache</a> neighbourCache;
<a name="l00094"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#af7b0af85c2810acc01d715305818f59b">00094</a>         <span class="keyword">typedef</span> std::set&lt;cMessage*&gt; RATimerList;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <span class="comment">// stores information about a pending Duplicate Address Detection for</span>
<a name="l00097"></a>00097         <span class="comment">// an interface</span>
<a name="l00098"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html">00098</a>         <span class="keyword">struct </span><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html">DADEntry</a> {
<a name="l00099"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html#a1f540a80228c9ddcfeae1468801b4475">00099</a>             <span class="keywordtype">int</span> interfaceId;<span class="comment">// interface on which DAD is performed</span>
<a name="l00100"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html#a4588701a8afa5f50d31020926a24fb93">00100</a>             <a class="code" href="class_i_pv6_address.html">IPv6Address</a> address;<span class="comment">// link-local address subject to DAD</span>
<a name="l00101"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html#aaa0078a29c8410eee550d3b412e13781">00101</a>             <span class="keywordtype">int</span> numNSSent;<span class="comment">// number of DAD solicitations sent since start of sim</span>
<a name="l00102"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_d_a_d_entry.html#a3f9f53fe75ff18357e8f9dcc0632ee2c">00102</a>             cMessage *timeoutMsg;<span class="comment">// the message to cancel when NA is received</span>
<a name="l00103"></a>00103         };
<a name="l00104"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a516186e680ba4eaf87de697019421987">00104</a>         <span class="keyword">typedef</span> std::set&lt;DADEntry*&gt; DADList; <span class="comment">//FIXME why ptrs are stored?</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106         <span class="comment">//stores information about Router Discovery for an interface</span>
<a name="l00107"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html">00107</a>         <span class="keyword">struct </span><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html">RDEntry</a> {
<a name="l00108"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html#addcde7923e87e15ef8abd44ee4cb99d7">00108</a>             <span class="keywordtype">int</span> interfaceId; <span class="comment">//interface on which Router Discovery is performed</span>
<a name="l00109"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html#a4866f6d9017dfac28f5e81a7c361151b">00109</a>             <span class="keywordtype">int</span> numRSSent; <span class="comment">//number of Router Solicitations sent since start of sim</span>
<a name="l00110"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html#a2fc4d020f4c3c49eb4793a0d3e01ea78">00110</a>             cMessage *timeoutMsg; <span class="comment">//the message to cancel when RA is received</span>
<a name="l00111"></a>00111         };
<a name="l00112"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a99d6acdeeccceb22d5b199a46c1a0e78">00112</a>         <span class="keyword">typedef</span> std::set&lt;RDEntry*&gt; RDList; <span class="comment">//FIXME why ptrs are stored?</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="comment">//An entry that stores information for an Advertising Interface</span>
<a name="l00115"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html">00115</a>         <span class="keyword">struct </span><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html">AdvIfEntry</a> {
<a name="l00116"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html#add4908c7a6062a8b45b9efed8f0ec50a">00116</a>             <span class="keywordtype">int</span> interfaceId;
<a name="l00117"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html#a478292e0775ffdfc89f2d639d0bb63ab">00117</a>             <span class="keywordtype">int</span> numRASent;<span class="comment">//number of Router Advertisements sent since start of sim</span>
<a name="l00118"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html#aeb98e40a6b5b92f461b45d275fff8bdc">00118</a>             simtime_t nextScheduledRATime;<span class="comment">//stores time when next RA will be sent.</span>
<a name="l00119"></a><a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html#a682ed2d1646de93e97622d886979a97d">00119</a>             cMessage *raTimeoutMsg;<span class="comment">//the message to cancel when resetting RA timer</span>
<a name="l00120"></a>00120         };
<a name="l00121"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a74d1e81840eb6742f1f595691e43ac29">00121</a>         <span class="keyword">typedef</span> std::set&lt;AdvIfEntry*&gt; AdvIfList; <span class="comment">//FIXME why ptrs are stored?</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         <span class="comment">//List of periodic RA msgs(used only for router interfaces)</span>
<a name="l00124"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#ad8d41d97624aa9ba4878adea476018d0">00124</a>         RATimerList raTimerList;
<a name="l00125"></a>00125         <span class="comment">//List of pending Duplicate Address Detections</span>
<a name="l00126"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a750d70366700481befd66c567d420a7e">00126</a>         DADList dadList;
<a name="l00127"></a>00127         <span class="comment">//List of pending Router &amp; Prefix Discoveries</span>
<a name="l00128"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a7f075a086f580756337ef6f59223727c">00128</a>         RDList rdList;
<a name="l00129"></a>00129         <span class="comment">//List of Advertising Interfaces</span>
<a name="l00130"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a868ef2afa69950bd536b1fb5cd10569a">00130</a>         AdvIfList advIfList;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keyword">protected</span>:
<a name="l00133"></a>00133         <span class="comment">/************************Miscellaneous Stuff***************************/</span>
<a name="l00134"></a><a class="code" href="class_i_pv6_neighbour_discovery.html#a878f457b650d3fbdf047dd220f8f2d88">00134</a>         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="class_i_pv6_neighbour_discovery.html#a878f457b650d3fbdf047dd220f8f2d88">numInitStages</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 4;}
<a name="l00135"></a>00135         <span class="keyword">virtual</span> <span class="keywordtype">void</span> initialize(<span class="keywordtype">int</span> stage);
<a name="l00136"></a>00136         <span class="keyword">virtual</span> <span class="keywordtype">void</span> handleMessage(cMessage *msg);
<a name="l00137"></a>00137         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNDMessage(<a class="code" href="class_i_c_m_pv6_message.html">ICMPv6Message</a> *msg, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *ctrlInfo);
<a name="l00138"></a>00138         <span class="keyword">virtual</span> <span class="keywordtype">void</span> finish();
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processIPv6Datagram(<a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram);
<a name="l00141"></a>00141         <span class="keyword">virtual</span> <a class="code" href="struct_i_pv6_neighbour_discovery_1_1_adv_if_entry.html">IPv6NeighbourDiscovery::AdvIfEntry</a> *fetchAdvIfEntry(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00142"></a>00142         <span class="keyword">virtual</span> <a class="code" href="struct_i_pv6_neighbour_discovery_1_1_r_d_entry.html">IPv6NeighbourDiscovery::RDEntry</a> *fetchRDEntry(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00143"></a>00143         <span class="comment">/************************End of Miscellaneous Stuff********************/</span>
<a name="l00144"></a>00144 
<a name="l00154"></a>00154         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a> determineNextHop(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; destAddr, <span class="keywordtype">int</span>&amp; outIfID);
<a name="l00155"></a>00155         <span class="keyword">virtual</span> <span class="keywordtype">void</span> initiateNeighbourUnreachabilityDetection(Neighbour *neighbour);
<a name="l00156"></a>00156         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNUDTimeout(cMessage *timeoutMsg);
<a name="l00157"></a>00157         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a> selectDefaultRouter(<span class="keywordtype">int</span>&amp; outIfID);
<a name="l00166"></a>00166         <span class="keyword">virtual</span> <span class="keywordtype">void</span> timeoutPrefixEntry(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; destPrefix, <span class="keywordtype">int</span> prefixLength);
<a name="l00175"></a>00175         <span class="keyword">virtual</span> <span class="keywordtype">void</span> timeoutDefaultRouter(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; addr, <span class="keywordtype">int</span> interfaceID);
<a name="l00184"></a>00184         <span class="keyword">virtual</span> <span class="keywordtype">void</span> initiateAddressResolution(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; dgSrcAddr,
<a name="l00185"></a>00185             Neighbour *nce);
<a name="l00190"></a>00190         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processARTimeout(cMessage *arTimeoutMsg);
<a name="l00195"></a>00195         <span class="keyword">virtual</span> <span class="keywordtype">void</span> dropQueuedPacketsAwaitingAR(Neighbour *nce);
<a name="l00200"></a>00200         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendPacketToIPv6Module(cMessage *msg, <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; destAddr,
<a name="l00201"></a>00201             <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; srcAddr, <span class="keywordtype">int</span> interfaceId);
<a name="l00202"></a>00202 
<a name="l00207"></a>00207         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendQueuedPacketsToIPv6Module(Neighbour *nce);
<a name="l00208"></a>00208 
<a name="l00213"></a>00213         <span class="keyword">virtual</span> <span class="keywordtype">void</span> initiateDAD(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; tentativeAddr, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00214"></a>00214 
<a name="l00220"></a>00220         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processDADTimeout(cMessage *msg);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="comment">/************Address Autoconfiguration Stuff***************************/</span>
<a name="l00237"></a>00237         <span class="keyword">virtual</span> <span class="keywordtype">void</span> assignLinkLocalAddress(cMessage *timerMsg);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="comment">/************End Of Address Autoconfiguration Stuff********************/</span>
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="comment">/************Router Solicitation Stuff*********************************/</span>
<a name="l00242"></a>00242         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_router_solicitation.html">IPv6RouterSolicitation</a> *createAndSendRSPacket(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00243"></a>00243         <span class="keyword">virtual</span> <span class="keywordtype">void</span> initiateRouterDiscovery(cMessage *msg);
<a name="l00253"></a>00253         <span class="keyword">virtual</span> <span class="keywordtype">void</span> cancelRouterDiscovery(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00254"></a>00254         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRDTimeout(cMessage *msg);
<a name="l00255"></a>00255         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRSPacket(<a class="code" href="class_i_pv6_router_solicitation.html">IPv6RouterSolicitation</a> *rs, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *rsCtrlInfo);
<a name="l00256"></a>00256         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> validateRSPacket(<a class="code" href="class_i_pv6_router_solicitation.html">IPv6RouterSolicitation</a> *rs, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *rsCtrlInfo);
<a name="l00257"></a>00257         <span class="comment">/************End of Router Solicitation Stuff**************************/</span>
<a name="l00258"></a>00258 
<a name="l00259"></a>00259         <span class="comment">/************Router Advertisment Stuff*********************************/</span>
<a name="l00260"></a>00260         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_router_advertisement.html">IPv6RouterAdvertisement</a> *createAndSendRAPacket(<span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; destAddr,
<a name="l00261"></a>00261             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00262"></a>00262         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRAPacket(<a class="code" href="class_i_pv6_router_advertisement.html">IPv6RouterAdvertisement</a> *ra, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *raCtrlInfo);
<a name="l00263"></a>00263         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRAForRouterUpdates(<a class="code" href="class_i_pv6_router_advertisement.html">IPv6RouterAdvertisement</a> *ra,
<a name="l00264"></a>00264             <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *raCtrlInfo);
<a name="l00265"></a>00265         <span class="comment">//RFC 2461: Section 6.3.4</span>
<a name="l00266"></a>00266         <span class="comment">/*Note: Implementations can choose to process the on-link aspects of the</span>
<a name="l00267"></a>00267 <span class="comment">        prefixes separately from the address autoconfiguration aspects of the</span>
<a name="l00268"></a>00268 <span class="comment">        prefixes by, e.g., passing a copy of each valid Router Advertisement message</span>
<a name="l00269"></a>00269 <span class="comment">        to both an &quot;on-link&quot; and an &quot;addrconf&quot; function. Each function can then</span>
<a name="l00270"></a>00270 <span class="comment">        operate independently on the prefixes that have the appropriate flag set.*/</span>
<a name="l00271"></a>00271         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRAPrefixInfo(<a class="code" href="class_i_pv6_router_advertisement.html">IPv6RouterAdvertisement</a> *ra, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00272"></a>00272         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRAPrefixInfoForAddrAutoConf(<a class="code" href="class_i_pv6_n_d_prefix_information.html">IPv6NDPrefixInformation</a>&amp; prefixInfo,
<a name="l00273"></a>00273             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00278"></a>00278         <span class="keyword">virtual</span> <span class="keywordtype">void</span> createRATimer(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00285"></a>00285         <span class="keyword">virtual</span> <span class="keywordtype">void</span> resetRATimer(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00286"></a>00286         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendPeriodicRA(cMessage *msg);
<a name="l00287"></a>00287         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSolicitedRA(cMessage *msg);
<a name="l00288"></a>00288         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> validateRAPacket(<a class="code" href="class_i_pv6_router_advertisement.html">IPv6RouterAdvertisement</a> *ra, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *raCtrlInfo);
<a name="l00289"></a>00289         <span class="comment">/************End of Router Advertisement Stuff*************************/</span>
<a name="l00290"></a>00290 
<a name="l00291"></a>00291         <span class="comment">/************Neighbour Solicitaton Stuff*******************************/</span>
<a name="l00292"></a>00292         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *createAndSendNSPacket(
<a name="l00293"></a>00293             <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; nsTargetAddr, <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; dgDestAddr,
<a name="l00294"></a>00294             <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; dgSrcAddr, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00295"></a>00295         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNSPacket(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *naCtrlInfo);
<a name="l00296"></a>00296         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> validateNSPacket(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *nsCtrlInfo);
<a name="l00297"></a>00297         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNSForTentativeAddress(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns,
<a name="l00298"></a>00298             <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *ctrlInfo);
<a name="l00299"></a>00299         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNSForNonTentativeAddress(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns,
<a name="l00300"></a>00300             <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *ctrlInfo, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00301"></a>00301         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNSWithSpecifiedSrcAddr(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns,
<a name="l00302"></a>00302             <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *ctrlInfo, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00303"></a>00303         <span class="comment">/************End Of Neighbour Solicitation Stuff***********************/</span>
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         <span class="comment">/************Neighbour Advertisment Stuff)*****************************/</span>
<a name="l00306"></a>00306         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSolicitedNA(<a class="code" href="class_i_pv6_neighbour_solicitation.html">IPv6NeighbourSolicitation</a> *ns,
<a name="l00307"></a>00307             <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *nsCtrlInfo, <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00308"></a>00308         <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendUnsolicitedNA(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00309"></a>00309         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNAPacket(<a class="code" href="class_i_pv6_neighbour_advertisement.html">IPv6NeighbourAdvertisement</a> *na, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *naCtrlInfo);
<a name="l00310"></a>00310         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> validateNAPacket(<a class="code" href="class_i_pv6_neighbour_advertisement.html">IPv6NeighbourAdvertisement</a> *na, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *naCtrlInfo);
<a name="l00311"></a>00311         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNAForIncompleteNCEState(<a class="code" href="class_i_pv6_neighbour_advertisement.html">IPv6NeighbourAdvertisement</a> *na,
<a name="l00312"></a>00312             <a class="code" href="struct_i_pv6_neighbour_cache_1_1_neighbour.html">IPv6NeighbourCache::Neighbour</a> *nce);
<a name="l00313"></a>00313         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processNAForOtherNCEStates(<a class="code" href="class_i_pv6_neighbour_advertisement.html">IPv6NeighbourAdvertisement</a> *na,
<a name="l00314"></a>00314             <a class="code" href="struct_i_pv6_neighbour_cache_1_1_neighbour.html">IPv6NeighbourCache::Neighbour</a> *nce);
<a name="l00315"></a>00315         <span class="comment">/************End Of Neighbour Advertisement Stuff**********************/</span>
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         <span class="comment">/************Redirect Message Stuff************************************/</span>
<a name="l00318"></a>00318         <span class="keyword">virtual</span> <a class="code" href="class_i_pv6_redirect.html">IPv6Redirect</a> *createAndSendRedirectPacket(<a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie);
<a name="l00319"></a>00319         <span class="keyword">virtual</span> <span class="keywordtype">void</span> processRedirectPacket(<a class="code" href="class_i_pv6_redirect.html">IPv6Redirect</a> *redirect, <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *ctrlInfo);
<a name="l00320"></a>00320         <span class="comment">/************End Of Redirect Message Stuff*****************************/</span>
<a name="l00321"></a>00321 
<a name="l00327"></a>00327         <span class="comment">/*ICMPv6DestUnreachableMsg *createAndSendUnreachableMessage(</span>
<a name="l00328"></a>00328 <span class="comment">            const IPv6Address&amp; destAddress, InterfaceEntry *ie);*/</span>
<a name="l00329"></a>00329 };
<a name="l00330"></a>00330 <span class="preprocessor">#endif //IPV6NEIGHBOURDISCOVERY_H</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:28 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
