<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: TCPConnection.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_493eba74639f722aa88bd3d010f621b5.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_34a6fbd47227bd78d46d19b24c6937db.html">transport</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9d5c10e2e4f3c4eb7cb80fb0f6ea3e10.html">tcp</a>
  </div>
</div>
<div class="contents">
<h1>TCPConnection.h</h1><a href="_t_c_p_connection_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// Copyright (C) 2004 Andras Varga</span>
<a name="l00003"></a>00003 <span class="comment">//               2009 Thomas Reschka</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This program is free software; you can redistribute it and/or</span>
<a name="l00006"></a>00006 <span class="comment">// modify it under the terms of the GNU Lesser General Public License</span>
<a name="l00007"></a>00007 <span class="comment">// as published by the Free Software Foundation; either version 2</span>
<a name="l00008"></a>00008 <span class="comment">// of the License, or (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">// This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment">// GNU Lesser General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">// You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00016"></a>00016 <span class="comment">// along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#ifndef __INET_TCPCONNECTION_H</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#define __INET_TCPCONNECTION_H</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;omnetpp.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="_i_n_e_t_defs_8h.html">INETDefs.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="_i_pv_x_address_8h.html">IPvXAddress.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="_t_c_p_8h.html">TCP.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="_t_c_p_segment_8h.html">TCPSegment.h</a>&quot;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">class </span><a class="code" href="class_t_c_p_segment.html">TCPSegment</a>;
<a name="l00029"></a>00029 <span class="keyword">class </span><a class="code" href="class_t_c_p_command.html">TCPCommand</a>;
<a name="l00030"></a>00030 <span class="keyword">class </span><a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a>;
<a name="l00031"></a>00031 <span class="keyword">class </span><a class="code" href="class_t_c_p_send_queue.html">TCPSendQueue</a>;
<a name="l00032"></a>00032 <span class="keyword">class </span><a class="code" href="class_t_c_p_s_a_c_k_rexmit_queue.html">TCPSACKRexmitQueue</a>;
<a name="l00033"></a>00033 <span class="keyword">class </span><a class="code" href="class_t_c_p_receive_queue.html">TCPReceiveQueue</a>;
<a name="l00034"></a>00034 <span class="keyword">class </span><a class="code" href="class_t_c_p_algorithm.html">TCPAlgorithm</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">//</span>
<a name="l00038"></a>00038 <span class="comment">// TCP FSM states</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">// Brief descriptions (cf RFC 793, page 20):</span>
<a name="l00041"></a>00041 <span class="comment">//</span>
<a name="l00042"></a>00042 <span class="comment">// LISTEN - waiting for a connection request</span>
<a name="l00043"></a>00043 <span class="comment">// SYN-SENT - part of 3-way handshake (waiting for peer&apos;s SYN+ACK or SYN)</span>
<a name="l00044"></a>00044 <span class="comment">// SYN-RECEIVED - part of 3-way handshake (we sent SYN too, waiting for it to be acked)</span>
<a name="l00045"></a>00045 <span class="comment">// ESTABLISHED - normal data transfer</span>
<a name="l00046"></a>00046 <span class="comment">// FIN-WAIT-1 - FIN sent, waiting for its ACK (or peer&apos;s FIN)</span>
<a name="l00047"></a>00047 <span class="comment">// FIN-WAIT-2 - our side of the connection closed (our FIN acked), waiting for peer&apos;s FIN</span>
<a name="l00048"></a>00048 <span class="comment">// CLOSE-WAIT - FIN received and acked, waiting for local user to close</span>
<a name="l00049"></a>00049 <span class="comment">// LAST-ACK - remote side closed, FIN sent, waiting for its ACK</span>
<a name="l00050"></a>00050 <span class="comment">// CLOSING - simultaneous close: sent FIN, then got peer&apos;s FIN</span>
<a name="l00051"></a>00051 <span class="comment">// TIME-WAIT - both FIN&apos;s acked, waiting for some time to be sure remote TCP received our ACK</span>
<a name="l00052"></a>00052 <span class="comment">// CLOSED - represents no connection state at all.</span>
<a name="l00053"></a>00053 <span class="comment">//</span>
<a name="l00054"></a>00054 <span class="comment">// Note: FIN-WAIT-1, FIN-WAIT-2, CLOSING, TIME-WAIT represents active close (that is,</span>
<a name="l00055"></a>00055 <span class="comment">// local user closes first), and CLOSE-WAIT and LAST-ACK represents passive close.</span>
<a name="l00056"></a>00056 <span class="comment">//</span>
<a name="l00057"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfec">00057</a> <span class="keyword">enum</span> <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfec">TcpState</a>
<a name="l00058"></a>00058 {
<a name="l00059"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca857f320749c4757dceed359145658eff">00059</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca857f320749c4757dceed359145658eff">TCP_S_INIT</a>        = 0,
<a name="l00060"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecab99a253ee625d2133ac5db0e7deb7429">00060</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecab99a253ee625d2133ac5db0e7deb7429">TCP_S_CLOSED</a>      = FSM_Steady(1),
<a name="l00061"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca7f359883afd2bba5873121486706ccab">00061</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca7f359883afd2bba5873121486706ccab">TCP_S_LISTEN</a>      = FSM_Steady(2),
<a name="l00062"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca70c06b27000be54aee473572dd755890">00062</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca70c06b27000be54aee473572dd755890">TCP_S_SYN_SENT</a>    = FSM_Steady(3),
<a name="l00063"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca6d12bc57c1710f3d93ee80e392e1361f">00063</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca6d12bc57c1710f3d93ee80e392e1361f">TCP_S_SYN_RCVD</a>    = FSM_Steady(4),
<a name="l00064"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecaa8c5be2b3d7977abc27dfc396001f467">00064</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecaa8c5be2b3d7977abc27dfc396001f467">TCP_S_ESTABLISHED</a> = FSM_Steady(5),
<a name="l00065"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca077a72ba910cb22c3a4139dd0a4c3107">00065</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca077a72ba910cb22c3a4139dd0a4c3107">TCP_S_CLOSE_WAIT</a>  = FSM_Steady(6),
<a name="l00066"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecab44fe111730bbb0c24e5bc652659fff7">00066</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecab44fe111730bbb0c24e5bc652659fff7">TCP_S_LAST_ACK</a>    = FSM_Steady(7),
<a name="l00067"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca2cf3a0cecd0eeeed17966b0c4f208964">00067</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfeca2cf3a0cecd0eeeed17966b0c4f208964">TCP_S_FIN_WAIT_1</a>  = FSM_Steady(8),
<a name="l00068"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecaba28bfede161fc6d56ec1d30a363e463">00068</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecaba28bfede161fc6d56ec1d30a363e463">TCP_S_FIN_WAIT_2</a>  = FSM_Steady(9),
<a name="l00069"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecac43577621e6bf197109353b11babacd1">00069</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecac43577621e6bf197109353b11babacd1">TCP_S_CLOSING</a>     = FSM_Steady(10),
<a name="l00070"></a><a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecae102ae04107468f65ed2c9d80bc50997">00070</a>     <a class="code" href="_t_c_p_connection_8h.html#a4310b47e70de394d33f7cf601e35bfecae102ae04107468f65ed2c9d80bc50997">TCP_S_TIME_WAIT</a>   = FSM_Steady(11)
<a name="l00071"></a>00071 };
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">//</span>
<a name="l00075"></a>00075 <span class="comment">// Event, strictly for the FSM state transition purposes.</span>
<a name="l00076"></a>00076 <span class="comment">// DO NOT USE outside performStateTransition()!</span>
<a name="l00077"></a>00077 <span class="comment">//</span>
<a name="l00078"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">00078</a> <span class="keyword">enum</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>
<a name="l00079"></a>00079 {
<a name="l00080"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea543beef056b1f7e1f0b341f615393f6a">00080</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea543beef056b1f7e1f0b341f615393f6a">TCP_E_IGNORE</a>,
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="comment">// app commands</span>
<a name="l00083"></a>00083     <span class="comment">// (Note: no RECEIVE command, data are automatically passed up)</span>
<a name="l00084"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea17e50afaeaa3dbb408d5cdeb89e72e73">00084</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea17e50afaeaa3dbb408d5cdeb89e72e73">TCP_E_OPEN_ACTIVE</a>,
<a name="l00085"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaea16a1754a7e2cd75ffd5e58be566a3f">00085</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaea16a1754a7e2cd75ffd5e58be566a3f">TCP_E_OPEN_PASSIVE</a>,
<a name="l00086"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaeea7c15df02e9826f07358dcee5980f4">00086</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaeea7c15df02e9826f07358dcee5980f4">TCP_E_SEND</a>,
<a name="l00087"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaf537925659bfd1160ec2e37e0293c9cf">00087</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaf537925659bfd1160ec2e37e0293c9cf">TCP_E_CLOSE</a>,
<a name="l00088"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea2cc18190ce98d4997975fa624a8e147d">00088</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea2cc18190ce98d4997975fa624a8e147d">TCP_E_ABORT</a>,
<a name="l00089"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eae44e44115e1cee7dfc8432ea3b393064">00089</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eae44e44115e1cee7dfc8432ea3b393064">TCP_E_STATUS</a>,
<a name="l00090"></a>00090 
<a name="l00091"></a>00091     <span class="comment">// TPDU types</span>
<a name="l00092"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea304f695bbcba57cc5d6bb6ccbca5cfac">00092</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea304f695bbcba57cc5d6bb6ccbca5cfac">TCP_E_RCV_DATA</a>,
<a name="l00093"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea5458371b7cd8cddaa5342ab47915844a">00093</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea5458371b7cd8cddaa5342ab47915844a">TCP_E_RCV_ACK</a>,
<a name="l00094"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea541f61a44292b46f1adaf374e22126a5">00094</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea541f61a44292b46f1adaf374e22126a5">TCP_E_RCV_SYN</a>,
<a name="l00095"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea8458ff8c0f604c80aa5aa6ee49f850c3">00095</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea8458ff8c0f604c80aa5aa6ee49f850c3">TCP_E_RCV_SYN_ACK</a>,
<a name="l00096"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ead4c5a9bfbaf2accb23697809655f2e32">00096</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ead4c5a9bfbaf2accb23697809655f2e32">TCP_E_RCV_FIN</a>,
<a name="l00097"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea9b1f9ceb96465850b379c784bb4d66c0">00097</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea9b1f9ceb96465850b379c784bb4d66c0">TCP_E_RCV_FIN_ACK</a>,
<a name="l00098"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaf96013e6e28c73e47277bb885fcf7aa6">00098</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eaf96013e6e28c73e47277bb885fcf7aa6">TCP_E_RCV_RST</a>, <span class="comment">// covers RST+ACK too</span>
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eac411ade35040a1a93a97487da933a6ff">00100</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eac411ade35040a1a93a97487da933a6ff">TCP_E_RCV_UNEXP_SYN</a>, <span class="comment">// unexpected SYN</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <span class="comment">// timers</span>
<a name="l00103"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea46d274b511ccd4b9d9a7eeb8122821c7">00103</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea46d274b511ccd4b9d9a7eeb8122821c7">TCP_E_TIMEOUT_2MSL</a>,     <span class="comment">// RFC 793, a.k.a. TIME-WAIT timer</span>
<a name="l00104"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eadf23ff2e2826987c01e8085ec6a9d869">00104</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85eadf23ff2e2826987c01e8085ec6a9d869">TCP_E_TIMEOUT_CONN_ESTAB</a>,
<a name="l00105"></a><a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea364bbb0c5f1f19bf23455be6bef115f9">00105</a>     <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85ea364bbb0c5f1f19bf23455be6bef115f9">TCP_E_TIMEOUT_FIN_WAIT_2</a>,
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="comment">// All other timers (REXMT, PERSIST, DELAYED-ACK, KEEP-ALIVE, etc.),</span>
<a name="l00108"></a>00108     <span class="comment">// are handled in TCPAlgorithm.</span>
<a name="l00109"></a>00109 };
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 
<a name="l00114"></a><a class="code" href="_t_c_p_connection_8h.html#a512458671be6d68703cc89178b0b35f0">00114</a> <span class="preprocessor">#define TCP_TIMEOUT_CONN_ESTAB    75    // 75 seconds</span>
<a name="l00115"></a><a class="code" href="_t_c_p_connection_8h.html#afe5e0b87871b7c8b8fb99d509453d837">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_TIMEOUT_FIN_WAIT_2   600    // 10 minutes</span>
<a name="l00116"></a><a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">00116</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_TIMEOUT_2MSL         240    // 2 * 2 minutes</span>
<a name="l00117"></a><a class="code" href="_t_c_p_connection_8h.html#a89ce38305130a5021e21134602a88f79">00117</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_TIMEOUT_SYN_REXMIT     3    // initially 3 seconds</span>
<a name="l00118"></a><a class="code" href="_t_c_p_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">00118</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_TIMEOUT_SYN_REXMIT_MAX 240  // 4 mins (will only be used with SYN+ACK: with SYN CONN_ESTAB occurs sooner)</span>
<a name="l00119"></a>00119 <span class="preprocessor"></span>
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="_t_c_p_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">00121</a> <span class="preprocessor">#define MAX_SYN_REXMIT_COUNT     12     // will only be used with SYN+ACK: with SYN CONN_ESTAB occurs sooner</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>
<a name="l00123"></a><a class="code" href="_t_c_p_connection_8h.html#a07b8719be91287fc05f5e527852bc1ec">00123</a> <span class="preprocessor">#define MAX_SACK_BLOCKS           60    // will only be used with SACK</span>
<a name="l00124"></a><a class="code" href="_t_c_p_connection_8h.html#a6d22725191167fb4feaacff2c1291afd">00124</a> <span class="preprocessor"></span><span class="preprocessor">#define DUPTHRESH                  3    // used for TCPTahoe, TCPReno and SACK (RFC 3517)</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00126"></a><a class="code" href="_t_c_p_connection_8h.html#a45fb301bd71c5637907f72760c563002">00126</a> <span class="preprocessor">#define TCP_MAX_WIN            65535    // largest value (16 bit) for (unscaled) window size</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>
<a name="l00130"></a><a class="code" href="_t_c_p_connection_8h.html#aa2e84a0093c6f222b12a4b443c7278eb">00130</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_t_c_p_connection_8h.html#aa2e84a0093c6f222b12a4b443c7278eb">seqLess</a>(uint32 a, uint32 b) {<span class="keywordflow">return</span> a!=b &amp;&amp; b-a&lt;(1UL&lt;&lt;31);}
<a name="l00131"></a><a class="code" href="_t_c_p_connection_8h.html#a55ef269e8ae44948c1d1f1cbe14bc92b">00131</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_t_c_p_connection_8h.html#a55ef269e8ae44948c1d1f1cbe14bc92b">seqLE</a>(uint32 a, uint32 b) {<span class="keywordflow">return</span> b-a&lt;(1UL&lt;&lt;31);}
<a name="l00132"></a><a class="code" href="_t_c_p_connection_8h.html#a459ac205bbda777389c12b7353227fbe">00132</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_t_c_p_connection_8h.html#a459ac205bbda777389c12b7353227fbe">seqGreater</a>(uint32 a, uint32 b) {<span class="keywordflow">return</span> a!=b &amp;&amp; a-b&lt;(1UL&lt;&lt;31);}
<a name="l00133"></a><a class="code" href="_t_c_p_connection_8h.html#af4745b9cf95eb5b78d8ae6c3c8429cfc">00133</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_t_c_p_connection_8h.html#af4745b9cf95eb5b78d8ae6c3c8429cfc">seqGE</a>(uint32 a, uint32 b) {<span class="keywordflow">return</span> a-b&lt;(1UL&lt;&lt;31);}
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 
<a name="l00150"></a><a class="code" href="class_t_c_p_state_variables.html">00150</a> <span class="keyword">class </span><a class="code" href="_i_n_e_t_defs_8h.html#ad4fa1dc2a221d8f0c1c417d4b993c51a">INET_API</a> <a class="code" href="class_t_c_p_state_variables.html">TCPStateVariables</a> : <span class="keyword">public</span> cPolymorphic
<a name="l00151"></a>00151 {
<a name="l00152"></a>00152   <span class="keyword">public</span>:
<a name="l00153"></a>00153     <a class="code" href="class_t_c_p_state_variables.html">TCPStateVariables</a>();
<a name="l00154"></a>00154     <span class="keyword">virtual</span> std::string info() <span class="keyword">const</span>;
<a name="l00155"></a>00155     <span class="keyword">virtual</span> std::string detailedInfo() <span class="keyword">const</span>;
<a name="l00156"></a>00156   <span class="keyword">public</span>:
<a name="l00157"></a><a class="code" href="class_t_c_p_state_variables.html#a4341a40e233610fbf989e373e450a08d">00157</a>     <span class="keywordtype">bool</span> active;         <span class="comment">// set if the connection was initiated by an active open</span>
<a name="l00158"></a><a class="code" href="class_t_c_p_state_variables.html#a8762f606d8dd51286d61ebbe833df932">00158</a>     <span class="keywordtype">bool</span> fork;           <span class="comment">// if passive and in LISTEN: whether to fork on an incoming connection</span>
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="class_t_c_p_state_variables.html#a2d9952d560079e7a0cf44f2308ac564f">00160</a>     uint32 snd_mss;      <span class="comment">// sender maximum segment size (without headers, i.e. only segment text); see RFC 2581, page 1.</span>
<a name="l00161"></a>00161                          <span class="comment">// This will be set to the minimum of the local smss parameter and the value specified in the</span>
<a name="l00162"></a>00162                          <span class="comment">// MSS option received during connection setup.</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="comment">// send sequence number variables (see RFC 793, &quot;3.2. Terminology&quot;)</span>
<a name="l00165"></a><a class="code" href="class_t_c_p_state_variables.html#a3a8a7f455c793cf894e22d4d72dbdc93">00165</a>     uint32 snd_una;      <span class="comment">// send unacknowledged</span>
<a name="l00166"></a><a class="code" href="class_t_c_p_state_variables.html#a8bd36330faab4393bbb4c56e89d140a1">00166</a>     uint32 snd_nxt;      <span class="comment">// send next (drops back on retransmission)</span>
<a name="l00167"></a><a class="code" href="class_t_c_p_state_variables.html#a220683addcd800e00fc59f348b40cff2">00167</a>     uint32 snd_max;      <span class="comment">// max seq number sent (needed because snd_nxt is re-set on retransmission)</span>
<a name="l00168"></a><a class="code" href="class_t_c_p_state_variables.html#aef29087f473f09bfb53eca0f652386d4">00168</a>     uint32 snd_wnd;      <span class="comment">// send window</span>
<a name="l00169"></a><a class="code" href="class_t_c_p_state_variables.html#a380d1be36964eb83f3d98d24562b92f3">00169</a>     uint32 snd_up;       <span class="comment">// send urgent pointer</span>
<a name="l00170"></a><a class="code" href="class_t_c_p_state_variables.html#ab7f05bfa1049d2d26d5c1f53846c0512">00170</a>     uint32 snd_wl1;      <span class="comment">// segment sequence number used for last window update</span>
<a name="l00171"></a><a class="code" href="class_t_c_p_state_variables.html#a682afef29243955b62b8d963faf83638">00171</a>     uint32 snd_wl2;      <span class="comment">// segment ack. number used for last window update</span>
<a name="l00172"></a><a class="code" href="class_t_c_p_state_variables.html#a68394945e99768afc131310ce6a37ea1">00172</a>     uint32 iss;          <span class="comment">// initial sequence number (ISS)</span>
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="comment">// receive sequence number variables</span>
<a name="l00175"></a><a class="code" href="class_t_c_p_state_variables.html#a5b9de18a3fb71fab5a540f98173b12b1">00175</a>     uint32 rcv_nxt;      <span class="comment">// receive next</span>
<a name="l00176"></a><a class="code" href="class_t_c_p_state_variables.html#aad67fe91f8983d1769877b559a0e9d00">00176</a>     uint32 rcv_wnd;      <span class="comment">// receive window</span>
<a name="l00177"></a><a class="code" href="class_t_c_p_state_variables.html#ae9646df9e0e50b7f04a5898929a78aed">00177</a>     uint32 rcv_up;       <span class="comment">// receive urgent pointer;</span>
<a name="l00178"></a><a class="code" href="class_t_c_p_state_variables.html#a3263aa617c113523e9459db081cf3208">00178</a>     uint32 irs;          <span class="comment">// initial receive sequence number</span>
<a name="l00179"></a><a class="code" href="class_t_c_p_state_variables.html#a3ff9c29dc3db01ad50308f6e0f917cb3">00179</a>     uint32 rcv_adv;      <span class="comment">// advertised window</span>
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="comment">// SYN, SYN+ACK retransmission variables (handled separately</span>
<a name="l00182"></a>00182     <span class="comment">// because normal rexmit belongs to TCPAlgorithm)</span>
<a name="l00183"></a><a class="code" href="class_t_c_p_state_variables.html#abfce4d61e489f5c73d2f73aa072814e6">00183</a>     <span class="keywordtype">int</span> syn_rexmit_count; <span class="comment">// number of SYN/SYN+ACK retransmissions (=1 after first rexmit)</span>
<a name="l00184"></a><a class="code" href="class_t_c_p_state_variables.html#a1bad9ac8364085b574ef441748c2e723">00184</a>     simtime_t syn_rexmit_timeout; <span class="comment">// current SYN/SYN+ACK retransmission timeout</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="comment">// whether ACK of our FIN has been received. Needed in FIN bit processing</span>
<a name="l00187"></a>00187     <span class="comment">// to decide between transition to TIME-WAIT and CLOSING (set event code</span>
<a name="l00188"></a>00188     <span class="comment">// TCP_E_RCV_FIN or TCP_E_RCV_FIN_ACK).</span>
<a name="l00189"></a><a class="code" href="class_t_c_p_state_variables.html#ac70666b0903dcc4bb0c76e4e3ddd64cd">00189</a>     <span class="keywordtype">bool</span> fin_ack_rcvd;
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="class_t_c_p_state_variables.html#a0401bd2db76f20ea6141550db9ae4d61">00191</a>     <span class="keywordtype">bool</span> send_fin;       <span class="comment">// true if a user CLOSE command has been &quot;queued&quot;</span>
<a name="l00192"></a><a class="code" href="class_t_c_p_state_variables.html#a20daa063530e578155124d9f9e4626f0">00192</a>     uint32 snd_fin_seq;  <span class="comment">// if send_fin==true: FIN should be sent just before this sequence number</span>
<a name="l00193"></a>00193 
<a name="l00194"></a><a class="code" href="class_t_c_p_state_variables.html#a32121c2fcf9d110150db1588cafa595a">00194</a>     <span class="keywordtype">bool</span> fin_rcvd;       <span class="comment">// whether FIN received or not</span>
<a name="l00195"></a><a class="code" href="class_t_c_p_state_variables.html#a1259e7450282a5b49755ea64b538a724">00195</a>     uint32 rcv_fin_seq;  <span class="comment">// if fin_rcvd: sequence number of received FIN</span>
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="class_t_c_p_state_variables.html#ad0a43b2fd46e7659e79c3cfd90c926a2">00197</a>     <span class="keywordtype">bool</span> nagle_enabled;         <span class="comment">// set if Nagle&apos;s algorithm (RFC 896) is enabled</span>
<a name="l00198"></a><a class="code" href="class_t_c_p_state_variables.html#a43536d5fd1e75c068cbcfe4ccf8fc79d">00198</a>     <span class="keywordtype">bool</span> delayed_acks_enabled;  <span class="comment">// set if delayed ACKs are enabled</span>
<a name="l00199"></a><a class="code" href="class_t_c_p_state_variables.html#a406b24dd2a997eae7618c762dfe2e48d">00199</a>     <span class="keywordtype">bool</span> limited_transmit_enabled; <span class="comment">// set if Limited Transmit algorithm (RFC 3042) is enabled</span>
<a name="l00200"></a><a class="code" href="class_t_c_p_state_variables.html#a7c3d5a7916b1d457f6065c488684d1d5">00200</a>     <span class="keywordtype">bool</span> increased_IW_enabled;  <span class="comment">// set if Increased Initial Window (RFC 3390) is enabled</span>
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="class_t_c_p_state_variables.html#a5d47c2c046bb9fe704be153bb0731e9a">00202</a>     uint32 full_sized_segment_counter;<span class="comment">// this counter is needed for delayed ACKs</span>
<a name="l00203"></a><a class="code" href="class_t_c_p_state_variables.html#ac945d97e6a37246ca8cf3648e01a8a26">00203</a>     <span class="keywordtype">bool</span> ack_now;               <span class="comment">// send ACK immediately, needed if delayed_acks_enabled is set</span>
<a name="l00204"></a>00204                                 <span class="comment">// Based on [Stevens, W.R.: TCP/IP Illustrated, Volume 2, page 861].</span>
<a name="l00205"></a>00205                                 <span class="comment">// ack_now should be set when:</span>
<a name="l00206"></a>00206                                 <span class="comment">//   - delayed ACK timer expires</span>
<a name="l00207"></a>00207                                 <span class="comment">//   - an out-of-order segment is received</span>
<a name="l00208"></a>00208                                 <span class="comment">//   - SYN is received during the three-way handshake</span>
<a name="l00209"></a>00209                                 <span class="comment">//   - a persist probe is received</span>
<a name="l00210"></a>00210                                 <span class="comment">//   - FIN is received</span>
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="class_t_c_p_state_variables.html#abff94bf9ec66bdbde487a74849de721e">00212</a>     <span class="keywordtype">bool</span> afterRto;              <span class="comment">// set at RTO, reset when snd_nxt == snd_max or snd_una == snd_max</span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">// SACK related variables</span>
<a name="l00215"></a><a class="code" href="class_t_c_p_state_variables.html#a25835ffc35b7d02038a899a25657870b">00215</a>     <span class="keywordtype">bool</span> sack_support;       <span class="comment">// set if the host supports selective acknowledgment (header option) (RFC 2018, 2883, 3517)</span>
<a name="l00216"></a><a class="code" href="class_t_c_p_state_variables.html#a47c0467054bd0209efc992c63d5d4d04">00216</a>     <span class="keywordtype">bool</span> sack_enabled;       <span class="comment">// set if the connection uses selective acknowledgment (header option)</span>
<a name="l00217"></a><a class="code" href="class_t_c_p_state_variables.html#a5db0ff74ca0d19891ca3c7e02f99d9a0">00217</a>     <span class="keywordtype">bool</span> snd_sack_perm;      <span class="comment">// set if SACK_PERMITTED has been sent</span>
<a name="l00218"></a><a class="code" href="class_t_c_p_state_variables.html#abd85c9f0a5e0769ae58e357f11e541fb">00218</a>     <span class="keywordtype">bool</span> rcv_sack_perm;      <span class="comment">// set if SACK_PERMITTED has been received</span>
<a name="l00219"></a><a class="code" href="class_t_c_p_state_variables.html#aa65590b4103c7d29454d8ea5b3a781c0">00219</a>     uint32 start_seqno;      <span class="comment">// start sequence number of last received out-of-order segment</span>
<a name="l00220"></a><a class="code" href="class_t_c_p_state_variables.html#ab59f15cb0300b2bb025186468e7a03a5">00220</a>     uint32 end_seqno;        <span class="comment">// end sequence number of last received out-of-order segment</span>
<a name="l00221"></a><a class="code" href="class_t_c_p_state_variables.html#ad03a121385224b940565040fe9eb433a">00221</a>     <span class="keywordtype">bool</span> snd_sack;           <span class="comment">// set if received vaild out-of-order segment or rcv_nxt changed, but receivedQueue is not empty</span>
<a name="l00222"></a><a class="code" href="class_t_c_p_state_variables.html#a8a15484ad9b2724916935eab69c6693f">00222</a>     <span class="keywordtype">bool</span> snd_dsack;          <span class="comment">// set if received duplicated segment (sequenceNo+PLength &lt; rcv_nxt) or (segment is not acceptable)</span>
<a name="l00223"></a><a class="code" href="class_t_c_p_state_variables.html#adf151c2f3284a3f4847fade882886400">00223</a>     <a class="code" href="class_sack.html">Sack</a> sacks_array[<a class="code" href="_t_c_p_connection_8h.html#a07b8719be91287fc05f5e527852bc1ec">MAX_SACK_BLOCKS</a>]; <span class="comment">// MAX_SACK_BLOCKS is set to 60</span>
<a name="l00224"></a><a class="code" href="class_t_c_p_state_variables.html#a9162bd39de68566f78ab0946fac613e4">00224</a>     uint32 highRxt;          <span class="comment">// RFC 3517, page 3: &quot;&quot;HighRxt&quot; is the highest sequence number which has been retransmitted during the current loss recovery phase.&quot;</span>
<a name="l00225"></a><a class="code" href="class_t_c_p_state_variables.html#a3c0e8d7110b3fdb2a5d2de5314a2c987">00225</a>     uint32 pipe;             <span class="comment">// RFC 3517, page 3: &quot;&quot;Pipe&quot; is a sender&apos;s estimate of the number of bytes outstanding in the network.&quot;</span>
<a name="l00226"></a><a class="code" href="class_t_c_p_state_variables.html#a4bf93e62de5a888f200f3bce908913af">00226</a>     uint32 recoveryPoint;    <span class="comment">// RFC 3517</span>
<a name="l00227"></a><a class="code" href="class_t_c_p_state_variables.html#a22c51e4c43cf036417d95e3584a616ad">00227</a>     uint32 sackedBytes;      <span class="comment">// number of sackedBytes</span>
<a name="l00228"></a><a class="code" href="class_t_c_p_state_variables.html#afc44bbf1e92ac47b7ef4ed4158af9a64">00228</a>     uint32 sackedBytes_old;  <span class="comment">// old number of sackedBytes - needed for RFC 3042 to check if last dupAck contained new sack information</span>
<a name="l00229"></a><a class="code" href="class_t_c_p_state_variables.html#a69fd5385780f1352abd11bbbc2c2c2ef">00229</a>     <span class="keywordtype">bool</span> lossRecovery;       <span class="comment">// indicates if algorithm is in loss recovery phase</span>
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="comment">// those counters would logically belong to TCPAlgorithm, but it&apos;s a lot easier to manage them here</span>
<a name="l00232"></a><a class="code" href="class_t_c_p_state_variables.html#ae3ddd98e68751df8e6a8f4c0c7081f28">00232</a>     uint32 dupacks;             <span class="comment">// current number of received consecutive duplicate ACKs</span>
<a name="l00233"></a><a class="code" href="class_t_c_p_state_variables.html#a0af59887792b19719cace81e44089eed">00233</a>     uint32 snd_sacks;           <span class="comment">// number of sent sacks</span>
<a name="l00234"></a><a class="code" href="class_t_c_p_state_variables.html#a89f41e684a082c84539dc4876bca0322">00234</a>     uint32 rcv_sacks;           <span class="comment">// number of received sacks</span>
<a name="l00235"></a><a class="code" href="class_t_c_p_state_variables.html#a2297a0a5817443e592d2770ec016b0a0">00235</a>     uint32 rcv_oooseg;          <span class="comment">// number of received out-of-order segments</span>
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <span class="comment">// receiver buffer / receiver queue related variables</span>
<a name="l00238"></a><a class="code" href="class_t_c_p_state_variables.html#af4c6ad2cfc1d77875d1d2e049e77d50d">00238</a>     uint32 maxRcvBuffer;        <span class="comment">// maximal amount of bytes in tcp receive queue</span>
<a name="l00239"></a><a class="code" href="class_t_c_p_state_variables.html#a3cb8ed26db2dbc9c3821a199354367ae">00239</a>     uint32 usedRcvBuffer;       <span class="comment">// current amount of used bytes in tcp receive queue</span>
<a name="l00240"></a><a class="code" href="class_t_c_p_state_variables.html#a0a9bd82033191de60a5bc5b3915ba8ae">00240</a>     uint32 freeRcvBuffer;       <span class="comment">// current amount of free bytes in tcp receive queue</span>
<a name="l00241"></a><a class="code" href="class_t_c_p_state_variables.html#a47f5ceae81f976297ea36112eb36c133">00241</a>     uint32 tcpRcvQueueDrops;    <span class="comment">// number of drops in tcp receive queue</span>
<a name="l00242"></a>00242 };
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 
<a name="l00294"></a><a class="code" href="class_t_c_p_connection.html">00294</a> <span class="keyword">class </span><a class="code" href="_i_n_e_t_defs_8h.html#ad4fa1dc2a221d8f0c1c417d4b993c51a">INET_API</a> <a class="code" href="class_t_c_p_connection.html">TCPConnection</a>
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296   <span class="keyword">public</span>:
<a name="l00297"></a>00297     <span class="comment">// connection identification by apps: appgateIndex+connId</span>
<a name="l00298"></a><a class="code" href="class_t_c_p_connection.html#ac07531e9f1e23e1da9d4263f0da58cd9">00298</a>     <span class="keywordtype">int</span> appGateIndex; <span class="comment">// application gate index</span>
<a name="l00299"></a><a class="code" href="class_t_c_p_connection.html#a6fee1d63c934294942e34b17a92d2fd5">00299</a>     <span class="keywordtype">int</span> connId;       <span class="comment">// identifies connection within the app</span>
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="comment">// socket pair</span>
<a name="l00302"></a><a class="code" href="class_t_c_p_connection.html#a08c53cabdcc750399f2af42d7c04d8e7">00302</a>     <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> localAddr;
<a name="l00303"></a><a class="code" href="class_t_c_p_connection.html#aee1b7ed1b1412bf36a125fcbab3e9e34">00303</a>     <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> remoteAddr;
<a name="l00304"></a><a class="code" href="class_t_c_p_connection.html#a248676b3def3f1af2dd46b9520ba4e96">00304</a>     <span class="keywordtype">int</span> localPort;
<a name="l00305"></a><a class="code" href="class_t_c_p_connection.html#aab271d97998bcfc7477fc1d99af2df08">00305</a>     <span class="keywordtype">int</span> remotePort;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307   <span class="keyword">protected</span>:
<a name="l00308"></a><a class="code" href="class_t_c_p_connection.html#ae74f100a2d121edee4b0e167596b8ac5">00308</a>     <a class="code" href="class_t_c_p.html">TCP</a> *tcpMain; <span class="comment">// TCP module</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="comment">// TCP state machine</span>
<a name="l00311"></a><a class="code" href="class_t_c_p_connection.html#af7032e0a7991f87167efce40df32535e">00311</a>     cFSM fsm;
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="comment">// variables associated with TCP state</span>
<a name="l00314"></a><a class="code" href="class_t_c_p_connection.html#a4780b0038982452cef8139e04f84b4c8">00314</a>     <a class="code" href="class_t_c_p_state_variables.html">TCPStateVariables</a> *state;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="comment">// TCP queues</span>
<a name="l00317"></a><a class="code" href="class_t_c_p_connection.html#a0dec48343ab1df2cc4157a3da114f54e">00317</a>     <a class="code" href="class_t_c_p_send_queue.html">TCPSendQueue</a> *sendQueue;
<a name="l00318"></a><a class="code" href="class_t_c_p_connection.html#a1f9a74ed0fae5b105a1a1cfb2bab9006">00318</a>     <a class="code" href="class_t_c_p_receive_queue.html">TCPReceiveQueue</a> *receiveQueue;
<a name="l00319"></a>00319  <span class="keyword">public</span>:
<a name="l00320"></a><a class="code" href="class_t_c_p_connection.html#a7de9df6b234a7dabb5b5e7eb7520734d">00320</a>     <a class="code" href="class_t_c_p_s_a_c_k_rexmit_queue.html">TCPSACKRexmitQueue</a> *rexmitQueue;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322  <span class="keyword">protected</span>:
<a name="l00323"></a>00323     <span class="comment">// TCP behavior in data transfer state</span>
<a name="l00324"></a><a class="code" href="class_t_c_p_connection.html#a305b76fec9de3d8524f7ae5cf1dd55f0">00324</a>     <a class="code" href="class_t_c_p_algorithm.html">TCPAlgorithm</a> *tcpAlgorithm;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="comment">// timers</span>
<a name="l00327"></a><a class="code" href="class_t_c_p_connection.html#a0ea0361f0b40f10bc9a3ce397b2c0e2f">00327</a>     cMessage *the2MSLTimer;
<a name="l00328"></a><a class="code" href="class_t_c_p_connection.html#a93b66fc68b48870a93479aa0bf4ac773">00328</a>     cMessage *connEstabTimer;
<a name="l00329"></a><a class="code" href="class_t_c_p_connection.html#ab5a1fb22c64b7f9edd700721bdec1d20">00329</a>     cMessage *finWait2Timer;
<a name="l00330"></a><a class="code" href="class_t_c_p_connection.html#ad2e24541092cf4c58f67845e6621f3cb">00330</a>     cMessage *synRexmitTimer; <span class="comment">// for retransmitting SYN and SYN+ACK</span>
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="comment">// statistics</span>
<a name="l00333"></a><a class="code" href="class_t_c_p_connection.html#a21c55311a3c27fe7808c962a5faffdf5">00333</a>     cOutVector *sndWndVector;   <span class="comment">// snd_wnd</span>
<a name="l00334"></a><a class="code" href="class_t_c_p_connection.html#ae5a0350b06c4be2dd4285230e08717cd">00334</a>     cOutVector *rcvWndVector;   <span class="comment">// rcv_wnd</span>
<a name="l00335"></a><a class="code" href="class_t_c_p_connection.html#a985637bb70c925f74fa6ad8bb53af0d0">00335</a>     cOutVector *rcvAdvVector;   <span class="comment">// current advertised window (=rcv_avd)</span>
<a name="l00336"></a><a class="code" href="class_t_c_p_connection.html#a67990b92349ae122edcf1d0a1a6b004c">00336</a>     cOutVector *sndNxtVector;   <span class="comment">// sent seqNo</span>
<a name="l00337"></a><a class="code" href="class_t_c_p_connection.html#af597155e6e0a1417ca5fd8cab178fcce">00337</a>     cOutVector *sndAckVector;   <span class="comment">// sent ackNo</span>
<a name="l00338"></a><a class="code" href="class_t_c_p_connection.html#a02c1500cf2719ebc20fe5e44ca9c663f">00338</a>     cOutVector *rcvSeqVector;   <span class="comment">// received seqNo</span>
<a name="l00339"></a><a class="code" href="class_t_c_p_connection.html#abe4b8c8de0df4555c93fc23dcb099893">00339</a>     cOutVector *rcvAckVector;   <span class="comment">// received ackNo (= snd_una)</span>
<a name="l00340"></a><a class="code" href="class_t_c_p_connection.html#a7cc325d99a5b02944a46c6a425fd01fc">00340</a>     cOutVector *unackedVector;  <span class="comment">// number of bytes unacknowledged</span>
<a name="l00341"></a>00341 
<a name="l00342"></a><a class="code" href="class_t_c_p_connection.html#abceb1f0559f6e8c9f0e8d906b3e124e7">00342</a>     cOutVector *dupAcksVector;   <span class="comment">// current number of received dupAcks</span>
<a name="l00343"></a><a class="code" href="class_t_c_p_connection.html#af4bd1681a62ef1ce6ac4237ed64bf468">00343</a>     cOutVector *pipeVector;      <span class="comment">// current sender&apos;s estimate of bytes outstanding in the network</span>
<a name="l00344"></a><a class="code" href="class_t_c_p_connection.html#a19d5bebef3053d95b66713e1e78e4200">00344</a>     cOutVector *sndSacksVector;  <span class="comment">// number of sent Sacks</span>
<a name="l00345"></a><a class="code" href="class_t_c_p_connection.html#a88d83f671702d2b86f59942b94165daa">00345</a>     cOutVector *rcvSacksVector;  <span class="comment">// number of received Sacks</span>
<a name="l00346"></a><a class="code" href="class_t_c_p_connection.html#a6ae35f9e338201b6f1f36e1c0aaf9acb">00346</a>     cOutVector *rcvOooSegVector; <span class="comment">// number of received out-of-order segments</span>
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="class_t_c_p_connection.html#a7c229fb19da75c880c60a41280721d0e">00348</a>     cOutVector *sackedBytesVector;        <span class="comment">// current number of received sacked bytes</span>
<a name="l00349"></a><a class="code" href="class_t_c_p_connection.html#a3d09993cf4b38b48fd5d4d51b7842607">00349</a>     cOutVector *tcpRcvQueueBytesVector;   <span class="comment">// current amount of used bytes in tcp receive queue</span>
<a name="l00350"></a><a class="code" href="class_t_c_p_connection.html#ad24c6dbc6d3b7e143ca4fc180092aa6b">00350</a>     cOutVector *tcpRcvQueueDropsVector;   <span class="comment">// number of drops in tcp receive queue</span>
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keyword">protected</span>:
<a name="l00356"></a>00356     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> preanalyseAppCommandEvent(<span class="keywordtype">int</span> commandCode);
<a name="l00358"></a>00358     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> performStateTransition(<span class="keyword">const</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event);
<a name="l00360"></a>00360     <span class="keyword">virtual</span> <span class="keywordtype">void</span> stateEntered(<span class="keywordtype">int</span> state);
<a name="l00362"></a>00362 
<a name="l00365"></a>00365     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_OPEN_ACTIVE(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00366"></a>00366     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_OPEN_PASSIVE(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00367"></a>00367     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_SEND(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00368"></a>00368     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_CLOSE(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00369"></a>00369     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_ABORT(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00370"></a>00370     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_STATUS(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event, <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg);
<a name="l00372"></a>00372 
<a name="l00379"></a>00379     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> tryFastRoute(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00384"></a>00384     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> process_RCV_SEGMENT(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest);
<a name="l00385"></a>00385     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> processSegmentInListen(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest);
<a name="l00386"></a>00386     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> processSegmentInSynSent(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest);
<a name="l00387"></a>00387     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> processSegment1stThru8th(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00388"></a>00388     <span class="keyword">virtual</span> <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> processRstInSynReceived(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00389"></a>00389     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processAckInEstabEtc(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00391"></a>00391 
<a name="l00394"></a>00394     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processMSSOption(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <span class="keyword">const</span> <a class="code" href="class_t_c_p_option.html">TCPOption</a>&amp; option);
<a name="l00395"></a>00395     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processSACKPermittedOption(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <span class="keyword">const</span> <a class="code" href="class_t_c_p_option.html">TCPOption</a>&amp; option);
<a name="l00396"></a>00396     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processSACKOption(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <span class="keyword">const</span> <a class="code" href="class_t_c_p_option.html">TCPOption</a>&amp; option);
<a name="l00398"></a>00398 
<a name="l00401"></a>00401     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_TIMEOUT_2MSL();
<a name="l00402"></a>00402     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_TIMEOUT_CONN_ESTAB();
<a name="l00403"></a>00403     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_TIMEOUT_FIN_WAIT_2();
<a name="l00404"></a>00404     <span class="keyword">virtual</span> <span class="keywordtype">void</span> process_TIMEOUT_SYN_REXMIT(<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>&amp; event);
<a name="l00406"></a>00406 
<a name="l00408"></a>00408     <span class="keyword">virtual</span> <a class="code" href="class_t_c_p_connection.html">TCPConnection</a> *cloneListeningConnection();
<a name="l00409"></a>00409 
<a name="l00411"></a>00411     <span class="keyword">virtual</span> <span class="keywordtype">void</span> initConnection(<a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *openCmd);
<a name="l00412"></a>00412 
<a name="l00414"></a>00414     <span class="keyword">virtual</span> <span class="keywordtype">void</span> configureStateVariables();
<a name="l00415"></a>00415 
<a name="l00417"></a>00417     <span class="keyword">virtual</span> <span class="keywordtype">void</span> selectInitialSeqNum();
<a name="l00418"></a>00418 
<a name="l00420"></a>00420     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isSegmentAcceptable(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00421"></a>00421 
<a name="l00423"></a>00423     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSyn();
<a name="l00424"></a>00424 
<a name="l00426"></a>00426     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSynAck();
<a name="l00427"></a>00427 
<a name="l00429"></a>00429     <span class="keyword">virtual</span> <span class="keywordtype">void</span> readHeaderOptions(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00430"></a>00430 
<a name="l00432"></a>00432     <span class="keyword">virtual</span> <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> writeHeaderOptions(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00433"></a>00433 
<a name="l00435"></a>00435     <span class="keyword">virtual</span> <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> addSacks(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keyword">public</span>:
<a name="l00439"></a>00439     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendAck();
<a name="l00440"></a>00440 
<a name="l00446"></a>00446     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> sendData(<span class="keywordtype">bool</span> fullSegmentsOnly, uint32 congestionWindow);
<a name="l00447"></a>00447 
<a name="l00449"></a>00449     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> sendProbe();
<a name="l00450"></a>00450 
<a name="l00452"></a>00452     <span class="keyword">virtual</span> <span class="keywordtype">void</span> retransmitOneSegment();
<a name="l00453"></a>00453 
<a name="l00455"></a>00455     <span class="keyword">virtual</span> <span class="keywordtype">void</span> retransmitData();
<a name="l00456"></a>00456 
<a name="l00458"></a>00458     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendRst(uint32 seqNo);
<a name="l00460"></a>00460     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendRst(uint32 seq, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest, <span class="keywordtype">int</span> srcPort, <span class="keywordtype">int</span> destPort);
<a name="l00462"></a>00462     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendRstAck(uint32 seq, uint32 ack, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest, <span class="keywordtype">int</span> srcPort, <span class="keywordtype">int</span> destPort);
<a name="l00463"></a>00463 
<a name="l00465"></a>00465     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendFin();
<a name="l00466"></a>00466 
<a name="l00471"></a>00471     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSegment(uint32 bytes);
<a name="l00472"></a>00472 
<a name="l00474"></a>00474     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendToIP(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00475"></a>00475 
<a name="l00480"></a>00480     <span class="keyword">virtual</span> <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *createTCPSegment(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00481"></a>00481 
<a name="l00483"></a>00483     <span class="keyword">virtual</span> <span class="keywordtype">void</span> startSynRexmitTimer();
<a name="l00484"></a>00484 
<a name="l00486"></a>00486     <span class="keyword">virtual</span> <span class="keywordtype">void</span> signalConnectionTimeout();
<a name="l00487"></a>00487 
<a name="l00489"></a><a class="code" href="class_t_c_p_connection.html#a60c9fb67af21fc9c1cee62369a8a1486">00489</a>     <span class="keywordtype">void</span> scheduleTimeout(cMessage *msg, simtime_t timeout)
<a name="l00490"></a>00490         {tcpMain-&gt;scheduleAt(simTime()+timeout, msg);}
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keyword">protected</span>:
<a name="l00494"></a><a class="code" href="class_t_c_p_connection.html#aecded14193441e78c31ca0c635ac19c8">00494</a>     cMessage *<a class="code" href="class_t_c_p_connection.html#aecded14193441e78c31ca0c635ac19c8">cancelEvent</a>(cMessage *msg) {<span class="keywordflow">return</span> tcpMain-&gt;cancelEvent(msg);}
<a name="l00495"></a>00495 
<a name="l00497"></a>00497     <span class="keyword">static</span> <span class="keywordtype">void</span> sendToIP(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest);
<a name="l00498"></a>00498 
<a name="l00500"></a>00500     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendToApp(cMessage *msg);
<a name="l00501"></a>00501 
<a name="l00503"></a>00503     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendIndicationToApp(<span class="keywordtype">int</span> code);
<a name="l00504"></a>00504 
<a name="l00506"></a>00506     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendEstabIndicationToApp();
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   <span class="keyword">public</span>:
<a name="l00510"></a>00510     <span class="keyword">virtual</span> <span class="keywordtype">void</span> printConnBrief();
<a name="l00512"></a>00512     <span class="keyword">static</span> <span class="keywordtype">void</span> printSegmentBrief(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg);
<a name="l00514"></a>00514     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *stateName(<span class="keywordtype">int</span> state);
<a name="l00516"></a>00516     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *eventName(<span class="keywordtype">int</span> event);
<a name="l00518"></a>00518     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *indicationName(<span class="keywordtype">int</span> code);
<a name="l00520"></a>00520     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *optionName(<span class="keywordtype">int</span> option);
<a name="l00522"></a>00522     <span class="keyword">virtual</span> <span class="keywordtype">void</span> updateRcvQueueVars();
<a name="l00524"></a>00524     <span class="keyword">virtual</span> <span class="keywordtype">void</span> updateRcvWnd();
<a name="l00526"></a>00526     <span class="keyword">virtual</span> <span class="keywordtype">void</span> updateWndInfo(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <span class="keywordtype">bool</span> doAlways=<span class="keyword">false</span>);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="keyword">public</span>:
<a name="l00532"></a>00532     <a class="code" href="class_t_c_p_connection.html">TCPConnection</a>(<a class="code" href="class_t_c_p.html">TCP</a> *mod, <span class="keywordtype">int</span> appGateIndex, <span class="keywordtype">int</span> connId);
<a name="l00533"></a>00533 
<a name="l00538"></a>00538     <a class="code" href="class_t_c_p_connection.html">TCPConnection</a>();
<a name="l00539"></a>00539 
<a name="l00543"></a>00543     <span class="keyword">virtual</span> ~<a class="code" href="class_t_c_p_connection.html">TCPConnection</a>();
<a name="l00544"></a>00544 
<a name="l00551"></a>00551     <span class="keyword">virtual</span> <span class="keywordtype">void</span> segmentArrivalWhileClosed(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> dest);
<a name="l00552"></a>00552 
<a name="l00555"></a><a class="code" href="class_t_c_p_connection.html#aa96e386d3f5d597dd0c03c52a103071d">00555</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_c_p_connection.html#aa96e386d3f5d597dd0c03c52a103071d">getFsmState</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fsm.getState();}
<a name="l00556"></a><a class="code" href="class_t_c_p_connection.html#a2bf497c23b9c58dbf704a511e36f19f1">00556</a>     <a class="code" href="class_t_c_p_state_variables.html">TCPStateVariables</a> *<a class="code" href="class_t_c_p_connection.html#a2bf497c23b9c58dbf704a511e36f19f1">getState</a>() {<span class="keywordflow">return</span> state;}
<a name="l00557"></a><a class="code" href="class_t_c_p_connection.html#a1ef81a39ac3ed1ef11b5d141136c1926">00557</a>     <a class="code" href="class_t_c_p_send_queue.html">TCPSendQueue</a> *<a class="code" href="class_t_c_p_connection.html#a1ef81a39ac3ed1ef11b5d141136c1926">getSendQueue</a>() {<span class="keywordflow">return</span> sendQueue;}
<a name="l00558"></a><a class="code" href="class_t_c_p_connection.html#a1eebaa12717ee8c8197b744275e0c7b0">00558</a>     <a class="code" href="class_t_c_p_s_a_c_k_rexmit_queue.html">TCPSACKRexmitQueue</a> *<a class="code" href="class_t_c_p_connection.html#a1eebaa12717ee8c8197b744275e0c7b0">getRexmitQueue</a>() {<span class="keywordflow">return</span> rexmitQueue;}
<a name="l00559"></a><a class="code" href="class_t_c_p_connection.html#a3c6829af5f8233ce0a666cda858374e6">00559</a>     <a class="code" href="class_t_c_p_receive_queue.html">TCPReceiveQueue</a> *<a class="code" href="class_t_c_p_connection.html#a3c6829af5f8233ce0a666cda858374e6">getReceiveQueue</a>() {<span class="keywordflow">return</span> receiveQueue;}
<a name="l00560"></a><a class="code" href="class_t_c_p_connection.html#a6a70265d4b753e5eefb47c2cdc54e9f5">00560</a>     <a class="code" href="class_t_c_p_algorithm.html">TCPAlgorithm</a> *<a class="code" href="class_t_c_p_connection.html#a6a70265d4b753e5eefb47c2cdc54e9f5">getTcpAlgorithm</a>() {<span class="keywordflow">return</span> tcpAlgorithm;}
<a name="l00561"></a><a class="code" href="class_t_c_p_connection.html#a5c9318d9fe504d7e5779a5b2eab87e09">00561</a>     <a class="code" href="class_t_c_p.html">TCP</a> *<a class="code" href="class_t_c_p_connection.html#a5c9318d9fe504d7e5779a5b2eab87e09">getTcpMain</a>() {<span class="keywordflow">return</span> tcpMain;}
<a name="l00563"></a>00563 
<a name="l00569"></a>00569     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processTimer(cMessage *msg);
<a name="l00570"></a>00570 
<a name="l00576"></a>00576     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processTCPSegment(<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpSeg, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr);
<a name="l00577"></a>00577 
<a name="l00583"></a>00583     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> processAppCommand(cMessage *msg);
<a name="l00584"></a>00584 
<a name="l00593"></a>00593     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isLost(uint32 seqNum);
<a name="l00594"></a>00594 
<a name="l00601"></a>00601     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setPipe();
<a name="l00602"></a>00602 
<a name="l00611"></a>00611     <span class="keyword">virtual</span> uint32 nextSeg();
<a name="l00612"></a>00612 
<a name="l00616"></a>00616     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendDataDuringLossRecoveryPhase(uint32 congestionWindow);
<a name="l00617"></a>00617 
<a name="l00621"></a>00621     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendSegmentDuringLossRecoveryPhase(uint32 seqNum);
<a name="l00622"></a>00622 
<a name="l00626"></a>00626     <span class="keyword">virtual</span> <span class="keywordtype">void</span> sendOneNewSegment(<span class="keywordtype">bool</span> fullSegmentsOnly, uint32 congestionWindow);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 };
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Mar 23 17:08:30 2010 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
